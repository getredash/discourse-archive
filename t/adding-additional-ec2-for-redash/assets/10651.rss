<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Adding additional ec2 for redash</title>
    <link>https://discuss.redash.io/t/adding-additional-ec2-for-redash/10651</link>
    <description>Hello. I have come here after reading this.
http://discuss.redash.io/t/redash-on-multiple-ec2-servers/9667
I have been using a single ec2 instance for redash (redash1) and I am trying to create an additional one (redash2).
I changed the /opt/redash/env file for redash2 exactly equal to redash1 after reading the above discussion.
However, the dashboard, queries and the data source that are saved in redash1 wouldn&#39;t appear in redash2. (They don&#39;t seem to sync)
Please help me out Thanks!</description>
    
    <lastBuildDate>Thu, 23 Jun 2022 06:13:58 +0000</lastBuildDate>
    <category>Usage Support</category>
    <atom:link href="https://discuss.redash.io/t/adding-additional-ec2-for-redash/10651.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Adding additional ec2 for redash</title>
        <dc:creator><![CDATA[santoryu96]]></dc:creator>
        <description><![CDATA[
            <p>The server became unhealthy and crashed, resulting in 500 internal error when I tried to access from the browser.</p>
<p>This is the log message at the time the server crashed.</p>
<p></p><div class="lightbox-wrapper"><a class="lightbox" href="https://global.discourse-cdn.com/standard17/uploads/redash1/original/2X/4/40d3b7661f9ef2f2dcf3b6a9133f708bd1385ffa.jpeg" data-download-href="/uploads/short-url/9fu9OV5rFGPpu9k7vBSaTXAQ2wO.jpeg?dl=1" title="Untitled" rel="noopener nofollow ugc"><img src="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/4/40d3b7661f9ef2f2dcf3b6a9133f708bd1385ffa_2_690x391.jpeg" alt="Untitled" data-base62-sha1="9fu9OV5rFGPpu9k7vBSaTXAQ2wO" width="690" height="391" srcset="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/4/40d3b7661f9ef2f2dcf3b6a9133f708bd1385ffa_2_690x391.jpeg, https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/4/40d3b7661f9ef2f2dcf3b6a9133f708bd1385ffa_2_1035x586.jpeg 1.5x, https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/4/40d3b7661f9ef2f2dcf3b6a9133f708bd1385ffa_2_1380x782.jpeg 2x" data-small-upload="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/4/40d3b7661f9ef2f2dcf3b6a9133f708bd1385ffa_2_10x10.png"></a></div><p></p>
<p></p><div class="lightbox-wrapper"><a class="lightbox" href="https://global.discourse-cdn.com/standard17/uploads/redash1/original/2X/f/fb26a610bb4007c5cb805bcf27d8c67c9026e0a9.jpeg" data-download-href="/uploads/short-url/zPMEgM1QReGwltqn97hPFjZy2z7.jpeg?dl=1" title="image" rel="noopener nofollow ugc"><img src="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/f/fb26a610bb4007c5cb805bcf27d8c67c9026e0a9_2_690x206.jpeg" alt="image" data-base62-sha1="zPMEgM1QReGwltqn97hPFjZy2z7" width="690" height="206" srcset="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/f/fb26a610bb4007c5cb805bcf27d8c67c9026e0a9_2_690x206.jpeg, https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/f/fb26a610bb4007c5cb805bcf27d8c67c9026e0a9_2_1035x309.jpeg 1.5x, https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/f/fb26a610bb4007c5cb805bcf27d8c67c9026e0a9_2_1380x412.jpeg 2x" data-small-upload="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/f/fb26a610bb4007c5cb805bcf27d8c67c9026e0a9_2_10x10.png"></a></div><p></p>
          <p><a href="https://discuss.redash.io/t/adding-additional-ec2-for-redash/10651/7">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/adding-additional-ec2-for-redash/10651/7</link>
        <pubDate>Thu, 23 Jun 2022 06:13:58 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-10651-7</guid>
        <source url="https://discuss.redash.io/t/adding-additional-ec2-for-redash/10651.rss">Adding additional ec2 for redash</source>
      </item>
      <item>
        <title>Adding additional ec2 for redash</title>
        <dc:creator><![CDATA[jesse]]></dc:creator>
        <description><![CDATA[
            <p>Glad to help!</p>
<p>I have some questions:</p>
<aside class="quote no-group" data-username="santoryu96" data-post="5" data-topic="10651">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="20" height="20" src="https://sjc6.discourse-cdn.com/standard17/user_avatar/discuss.redash.io/santoryu96/40/4126_2.png" class="avatar"> santoryu96:</div>
<blockquote>
<p>My m5.2xlarge redash ec2 instance server went down</p>
</blockquote>
</aside>
<p>What does this mean? Could you access it from a browser? Could you not run queries? Was the interface buggy?</p>
<aside class="quote no-group" data-username="santoryu96" data-post="5" data-topic="10651">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="20" height="20" src="https://sjc6.discourse-cdn.com/standard17/user_avatar/discuss.redash.io/santoryu96/40/4126_2.png" class="avatar"> santoryu96:</div>
<blockquote>
<p>Docker log showed Worker Timeout and failing to reboot.</p>
</blockquote>
</aside>
<p>I’m interested to see these log messages. If only a worker timed out that wouldn’t take down the whole server (normally).</p>
<aside class="quote no-group" data-username="santoryu96" data-post="5" data-topic="10651">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="20" height="20" src="https://sjc6.discourse-cdn.com/standard17/user_avatar/discuss.redash.io/santoryu96/40/4126_2.png" class="avatar"> santoryu96:</div>
<blockquote>
<p>CPU usage boosted up to 12% at the time. (It maintained 6% normally)</p>
</blockquote>
</aside>
<p>You can run <code>docker stats</code> to see which running services are consuming CPU. I have a feeling the problem here was the <code>nginx</code> service, rather than the <code>worker</code>.</p>
<p>[edit] I wonder if you are experiencing the same issue being discussed / debugged here: <a href="http://discuss.redash.io/t/fault-finding-guide/10609" class="inline-onebox">Fault finding guide</a></p>
          <p><a href="https://discuss.redash.io/t/adding-additional-ec2-for-redash/10651/6">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/adding-additional-ec2-for-redash/10651/6</link>
        <pubDate>Thu, 23 Jun 2022 03:43:12 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-10651-6</guid>
        <source url="https://discuss.redash.io/t/adding-additional-ec2-for-redash/10651.rss">Adding additional ec2 for redash</source>
      </item>
      <item>
        <title>Adding additional ec2 for redash</title>
        <dc:creator><![CDATA[santoryu96]]></dc:creator>
        <description><![CDATA[
            <p>Thank you very much Jesse! I wasn’t expecting such a detailed response. Your explanation mounted on the elementary knowledge I had about Docker network and now I get the overall picture.</p>
<p>The initial problem I encountered was this. My m5.2xlarge redash ec2 instance server went down time to time. Docker log showed Worker Timeout and failing to reboot. CPU usage boosted up to 12% at the time. (It maintained 6% normally)</p>
<p>What might be a possible reason to this and how can I fix this issue?</p>
          <p><a href="https://discuss.redash.io/t/adding-additional-ec2-for-redash/10651/5">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/adding-additional-ec2-for-redash/10651/5</link>
        <pubDate>Thu, 23 Jun 2022 03:01:23 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-10651-5</guid>
        <source url="https://discuss.redash.io/t/adding-additional-ec2-for-redash/10651.rss">Adding additional ec2 for redash</source>
      </item>
      <item>
        <title>Adding additional ec2 for redash</title>
        <dc:creator><![CDATA[jesse]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="santoryu96" data-post="1" data-topic="10651">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="20" height="20" src="https://sjc6.discourse-cdn.com/standard17/user_avatar/discuss.redash.io/santoryu96/40/4126_2.png" class="avatar"> santoryu96:</div>
<blockquote>
<p>I have been using a single ec2 instance for redash (redash1) and I am trying to create an additional one (redash2).</p>
</blockquote>
</aside>
<p>Slow down a moment. Why are you doing this? That’s not a normal situation. I wonder if a better solution is available, given that you are unfamiliar with this setup.</p>
<p>I don’t think you really need two complete instances of Redash pointed at the same metadata database. In fact doing this can produce strange bugs around database locking.</p>
<hr>
<p>To actually answer your question:</p>
<aside class="quote no-group" data-username="santoryu96" data-post="3" data-topic="10651">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="20" height="20" src="https://sjc6.discourse-cdn.com/standard17/user_avatar/discuss.redash.io/santoryu96/40/4126_2.png" class="avatar"> santoryu96:</div>
<blockquote>
<p>I don’t have much experience in programming, especially in docker.</p>
</blockquote>
</aside>
<p>I understand. It would be helpful for you to understand a little about docker-compose going into this. Particularly around how networking behaves. I’ll give you a tiny summary here, but you can always check out their docs for something deeper.</p>
<p>In a typical network, each computer receives an IP address from a DHCP server. Sometimes these addresses change. Other times they are fixed or static. For common resources like a database or an email server, the DHCP server can be configured to always give the same IP address to that machine. So a database could always be found at <code>172.20.16.20</code> for example.</p>
<p>When you create a service in <code>docker-compose</code>, each service will receive its own IP address. And it’s a lot of hassle to configure a DHCP server to always grant each one the same IP address every time it starts. So what if the services need to speak to one another?</p>
<p>For this, Docker allows you to configure networks using the name of a <code>service</code>. Whenever one service speaks to another, the configuration doesn’t need to include an IP address. It can use the name of the <code>service</code> instead.</p>
<p>Looking at Redash’s default configuration, you can see that it uses service names instead of IP addresses. For example, the <code>REDASH_REDIS_URL</code> is defaulted to <code>redis://redis:6379/0</code>. That’s because the name of the service is <code>redis</code>. So even if the service restarts and gets a new IP address every time, the config file doesn’t require an update.</p>
<aside class="quote no-group" data-username="santoryu96" data-post="3" data-topic="10651">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="20" height="20" src="https://sjc6.discourse-cdn.com/standard17/user_avatar/discuss.redash.io/santoryu96/40/4126_2.png" class="avatar"> santoryu96:</div>
<blockquote>
<p>Does making the env file same and restarting the docker not do the job?</p>
</blockquote>
</aside>
<p>It does not, unless you update both of your <code>docker-compose</code> files to use externally accessible URLs. Because right now you have two completely unique instances of Redash. And both of them are talking to <em>their own copy of postgres and redis</em>. If you want them to use the same <code>postgres</code>, you need to configure your Amazon settings so that postgres always has the same IP address. And then you need to configure both instances to use the same one.</p>
<p>As I wrote above, this is not a good idea. Proceed at your own risk.</p>
          <p><a href="https://discuss.redash.io/t/adding-additional-ec2-for-redash/10651/4">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/adding-additional-ec2-for-redash/10651/4</link>
        <pubDate>Wed, 22 Jun 2022 18:00:45 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-10651-4</guid>
        <source url="https://discuss.redash.io/t/adding-additional-ec2-for-redash/10651.rss">Adding additional ec2 for redash</source>
      </item>
      <item>
        <title>Adding additional ec2 for redash</title>
        <dc:creator><![CDATA[santoryu96]]></dc:creator>
        <description><![CDATA[
            <p>Hello Thanks for your response.<br>
I don’t have much experience in programming, especially in docker. I need some help…<br>
What do I need to configure for redash2 postgres service to connect to redash1 postgres service?<br>
Does making the env file same and restarting the docker not do the job?</p>
          <p><a href="https://discuss.redash.io/t/adding-additional-ec2-for-redash/10651/3">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/adding-additional-ec2-for-redash/10651/3</link>
        <pubDate>Wed, 22 Jun 2022 01:06:04 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-10651-3</guid>
        <source url="https://discuss.redash.io/t/adding-additional-ec2-for-redash/10651.rss">Adding additional ec2 for redash</source>
      </item>
      <item>
        <title>Adding additional ec2 for redash</title>
        <dc:creator><![CDATA[jesse]]></dc:creator>
        <description><![CDATA[
            <p>Redash stores state in its metadata database (postgres). Does your <code>redash2</code> connect to the postgres service in the <code>redash1</code> ec2 network?</p>
<p>If it doesn’t, that would explain your issue.</p>
          <p><a href="https://discuss.redash.io/t/adding-additional-ec2-for-redash/10651/2">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/adding-additional-ec2-for-redash/10651/2</link>
        <pubDate>Tue, 21 Jun 2022 16:18:43 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-10651-2</guid>
        <source url="https://discuss.redash.io/t/adding-additional-ec2-for-redash/10651.rss">Adding additional ec2 for redash</source>
      </item>
      <item>
        <title>Adding additional ec2 for redash</title>
        <dc:creator><![CDATA[santoryu96]]></dc:creator>
        <description><![CDATA[
            <p>Hello. I have come here after reading this.</p><aside class="quote quote-modified" data-post="1" data-topic="9667">
  <div class="title">
    <div class="quote-controls"></div>
    <img loading="lazy" alt="" width="20" height="20" src="https://avatars.discourse-cdn.com/v4/letter/s/58956e/40.png" class="avatar">
    <a href="http://discuss.redash.io/t/redash-on-multiple-ec2-servers/9667">Redash on multiple ec2 servers</a> <a class="badge-wrapper  bullet" href="https://discuss.redash.io/c/support/support-usage/10"><span class="badge-category-parent-bg" style="background-color: #BF1E2E;"></span><span class="badge-category-bg" style="background-color: #AB9364;"></span><span style="" data-drop-close="true" class="badge-category clear-badge" title="Need help with using Redash? Not sure if something is possible or how to do it right? Here’s the place to ask.">Usage Support</span></a>
  </div>
  <blockquote>
    We launched 2 ec2-server with redash image and tried to RDS as backend. 
Redash1 &amp; Redash2 server launched using below yaml file through docker. 
We set RDS postgres as a backend(Refer env below). And we successfully launched both servers but in redash2 we are unable to see data sources. Screen shot attached. 
env file 
PYTHONUNBUFFERED=0
REDASH_LOG_LEVEL=INFO
REDASH_REDIS_URL=redis://redis:6379/0
REDASH_COOKIE_SECRET=SECRET
REDASH_SECRET_KEY=SECRET
REDASH_MAIL_SERVER=smtp-relay.gmail.com
REDASH…
  </blockquote>
</aside>
<p>
I have been using a single ec2 instance for redash (redash1) and I am trying to create an additional one (redash2).<br>
I changed the /opt/redash/env file for redash2 exactly equal to redash1 after reading the above discussion.<br>
However, the dashboard, queries and the data source that are saved in redash1 wouldn’t appear in redash2. (They don’t seem to sync)<br>
Please help me out Thanks!</p>
          <p><a href="https://discuss.redash.io/t/adding-additional-ec2-for-redash/10651/1">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/adding-additional-ec2-for-redash/10651/1</link>
        <pubDate>Mon, 20 Jun 2022 09:47:51 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-10651-1</guid>
        <source url="https://discuss.redash.io/t/adding-additional-ec2-for-redash/10651.rss">Adding additional ec2 for redash</source>
      </item>
  </channel>
</rss>
