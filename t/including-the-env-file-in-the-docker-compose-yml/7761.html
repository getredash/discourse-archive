<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet"/>
<link href="../../css/checklist_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/desktop_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/desktop_theme_2_be4cb2b86ec06123c5e974acd20fd933d14b129d.css" rel="stylesheet"/>
<link href="../../css/discourse-adplugin_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-akismet_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-cakeday_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-chat-integration_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-details_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-footnote_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-lazy-videos_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-local-dates_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/color_definitions_base__2_8fd59ae1f286f43b3ff17996df07ea951685249d.css" rel="stylesheet"/>
<link href="../../css/style.css" rel="stylesheet"/>
<title>Including the .env file in the docker-compose.yml</title></head>
<body>
<div class="navbar">
<div class="logo"><a href="../../page_0.html"><img alt="" src="../../images/logo_redash.png" srcset=""/></a></div>
<div class="navbar-buttons">
<button class="btn btn-signup">Sign Up</button>
<button class="btn btn-login"><i class="fas fa-user"></i> Login</button>
<button class="btn btn-search"><i class="fas fa-search"></i></button>
<div class="navbar-toggle">
<div class="dots"></div>
<div class="dots"></div>
<div class="dots"></div>
</div>
</div>
</div>
<div class="sidebar">
<div class="sidebar-content">
<div class="logo"><a href="../../page_0.html"><img alt="" src="../../images/logo_redash.png" srcset=""/></a></div>
<ul class="sidebar-grid">
<!-- <li><a href="#"><i class="fas fa-list-ul"></i> Topics</a></li> -->
<li><a href="../../page_0.html"><i class="fas fa-layer-group"></i> Topics</a></li>
<li><a href="../../users.html"><i class="fas fa-users"></i> Users</a></li>
<li><a href="../../about.html"><i class="fas fa-info-circle"></i> About</a></li>
<li><a href="../../faq.html"><i class="fas fa-question-circle"></i> FAQ</a></li>
<li><a href="../../groups.html"><i class="fas fa-users"></i> Groups</a></li>
<li><a href="../../badges.html"><i class="fas fa-certificate"></i> Badges</a></li>
</ul>
<h3 style="font-size: 13px;"><a href="#categories"><span>▼</span>Categories</a></h3>
<hr/>
<ul class="sidebar-grid categories">
<li>
<a class="badge-wrapper bullet" href="../../c/support/6.html">
<span class="badge-category-bg" style="background-color: #BF1E2E"></span>
<span class="badge-category clear-badge">
<span class="category-name">Support</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/feature-requests/5.html">
<span class="badge-category-bg" style="background-color: #3AB54A"></span>
<span class="badge-category clear-badge">
<span class="category-name">Feature Requests</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/uncategorized/1.html">
<span class="badge-category-bg" style="background-color: #AB9364"></span>
<span class="badge-category clear-badge">
<span class="category-name">Uncategorized</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/development/7.html">
<span class="badge-category-bg" style="background-color: #8C6238"></span>
<span class="badge-category clear-badge">
<span class="category-name">Development</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/tips-tricks-query-examples/11.html">
<span class="badge-category-bg" style="background-color: #652D90"></span>
<span class="badge-category clear-badge" style="white-space: normal;">
<span class="category-name">Tips, Tricks &amp; Query Examples</span>
</span>
</a>
</li>
<li><a href="../../categories.html"><i class="fas fa-list-ul"></i> All categories</a></li>
</ul>
<h3 style="font-size: 13px;"><a href="#tags"><span>▼</span>Tags</a></h3>
<hr/>
<ul class="sidebar-grid tags">
<li><a href="../../tag/query_results.html"><i class="fas fa-tag"></i> query_results</a></li>
<li><a href="../../tag/feature-request.html"><i class="fas fa-tag"></i> feature-request</a></li>
<li><a href="../../tag/parameters.html"><i class="fas fa-tag"></i> parameters</a></li>
<li><a href="../../tag/visualizations.html"><i class="fas fa-tag"></i> visualizations</a></li>
<li><a href="../../tag/alerts.html"><i class="fas fa-tag"></i> alerts</a></li>
<li><a href="../../tags.html"><i class="fas fa-list-ul"></i> All tags</a></li>
</ul>
</div>
<div class="sidebar-footer">
            © 2023 <a href="https://discuss.redash.io/" target="_blank">discuss.redash.io</a>
</div>
</div>
<div class="overlay"></div>
<div class="content">
<div class="global-notice">
<div class="row">
<div class="alert alert-info alert-read-only" id="global-notice-alert-read-only">
<span class="text">This site is in read only mode. Please continue to browse, but replying, likes,
                        and other actions are disabled for now.</span>
</div>
</div>
</div>
<div class="imported_page" id="imported_page">
<div class="wrap" id="main-outlet" role="main">
<div id="topic-title">
<h1>
<a href="/t/including-the-env-file-in-the-docker-compose-yml/7761">Including the .env file in the docker-compose.yml</a>
</h1>
<div class="topic-category" itemscope="" itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
<a class="badge-wrapper bullet" href="../../c/support/6.html" itemprop="item">
<span class="badge-category-bg" style="background-color: #BF1E2E"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Support</span>
</span>
</a>
<meta content="1" itemprop="position"/>
</span>
<span itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
<a class="badge-wrapper bullet" href="../../c/support/support-self-hosted/9.html" itemprop="item">
<span class="badge-category-bg" style="background-color: #AB9364"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Self Hosted Redash Support</span>
</span>
</a>
<meta content="2" itemprop="position"/>
</span>
</div>
</div>
<div itemscope="" itemtype="http://schema.org/DiscussionForumPosting">
<meta content="Including the .env file in the docker-compose.yml" itemprop="headline"/>
<meta content="Self Hosted Redash Support" itemprop="articleSection"/>
<meta content="" itemprop="keywords"/>
<div itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
<meta content="Redash Discourse" itemprop="name"/>
<div itemprop="logo" itemscope="" itemtype="http://schema.org/ImageObject">
<meta content="https://global.discourse-cdn.com/standard17/uploads/redash1/original/1X/c07bc573841e1e4a0013ea3b6fe088a1534228a3.png" itemprop="url"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_1">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/svanton.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/svanton_avatar.png" tabindex="-1" width="48"/><span itemprop="name">svanton</span></a>
</span>
<link href="https://discuss.redash.io/t/including-the-env-file-in-the-docker-compose-yml/7761" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2020-12-28T14:35:47Z" itemprop="datePublished">
                    December 28, 2020,  2:35pm
                  </time>
<meta content="2020-12-28T14:35:47Z" itemprop="dateModified"/>
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p>The default setup described here:</p>
<aside class="onebox githubfolder">
<header class="source">
<img class="site-icon" height="16" src="assets/favicon.svg" width="16"/>
<a href="https://github.com/getredash/setup" rel="noopener nofollow ugc" target="_blank">github.com</a>
</header>
<article class="onebox-body">
<img class="thumbnail onebox-full-image" height="60" src="assets/10746780" width="60"/>
<h3><a href="https://github.com/getredash/setup" rel="noopener nofollow ugc" target="_blank">getredash/setup</a></h3>
<p><span class="label1">Setup scripts for Redash Cloud Images. Contribute to getredash/setup development by creating an account on GitHub.</span></p>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
<p>Includes an .env file that defines the following variables:</p>
<p>PYTHONUNBUFFERED=0<br/>
REDASH_LOG_LEVEL=INFO<br/>
REDASH_REDIS_URL=redis://redis:6379/0<br/>
POSTGRES_PASSWORD= X<br/>
REDASH_COOKIE_SECRET= X<br/>
REDASH_SECRET_KEY= X<br/>
REDASH_DATABASE_URL=postgresql://postgres:ft9wZJhdyL7hnKQNdYGOxMWufYsvmshq@postgres/postgres</p>
<p>I’m trying to move my redash stack over to my Qnap NAS. In order to do this my docker-compose.yml can not (as far as I know) have any references to external files, such as the .env file*.</p>
<p>Is there some way to write in the enviroment variables directly in the docker-compose-yml to bypass this?</p>
<ul>
<li>This because as opposed to in e.g. Linux, you do not make a folder and place you docker-compose-yml in it along with setup files such as .env. In Qnap you just run the yml configuration through the system’s own Container Station.</li>
</ul>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
</div>
<div class="crawler-linkback-list" itemscope="" itemtype="http://schema.org/ItemList">
<div itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
<a href="http://discuss.redash.io/t/good-first-issues/9572/6" itemprop="url">Good-first-issues</a>
<meta content="2" itemprop="position"/>
</div>
</div>
</div>
<div class="topic-body crawler-post" id="post_2" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/svanton.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/svanton_avatar.png" tabindex="-1" width="48"/><span itemprop="name">svanton</span></a>
</span>
<link href="https://discuss.redash.io/t/including-the-env-file-in-the-docker-compose-yml/7761" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2020-12-28T14:40:19Z" itemprop="datePublished">
                    December 28, 2020,  2:40pm
                  </time>
<meta content="2020-12-28T14:40:19Z" itemprop="dateModified"/>
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<pre><code>version: "2"
x-redash-service: &amp;redash-service
  image: redash/redash:8.0.0.b32245
  depends_on:
    - postgres
    - redis
  env_file: /opt/redash/env
  restart: always
services:
  server:
    &lt;&lt;: *redash-service
    command: server
    ports:
      - "5000:5000"
    environment:
      REDASH_WEB_WORKERS: 4
  scheduler:
    &lt;&lt;: *redash-service
    command: scheduler
    environment:
      QUEUES: "celery"
      WORKERS_COUNT: 1
  scheduled_worker:
    &lt;&lt;: *redash-service
    command: worker
    environment:
      QUEUES: "scheduled_queries,schemas"
      WORKERS_COUNT: 1
  adhoc_worker:
    &lt;&lt;: *redash-service
    command: worker
    environment:
      QUEUES: "queries"
      WORKERS_COUNT: 2
  redis:
    image: redis:5.0-alpine
    restart: always
  postgres:
    image: postgres:9.6-alpine
    env_file: /opt/redash/env
    volumes:
      - /opt/redash/postgres-data:/var/lib/postgresql/data
    restart: always
  nginx:
    image: redash/nginx:latest
    ports:
      - "80:80"
    depends_on:
      - server
    links:
      - server:redash
    restart: always
</code></pre>
<p>The standard docker-compose.yml includes the .env file in multiple locations. What I am trying to figure out how to do is to get rid of those references.</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_3" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/k4s1m.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/k4s1m_avatar.png" tabindex="-1" width="48"/><span itemprop="name">k4s1m</span></a>
</span>
<link href="https://discuss.redash.io/t/including-the-env-file-in-the-docker-compose-yml/7761" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2020-12-28T15:12:18Z" itemprop="datePublished">
                    December 28, 2020,  3:12pm
                  </time>
<meta content="2020-12-28T15:12:18Z" itemprop="dateModified"/>
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I think you can achieve this by adding an <code>environment</code> token to your docker-compose.yaml file. More info <a href="https://github.com/compose-spec/compose-spec/blob/master/spec.md#environment" rel="noopener nofollow ugc">here</a>.</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_4" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/svanton.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/svanton_avatar.png" tabindex="-1" width="48"/><span itemprop="name">svanton</span></a>
</span>
<link href="https://discuss.redash.io/t/including-the-env-file-in-the-docker-compose-yml/7761" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2020-12-29T17:53:16Z" itemprop="datePublished">
                    December 29, 2020,  5:53pm
                  </time>
<meta content="2020-12-29T17:53:16Z" itemprop="dateModified"/>
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Thanks! I copy pasted the enviroment variables as such, but now I ran into another problem:</p>
<pre><code>x-redash-service: &amp;redash-service
  image: redash/redash:8.0.0.b32245
  depends_on:
    - postgres
    - redis
  environment:
    PYTHONUNBUFFERED: 0
    REDASH_LOG_LEVEL: "INFO"
    REDASH_REDIS_URL: "redis://redis:6379/0"
</code></pre>
<p>The REDASH_REDIS_URL is setup like this now. But when I run docker-compose up:</p>
<p>[2020-12-29 17:02:31,921][PID:1][ERROR][MainProcess] consumer: Cannot connect to redis://localhost:6379/0: Error 99 connecting to localhost:6379. Cannot assign requested address…</p>
<p>It seems the  “redis://redis:6379/0” is somehow converted to “redis://localhost:6379/0”, and this is the source of the problem. Is there some way to fix this so that redish stays as redis?</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_5" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/k4s1m.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/k4s1m_avatar.png" tabindex="-1" width="48"/><span itemprop="name">k4s1m</span></a>
</span>
<link href="https://discuss.redash.io/t/including-the-env-file-in-the-docker-compose-yml/7761" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2020-12-30T04:27:41Z" itemprop="datePublished">
                    December 30, 2020,  4:27am
                  </time>
<meta content="2020-12-30T04:27:41Z" itemprop="dateModified"/>
<span itemprop="position">5</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I think this doesn’t work because your environment variables are declared <em>before</em> your services. Since <code>redis</code> doesn’t exist yet it is converted to <code>localhost</code>. You could probably work around this another way by using the <code>extends</code> keyword for each of your Redash services. Just make each of them extend a service with the environment declared. <a href="https://docs.docker.com/compose/extends/" rel="noopener nofollow ugc">Docs here</a>.</p>
<h3>But…</h3>
<p>Looking back at your original question though I noticed this:</p>
<aside class="quote no-group" data-post="1" data-topic="7761" data-username="svanton">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="https://avatars.discourse-cdn.com/v4/letter/s/f05b48/40.png" width="20"/> svanton:</div>
<blockquote>
<p>I’m trying to move my redash stack over to my Qnap NAS. In order to do this my docker-compose.yml can not (as far as I know) have any references to external files, such as the .env file*.</p>
</blockquote>
</aside>
<p>Have you tested this? Because the <a href="https://docs.docker.com/compose/env-file/" rel="noopener nofollow ugc">docker-compose docs</a> make it pretty clear that .env files will be honored.</p>
<blockquote>
<p>Compose supports declaring default environment variables in an environment file named <code>.env</code> placed in the folder where the <code>docker-compose</code> command is executed <em>(current working directory)</em> .</p>
</blockquote>
<p>The way this <em>wouldn’t</em> work is if your QNAP NAS is running a modified version of docker-compose that specifically excludes it.</p>
<p>What happens when you try running with a .env file?</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_6" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/guyu.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/guyu_avatar.png" tabindex="-1" width="48"/><span itemprop="name">guyu</span></a>
</span>
<link href="https://discuss.redash.io/t/including-the-env-file-in-the-docker-compose-yml/7761" itemprop="mainEntityOfPage"/>
<link href="https://global.discourse-cdn.com/standard17/uploads/redash1/original/2X/6/6c94f105e5f4859a3378e0847f597694ebd2892d.png" itemprop="image"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2020-12-30T04:29:37Z" itemprop="datePublished">
                    December 30, 2020,  4:29am
                  </time>
<meta content="2020-12-30T04:29:37Z" itemprop="dateModified"/>
<span itemprop="position">6</span>
</span>
</div>
<div class="post" itemprop="text">
<p><img alt="image" data-base62-sha1="fuyFH3NlKTN9ZEJMJDmWcTzvLFH" height="59" src="assets/6c94f105e5f4859a3378e0847f597694ebd2892d.png" width="248"/></p>
<p>Like this. You can put .yml and .env in same path.</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_7" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/svanton.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/svanton_avatar.png" tabindex="-1" width="48"/><span itemprop="name">svanton</span></a>
</span>
<link href="https://discuss.redash.io/t/including-the-env-file-in-the-docker-compose-yml/7761" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2020-12-30T10:43:38Z" itemprop="datePublished">
                    December 30, 2020, 10:43am
                  </time>
<meta content="2020-12-30T12:07:19Z" itemprop="dateModified"/>
<span itemprop="position">7</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Thanks!</p>
<p>The problem is that in QNAP I have no idea where the docker-compose.yml file is being run, as opposed to Linux you just run it through the GUI and there is no options about location (as far as I have been able to see). so I have no way of placing the .env file somewhere relative to it.</p>
<p>To be clear, they way Linux and Qnap differs is:</p>
<p>Linux</p>
<ul>
<li>Put .env file and docker-compose.yml in same folder</li>
<li>docker-compose up</li>
<li>You know in which folder both are</li>
</ul>
<p>Qnap</p>
<ul>
<li>GUI where you can enter docker-compose instructions, nothing else</li>
<li>Press create</li>
<li>Its running somewhere, you don’t know where.</li>
</ul>
<p>Hence I’m trying to figure out how to do everything from the docker-compose, without any dependent files.</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_8" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/k4s1m.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/k4s1m_avatar.png" tabindex="-1" width="48"/><span itemprop="name">k4s1m</span></a>
</span>
<link href="https://discuss.redash.io/t/including-the-env-file-in-the-docker-compose-yml/7761" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2020-12-30T17:52:07Z" itemprop="datePublished">
                    December 30, 2020,  5:52pm
                  </time>
<meta content="2020-12-30T17:52:07Z" itemprop="dateModified"/>
<span itemprop="position">8</span>
</span>
</div>
<div class="post" itemprop="text">
<aside class="quote no-group" data-post="7" data-topic="7761" data-username="svanton">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="https://avatars.discourse-cdn.com/v4/letter/s/f05b48/40.png" width="20"/> svanton:</div>
<blockquote>
<p>Qnap</p>
<ul>
<li>GUI where you can enter docker-compose instructions, nothing else</li>
<li>Press create</li>
<li>Its running somewhere, you don’t know where.</li>
</ul>
</blockquote>
</aside>
<p>Don’t let this stop you <img alt=":wink:" class="emoji" src="assets/wink.png" title=":wink:"/> It’s still running <code>docker-compose</code> under the covers which means there is a directory you can store an .env file. I searched google and this was the top result:</p>
<aside class="onebox allowlistedgeneric">
<header class="source">
<img class="site-icon" height="16" src="https://mwunderling.com/blog/qnapcontainertips/images/favicon.ico" width="16"/>
<a href="https://mwunderling.com/blog/qnapcontainertips" rel="noopener nofollow ugc" target="_blank" title="12:00AM - 06 January 2020">Byte Sized Info – 6 Jan 20</a>
</header>
<article class="onebox-body">
<div class="aspect-image" style="--aspect-ratio:130/127;"><img class="thumbnail" height="127" src="https://mwunderling.com/img/qnap_container_station.png" width="130"/></div>
<h3><a href="https://mwunderling.com/blog/qnapcontainertips" rel="noopener nofollow ugc" target="_blank">Container management on QNAP</a></h3>
<p>Three Tips to run your Docker containers more efficiently</p>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
<p>And here’s the magic:</p>
<blockquote>
<p>You may already know Container Station creates a shared folder named “Container” when it is installed. Inside this folder is another folder with special permissions that contains all the data files for Container Station to run + any container images.</p>
</blockquote>
<p>So you can just drop your .env file into that folder on the QNAP and it will work.</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_9" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/svanton.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/svanton_avatar.png" tabindex="-1" width="48"/><span itemprop="name">svanton</span></a>
</span>
<link href="https://discuss.redash.io/t/including-the-env-file-in-the-docker-compose-yml/7761" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2021-01-01T13:45:01Z" itemprop="datePublished">
                    January 1, 2021,  1:45pm
                  </time>
<meta content="2021-01-01T13:45:01Z" itemprop="dateModified"/>
<span itemprop="position">9</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Thank you!</p>
<p>Yeah, easiest way seems to be to SSH in to the QNAP and then you can controll it with regular command line interface. i.e. create folder, throw the yml and env file in there and the docker-compose up.</p>
<p>Thanks for setting me on the right path! <img alt=":slight_smile:" class="emoji" src="assets/slight_smile.png" title=":slight_smile:"/></p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_10" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/k4s1m.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/k4s1m_avatar.png" tabindex="-1" width="48"/><span itemprop="name">k4s1m</span></a>
</span>
<link href="https://discuss.redash.io/t/including-the-env-file-in-the-docker-compose-yml/7761" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2021-01-04T20:36:01Z" itemprop="datePublished">
                    January 4, 2021,  8:36pm
                  </time>
<meta content="2021-01-04T20:36:01Z" itemprop="dateModified"/>
<span itemprop="position">10</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Let us know if you get this working. It could be helpful to other Redashers down the line.</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_11" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/svanton.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/svanton_avatar.png" tabindex="-1" width="48"/><span itemprop="name">svanton</span></a>
</span>
<link href="https://discuss.redash.io/t/including-the-env-file-in-the-docker-compose-yml/7761" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2021-01-05T07:22:23Z" itemprop="datePublished">
                    January 5, 2021,  7:22am
                  </time>
<meta content="2021-01-05T12:02:41Z" itemprop="dateModified"/>
<span itemprop="position">11</span>
</span>
</div>
<div class="post" itemprop="text">
<p>It’s working but I’m running in to the (unrelated as far as I know) issue described in this thread here as I do docker-compose up. Not sure what’s going on, apparently the database is not populated successfully. The solution can also be found here:</p><aside class="quote" data-post="5" data-topic="187">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="https://avatars.discourse-cdn.com/v4/letter/s/f05b48/40.png" width="20"/>
<a href="http://discuss.redash.io/t/relation-queries-does-not-exist/187/5">Relation "queries" does not exist</a>
</div>
<blockquote>
    Hi, I’m running in to the same problem. Could you give some more context where I can find this manage.py? 
Edit: Seems I found it! 

Use this to get in to the Redash server container


docker exec -t -i mycontainer /bin/bash 

(From here: <a class="inline-onebox" href="https://stackoverflow.com/questions/20813486/exploring-docker-containers-file-system" rel="noopener nofollow ugc">linux - Exploring Docker container's file system - Stack Overflow</a>) 

This step not necessary

ls 
Should see “manage.py” 

python manage.py database create_tables
  </blockquote>
</aside>
<p>Shot answer, yes its working. Here’s the steps: <img alt=":slight_smile:" class="emoji" src="assets/slight_smile.png" title=":slight_smile:"/></p>
<p><span class="hashtag">#1</span>. Container Station seems to put container station data by default to the address below, so that’s where I made a “redash” folder:</p>
<p><code>Container/container-station-data/application/redash/</code></p>
<p><span class="hashtag">#2</span>. Throw the docker-compose.yml + .env file to the folder. I named my env file redash.env, seems to be easier to refer to it in the yml file if it has a name.</p>
<p><span class="hashtag">#3</span>. SSH in to the QNAP.</p>
<p><code>ssh XXX.XXX.X.XXX -l admin</code><br/>
(You will be prompted for password. I think QNAP only accepts SSH connection from “admin”)</p>
<p><span class="hashtag">#4</span>.<br/>
<code>cd /share/Container/container-station-data/application/redash/</code><br/>
(QNAP puts the “share” in the beginning for some reason)</p>
<p><span class="hashtag">#5</span>. If everything is ready:<br/>
<code>docker-compose up</code></p>
<p>If you want to do it in detached mode add the “-d” flag. I think its easier to see the logs without -d.</p>
<p><span class="hashtag">#6</span>. If something is wrong<br/>
<code>docker-compose down</code><br/>
Edit the yml and env file and start again from <span class="hashtag">#5</span>.</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="overlay" id="modalOverlay" style="display: none;">
<div class="modal-content">
<p>Login or sign up disabled while the site is in read only mode</p>
<hr/>
<button class="btn btn-login">OK</button>
</div>
</div>
<script src="../../js/script.js"></script>
</body>
</html>