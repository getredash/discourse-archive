<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet"/>
<link href="../../css/checklist_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/desktop_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/desktop_theme_2_be4cb2b86ec06123c5e974acd20fd933d14b129d.css" rel="stylesheet"/>
<link href="../../css/discourse-adplugin_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-akismet_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-cakeday_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-chat-integration_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-details_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-footnote_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-lazy-videos_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-local-dates_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/color_definitions_base__2_8fd59ae1f286f43b3ff17996df07ea951685249d.css" rel="stylesheet"/>
<link href="../../css/style.css" rel="stylesheet"/>
<title>Redash 6.0.0 Internal Server Error</title></head>
<body>
<div class="navbar">
<div class="logo"><a href="../../page_0.html"><img alt="" src="../../images/logo_redash.png" srcset=""/></a></div>
<div class="navbar-buttons">
<button class="btn btn-signup">Sign Up</button>
<button class="btn btn-login"><i class="fas fa-user"></i> Login</button>
<button class="btn btn-search"><i class="fas fa-search"></i></button>
<div class="navbar-toggle">
<div class="dots"></div>
<div class="dots"></div>
<div class="dots"></div>
</div>
</div>
</div>
<div class="sidebar">
<div class="sidebar-content">
<div class="logo"><a href="../../page_0.html"><img alt="" src="../../images/logo_redash.png" srcset=""/></a></div>
<ul class="sidebar-grid">
<!-- <li><a href="#"><i class="fas fa-list-ul"></i> Topics</a></li> -->
<li><a href="../../page_0.html"><i class="fas fa-layer-group"></i> Topics</a></li>
<li><a href="../../users.html"><i class="fas fa-users"></i> Users</a></li>
<li><a href="../../about.html"><i class="fas fa-info-circle"></i> About</a></li>
<li><a href="../../faq.html"><i class="fas fa-question-circle"></i> FAQ</a></li>
<li><a href="../../groups.html"><i class="fas fa-users"></i> Groups</a></li>
<li><a href="../../badges.html"><i class="fas fa-certificate"></i> Badges</a></li>
</ul>
<h3 style="font-size: 13px;"><a href="#categories"><span>▼</span>Categories</a></h3>
<hr/>
<ul class="sidebar-grid categories">
<li>
<a class="badge-wrapper bullet" href="../../c/support/6.html">
<span class="badge-category-bg" style="background-color: #BF1E2E"></span>
<span class="badge-category clear-badge">
<span class="category-name">Support</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/feature-requests/5.html">
<span class="badge-category-bg" style="background-color: #3AB54A"></span>
<span class="badge-category clear-badge">
<span class="category-name">Feature Requests</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/uncategorized/1.html">
<span class="badge-category-bg" style="background-color: #AB9364"></span>
<span class="badge-category clear-badge">
<span class="category-name">Uncategorized</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/development/7.html">
<span class="badge-category-bg" style="background-color: #8C6238"></span>
<span class="badge-category clear-badge">
<span class="category-name">Development</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/tips-tricks-query-examples/11.html">
<span class="badge-category-bg" style="background-color: #652D90"></span>
<span class="badge-category clear-badge" style="white-space: normal;">
<span class="category-name">Tips, Tricks &amp; Query Examples</span>
</span>
</a>
</li>
<li><a href="../../categories.html"><i class="fas fa-list-ul"></i> All categories</a></li>
</ul>
<h3 style="font-size: 13px;"><a href="#tags"><span>▼</span>Tags</a></h3>
<hr/>
<ul class="sidebar-grid tags">
<li><a href="../../tag/query_results.html"><i class="fas fa-tag"></i> query_results</a></li>
<li><a href="../../tag/feature-request.html"><i class="fas fa-tag"></i> feature-request</a></li>
<li><a href="../../tag/parameters.html"><i class="fas fa-tag"></i> parameters</a></li>
<li><a href="../../tag/visualizations.html"><i class="fas fa-tag"></i> visualizations</a></li>
<li><a href="../../tag/alerts.html"><i class="fas fa-tag"></i> alerts</a></li>
<li><a href="../../tags.html"><i class="fas fa-list-ul"></i> All tags</a></li>
</ul>
</div>
<div class="sidebar-footer">
            © 2023 <a href="https://discuss.redash.io/" target="_blank">discuss.redash.io</a>
</div>
</div>
<div class="overlay"></div>
<div class="content">
<div class="global-notice">
<div class="row">
<div class="alert alert-info alert-read-only" id="global-notice-alert-read-only">
<span class="text">This site is in read only mode. Please continue to browse, but replying, likes,
                        and other actions are disabled for now.</span>
</div>
</div>
</div>
<div class="imported_page" id="imported_page">
<div class="wrap" id="main-outlet" role="main">
<div id="topic-title">
<h1>
<a href="/t/redash-6-0-0-internal-server-error/4355">Redash 6.0.0 Internal Server Error</a>
</h1>
<div class="topic-category" itemscope="" itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
<a class="badge-wrapper bullet" href="../../c/support/6.html" itemprop="item">
<span class="badge-category-bg" style="background-color: #BF1E2E"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Support</span>
</span>
</a>
<meta content="1" itemprop="position"/>
</span>
<span itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
<a class="badge-wrapper bullet" href="../../c/support/support-self-hosted/9.html" itemprop="item">
<span class="badge-category-bg" style="background-color: #AB9364"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Self Hosted Redash Support</span>
</span>
</a>
<meta content="2" itemprop="position"/>
</span>
</div>
</div>
<div itemscope="" itemtype="http://schema.org/DiscussionForumPosting">
<meta content="Redash 6.0.0 Internal Server Error" itemprop="headline"/>
<meta content="Self Hosted Redash Support" itemprop="articleSection"/>
<meta content="" itemprop="keywords"/>
<div itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
<meta content="Redash Discourse" itemprop="name"/>
<div itemprop="logo" itemscope="" itemtype="http://schema.org/ImageObject">
<meta content="https://global.discourse-cdn.com/standard17/uploads/redash1/original/1X/c07bc573841e1e4a0013ea3b6fe088a1534228a3.png" itemprop="url"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_1">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/robinwangrubin.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/robinwangrubin_avatar.png" tabindex="-1" width="48"/><span itemprop="name">robinwangrubin</span></a>
</span>
<link href="https://discuss.redash.io/t/redash-6-0-0-internal-server-error/4355" itemprop="mainEntityOfPage"/>
<link href="https://global.discourse-cdn.com/standard17/uploads/redash1/original/2X/e/e055c3859fc00c4be788ff654c37899e8d9a3208.png" itemprop="image"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2019-08-20T08:17:52Z" itemprop="datePublished">
                    August 20, 2019,  8:17am
                  </time>
<meta content="2019-08-20T08:17:52Z" itemprop="dateModified"/>
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<h3>
<a class="anchor" href="#issue-summary-1" name="issue-summary-1"></a>Issue Summary</h3>
<p><div class="lightbox-wrapper"><a class="lightbox" data-download-href="/uploads/short-url/w0yHu7rHBPgxoonjKFNelMizVEI.png?dl=1" href="https://global.discourse-cdn.com/standard17/uploads/redash1/original/2X/e/e055c3859fc00c4be788ff654c37899e8d9a3208.png" rel="noopener nofollow ugc" title="image"><img alt="image" data-base62-sha1="w0yHu7rHBPgxoonjKFNelMizVEI" data-small-upload="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/e/e055c3859fc00c4be788ff654c37899e8d9a3208_2_10x10.png" height="95" src="assets/e055c3859fc00c4be788ff654c37899e8d9a3208_2_690x95.png" srcset="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/e/e055c3859fc00c4be788ff654c37899e8d9a3208_2_690x95.png, https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/e/e055c3859fc00c4be788ff654c37899e8d9a3208_2_1035x142.png 1.5x, https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/e/e055c3859fc00c4be788ff654c37899e8d9a3208_2_1380x190.png 2x" width="690"/><div class="meta">
<svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">2526×348 16.1 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
<h3>
<a class="anchor" href="#technical-details-2" name="technical-details-2"></a>Technical details:</h3>
<ul>
<li>Redash Version: 6.0.0</li>
<li>Browser/OS: Chrome/Mac</li>
<li>How did you install Redash:  docker swarm stack</li>
</ul>
<pre><code class="lang-auto">version: '2'
services:
  server:
    image: redash/redash:6.0.0.b8537
    command: server
    depends_on:
      - postgres
    networks:
      - web
      - database
    environment:
      PYTHONUNBUFFERED: 0
      REDASH_HOST: "http://redash.xxxxx.com"
      REDASH_LOG_LEVEL: "DEBUG"
      REDASH_REDIS_URL: "redis://redis:6379/0"
      REDASH_DATABASE_URL: "postgresql://postgres@postgres/postgres"
      REDASH_COOKIE_SECRET: "xxxxxx"
      REDASH_WEB_WORKERS: 4
    deploy:
      replicas: 1
      labels:
        traefik.docker.network: "web"
        traefik.port: "5000"
        traefik.frontend.rule: "Host:redash.xxxx.com"
      placement:
        constraints: [node.role==worker]
  worker:
    image: redash/redash:6.0.0.b8537
    command: scheduler
    networks:
      - web
      - database
    environment:
      PYTHONUNBUFFERED: 0
      REDASH_HOST: "http://redash.xxxx.com"
      REDASH_LOG_LEVEL: "INFO"
      REDASH_REDIS_URL: "redis://redis:6379/0"
      REDASH_DATABASE_URL: "postgresql://postgres@postgres/postgres"
      QUEUES: "queries,scheduled_queries,celery"
      WORKERS_COUNT: 2
    deploy:
      replicas: 1     
      placement:
        constraints: [node.role==worker]  
  postgres:
    image: postgres:9.5.6-alpine
    volumes:
      - postgresql_data:/var/lib/postgresql/data
    networks:
      - database
    deploy:
      replicas: 1     
      placement:
        constraints: [node.hostname==dev-swarm-xxxx.com]  

networks:
  web:
    external: true
  database:
    external: true

volumes:
  postgresql_data:
</code></pre>
<p>It had worked well for several monthes. But this morning, I found it doesn’t work.<br/>
PS. No one erase the Database, I’m sure 100%</p>
<p>Here is the DEBUG Log:</p>
<pre><code class="lang-auto">[SQL: 'SELECT organizations.updated_at AS organizations_updated_at, organizations.created_at AS organizations_created_at, organizations.id AS organizations_id, organizations.name AS organizations_name, organizations.slug AS organizations_slug, organizations.settings AS organizations_settings \nFROM organizations \nWHERE organizations.slug = %(slug_1)s \n LIMIT %(param_1)s'] [parameters: {'slug_1': 'default', 'param_1': 1}] (Background on this error at: http://sqlalche.me/e/f405)
[2019-08-20 05:54:28,444][PID:13][ERROR][redash] Exception on /favicon.ico [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/flask/app.py", line 1988, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python2.7/dist-packages/flask/app.py", line 1641, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python2.7/dist-packages/flask_restful/__init__.py", line 271, in error_router
    return original_handler(e)
  File "/usr/local/lib/python2.7/dist-packages/flask/app.py", line 1544, in handle_user_exception
    reraise(exc_type, exc_value, tb)
  File "/usr/local/lib/python2.7/dist-packages/flask/app.py", line 1639, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python2.7/dist-packages/flask/app.py", line 1625, in dispatch_request
    return self.view_functions[rule.endpoint](**req.view_args)
  File "/usr/local/lib/python2.7/dist-packages/flask_login/utils.py", line 226, in decorated_view
    elif not current_user.is_authenticated:
  File "/usr/local/lib/python2.7/dist-packages/werkzeug/local.py", line 343, in __getattr__
    return getattr(self._get_current_object(), name)
  File "/usr/local/lib/python2.7/dist-packages/werkzeug/local.py", line 302, in _get_current_object
    return self.__local()
  File "/usr/local/lib/python2.7/dist-packages/flask_login/utils.py", line 26, in &lt;lambda&gt;
    current_user = LocalProxy(lambda: _get_user())
  File "/usr/local/lib/python2.7/dist-packages/flask_login/utils.py", line 302, in _get_user
    current_app.login_manager._load_user()
  File "/usr/local/lib/python2.7/dist-packages/flask_login/login_manager.py", line 311, in _load_user
    return self._load_from_cookie(request.cookies[cookie_name])
  File "/usr/local/lib/python2.7/dist-packages/flask_login/login_manager.py", line 350, in _load_from_cookie
    self.reload_user()
  File "/usr/local/lib/python2.7/dist-packages/flask_login/login_manager.py", line 279, in reload_user
    user = self.user_callback(user_id)
  File "/app/redash/authentication/__init__.py", line 44, in load_user
    org = current_org._get_current_object()
  File "/usr/local/lib/python2.7/dist-packages/werkzeug/local.py", line 302, in _get_current_object
    return self.__local()
  File "/app/redash/authentication/org_resolving.py", line 14, in _get_current_org
    g.org = Organization.get_by_slug(slug)
  File "/app/redash/models.py", line 325, in get_by_slug
    return cls.query.filter(cls.slug == slug).first()
  File "/usr/local/lib/python2.7/dist-packages/sqlalchemy/orm/query.py", line 2825, in first
    ret = list(self[0:1])
  File "/usr/local/lib/python2.7/dist-packages/sqlalchemy/orm/query.py", line 2617, in __getitem__
    return list(res)
  File "/usr/local/lib/python2.7/dist-packages/sqlalchemy/orm/query.py", line 2925, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/lib/python2.7/dist-packages/sqlalchemy/orm/query.py", line 2948, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/lib/python2.7/dist-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/lib/python2.7/dist-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/lib/python2.7/dist-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/lib/python2.7/dist-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/lib/python2.7/dist-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/lib/python2.7/dist-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/lib/python2.7/dist-packages/sqlalchemy/engine/default.py", line 507, in do_execute
    cursor.execute(statement, parameters)
ProgrammingError: (psycopg2.ProgrammingError) relation "organizations" does not exist
LINE 2: FROM organizations 
             ^
 [SQL: 'SELECT organizations.updated_at AS organizations_updated_at, organizations.created_at AS organizations_created_at, organizations.id AS organizations_id, organizations.name AS organizations_name, organizations.slug AS organizations_slug, organizations.settings AS organizations_settings \nFROM organizations \nWHERE organizations.slug = %(slug_1)s \n LIMIT %(param_1)s'] [parameters: {'slug_1': 'default', 'param_1': 1}] (Background on this error at: http://sqlalche.me/e/f405)
[2019-08-20 05:54:28,445][PID:13][INFO][metrics] method=GET path=/favicon.ico endpoint=redash_index status=500 content_type=? content_length=-1 duration=3.81 query_count=0 query_duration=0.00
</code></pre>
<p>Does anyone have some ideas to solve this problem?</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_2" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/levko.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/levko_avatar.png" tabindex="-1" width="48"/><span itemprop="name">levko</span></a>
</span>
<link href="https://discuss.redash.io/t/redash-6-0-0-internal-server-error/4355" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2019-08-20T08:42:32Z" itemprop="datePublished">
                    August 20, 2019,  8:42am
                  </time>
<meta content="2019-08-20T08:42:32Z" itemprop="dateModified"/>
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Hi <a class="mention" href="/u/robinwangrubin">@robinwangrubin</a> and welcome!</p>
<p>Original error says that “relation “organizations” does not exist”. In this case, I’d first check if Redash is trying to connect the right Postgres instance (not by checking docker configs, but in fact - connect to the same network and check what’s available from there). Then, I’d connect to that Postgres instance and check if other tables are missing as well.</p>
<p>If only “organizations” table is missing - most likely somebody removed it accidentally (maybe even via executing a wrong query in Redash UI). In this case you should restore it manually.</p>
<p>If all tables are missing - first of all, check if Postgres instance uses right docker volumes (if no - point it to the right place). Then check if DB files are available there and if they’re not corrupted.</p>
<p>After all, it’s possible that you have some issues with your HDD/SSD (I personally faced an issue with Samsung SSD which after some time started reporting that all file operations are successful but in fact didn’t store any data).</p>
<p>At worst, I hope you have a DB backups which you can use to restore your data.</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="2" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_3" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/robinwangrubin.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/robinwangrubin_avatar.png" tabindex="-1" width="48"/><span itemprop="name">robinwangrubin</span></a>
</span>
<link href="https://discuss.redash.io/t/redash-6-0-0-internal-server-error/4355" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2019-08-20T10:16:00Z" itemprop="datePublished">
                    August 20, 2019, 10:16am
                  </time>
<meta content="2019-08-20T10:16:00Z" itemprop="dateModified"/>
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<aside class="quote group-Team" data-post="2" data-topic="4355">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" src="assets/341_2.png" width="20"/> levko:</div>
<blockquote>
<p>hen check if DB files are available there and if they’re not corrupted.</p>
</blockquote>
</aside>
<p><a class="mention" href="/u/levko">@levko</a>   Oh…It’s you!  Thanks a lot for your advice and being patient. I’ve tried to follow your steps to check my Databases. And i found there is nothing in my databases.<br/>
Maybe it’s because i clean disk by using [docker system prune -af] this command.</p>
<p>Thank you again.</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_4" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/robinwangrubin.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/robinwangrubin_avatar.png" tabindex="-1" width="48"/><span itemprop="name">robinwangrubin</span></a>
</span>
<link href="https://discuss.redash.io/t/redash-6-0-0-internal-server-error/4355" itemprop="mainEntityOfPage"/>
<link href="https://global.discourse-cdn.com/standard17/uploads/redash1/original/2X/4/481164540c25b4dadd821cb46aa2f2c3cb47c080.png" itemprop="image"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2019-08-20T10:47:28Z" itemprop="datePublished">
                    August 20, 2019, 10:47am
                  </time>
<meta content="2019-08-20T10:47:28Z" itemprop="dateModified"/>
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Now, I try to initialize Database</p>
<pre><code class="lang-auto">root@dev-swarm-worker03:~# docker run -it --rm     --network redash-temp     --env PYTHONUNBUFFERED=0     --env REDASH_LOG_LEVEL="INFO"     --env REDASH_REDIS_URL="redis://dev-xxxxxx.com:8379/0"     --env REDASH_DATABASE_URL="postgresql://postgres@postgres/postgres"     --env REDASH_COOKIE_SECRET="xxxxx"     --env REDASH_WEB_WORKERS=4     --log-driver json-file --log-opt max-size=10m     redash/redash:latest create_db
[2019-08-20 10:18:38,085][PID:1][INFO][root] Generating grammar tables from /usr/lib/python2.7/lib2to3/Grammar.txt
[2019-08-20 10:18:38,105][PID:1][INFO][root] Generating grammar tables from /usr/lib/python2.7/lib2to3/PatternGrammar.txt
[2019-08-20 10:18:40,342][PID:1][INFO][alembic.runtime.migration] Context impl PostgresqlImpl.
[2019-08-20 10:18:40,343][PID:1][INFO][alembic.runtime.migration] Will assume transactional DDL.
[2019-08-20 10:18:40,356][PID:1][INFO][alembic.runtime.migration] Running stamp_revision  -&gt; e5c7a4e2df4d
</code></pre>
<p>It looks like my initialization is successful</p>
<p>When i try to acess the web:<br/>
<div class="lightbox-wrapper"><a class="lightbox" data-download-href="/uploads/short-url/ahxDFD597fvioHVPcUW4KAqWiTm.png?dl=1" href="https://global.discourse-cdn.com/standard17/uploads/redash1/original/2X/4/481164540c25b4dadd821cb46aa2f2c3cb47c080.png" rel="noopener nofollow ugc" title="image"><img alt="image" data-base62-sha1="ahxDFD597fvioHVPcUW4KAqWiTm" data-small-upload="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/4/481164540c25b4dadd821cb46aa2f2c3cb47c080_2_10x10.png" height="334" src="assets/481164540c25b4dadd821cb46aa2f2c3cb47c080_2_690x334.png" srcset="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/4/481164540c25b4dadd821cb46aa2f2c3cb47c080_2_690x334.png, https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/4/481164540c25b4dadd821cb46aa2f2c3cb47c080_2_1035x501.png 1.5x, https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/4/481164540c25b4dadd821cb46aa2f2c3cb47c080_2_1380x668.png 2x" width="690"/><div class="meta">
<svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">1994×966 29.3 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>The log like this:</p>
<pre><code class="lang-auto">[2019-08-20 10:35:00 +0000] [1] [INFO] Starting gunicorn 19.7.1
[2019-08-20 10:35:00 +0000] [1] [INFO] Listening at: http://0.0.0.0:5000 (1)
[2019-08-20 10:35:00 +0000] [1] [INFO] Using worker: sync
[2019-08-20 10:35:00 +0000] [10] [INFO] Booting worker with pid: 10
[2019-08-20 10:35:00 +0000] [13] [INFO] Booting worker with pid: 13
[2019-08-20 10:35:00 +0000] [16] [INFO] Booting worker with pid: 16
[2019-08-20 10:35:00 +0000] [19] [INFO] Booting worker with pid: 19
[2019-08-20 10:35:00,856][PID:13][INFO][root] Generating grammar tables from /usr/lib/python2.7/lib2to3/Grammar.txt
[2019-08-20 10:35:00,902][PID:10][INFO][root] Generating grammar tables from /usr/lib/python2.7/lib2to3/Grammar.txt
[2019-08-20 10:35:00,984][PID:13][INFO][root] Generating grammar tables from /usr/lib/python2.7/lib2to3/PatternGrammar.txt
[2019-08-20 10:35:01,043][PID:10][INFO][root] Generating grammar tables from /usr/lib/python2.7/lib2to3/PatternGrammar.txt
[2019-08-20 10:35:01,113][PID:16][INFO][root] Generating grammar tables from /usr/lib/python2.7/lib2to3/Grammar.txt
[2019-08-20 10:35:01,142][PID:19][INFO][root] Generating grammar tables from /usr/lib/python2.7/lib2to3/Grammar.txt
[2019-08-20 10:35:01,238][PID:16][INFO][root] Generating grammar tables from /usr/lib/python2.7/lib2to3/PatternGrammar.txt
[2019-08-20 10:35:01,255][PID:19][INFO][root] Generating grammar tables from /usr/lib/python2.7/lib2to3/PatternGrammar.txt
[2019-08-20 10:35:09,536][PID:10][INFO][metrics] method=GET path=/ endpoint=redash_index status=304 content_type=text/html; charset=utf-8 content_length=926 duration=21.88 query_count=2 query_duration=3.62
[2019-08-20 10:35:09,900][PID:10][INFO][metrics] method=GET path=/static/images/favicon-32x32.png endpoint=static status=200 content_type=image/png content_length=2005 duration=0.59 query_count=0 query_duration=0.00
[2019-08-20 10:35:09,924][PID:16][INFO][metrics] method=GET path=/api/session endpoint=redash_session status=200 content_type=application/json content_length=1185 duration=23.86 query_count=3 query_duration=5.36
[2019-08-20 10:35:09,966] ERROR in app: Exception on /api/organization/status [GET]
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/flask/app.py", line 1988, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python2.7/dist-packages/flask/app.py", line 1641, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python2.7/dist-packages/flask_restful/__init__.py", line 271, in error_router
    return original_handler(e)
  File "/usr/local/lib/python2.7/dist-packages/flask/app.py", line 1544, in handle_user_exception
    reraise(exc_type, exc_value, tb)
  File "/usr/local/lib/python2.7/dist-packages/flask/app.py", line 1639, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python2.7/dist-packages/flask/app.py", line 1625, in dispatch_request
    return self.view_functions[rule.endpoint](**req.view_args)
  File "/usr/local/lib/python2.7/dist-packages/flask_login/utils.py", line 228, in decorated_view
    return func(*args, **kwargs)
  File "/app/redash/handlers/organization.py", line 15, in organization_status
    'data_sources': models.DataSource.all(current_org, group_ids=current_user.group_ids).count(),
  File "/usr/local/lib/python2.7/dist-packages/sqlalchemy/orm/query.py", line 3160, in count
    return self.from_self(col).scalar()
  File "/usr/local/lib/python2.7/dist-packages/sqlalchemy/orm/query.py", line 2913, in scalar
    ret = self.one()
  File "/usr/local/lib/python2.7/dist-packages/sqlalchemy/orm/query.py", line 2884, in one
    ret = self.one_or_none()
  File "/usr/local/lib/python2.7/dist-packages/sqlalchemy/orm/query.py", line 2854, in one_or_none
    ret = list(self)
  File "/usr/local/lib/python2.7/dist-packages/sqlalchemy/orm/query.py", line 2925, in __iter__
    return self._execute_and_instances(context)
  File "/usr/local/lib/python2.7/dist-packages/sqlalchemy/orm/query.py", line 2948, in _execute_and_instances
    result = conn.execute(querycontext.statement, self._params)
  File "/usr/local/lib/python2.7/dist-packages/sqlalchemy/engine/base.py", line 948, in execute
    return meth(self, multiparams, params)
  File "/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/elements.py", line 269, in _execute_on_connection
    return connection._execute_clauseelement(self, multiparams, params)
  File "/usr/local/lib/python2.7/dist-packages/sqlalchemy/engine/base.py", line 1060, in _execute_clauseelement
    compiled_sql, distilled_params
  File "/usr/local/lib/python2.7/dist-packages/sqlalchemy/engine/base.py", line 1200, in _execute_context
    context)
  File "/usr/local/lib/python2.7/dist-packages/sqlalchemy/engine/base.py", line 1413, in _handle_dbapi_exception
    exc_info
  File "/usr/local/lib/python2.7/dist-packages/sqlalchemy/util/compat.py", line 203, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "/usr/local/lib/python2.7/dist-packages/sqlalchemy/engine/base.py", line 1193, in _execute_context
    context)
  File "/usr/local/lib/python2.7/dist-packages/sqlalchemy/engine/default.py", line 507, in do_execute
    cursor.execute(statement, parameters)
ProgrammingError: (psycopg2.ProgrammingError) column data_sources.options does not exist
LINE 2: ...ces_name, data_sources.type AS data_sources_type, data_sourc...
                                                             ^
 [SQL: 'SELECT count(*) AS count_1 \nFROM (SELECT DISTINCT data_sources.id AS data_sources_id, data_sources.org_id AS data_sources_org_id, data_sources.name AS data_sources_name, data_sources.type AS data_sources_type, data_sources.options AS data_sources_options, data_sources.queue_name AS data_sources_queue_name, data_sources.scheduled_queue_name AS data_sources_scheduled_queue_name, data_sources.created_at AS data_sources_created_at \nFROM data_sources JOIN data_source_groups ON data_sources.id = data_source_groups.data_source_id \nWHERE %(param_1)s = data_sources.org_id AND data_source_groups.group_id IN (%(group_id_1)s, %(group_id_2)s) ORDER BY data_sources.id ASC) AS anon_1'] [parameters: {'group_id_1': 1, 'group_id_2': 2, 'param_1': 1}] (Background on this error at: http://sqlalche.me/e/f405)
</code></pre>
<p>It’s a totally new database;</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_5" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/levko.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/levko_avatar.png" tabindex="-1" width="48"/><span itemprop="name">levko</span></a>
</span>
<link href="https://discuss.redash.io/t/redash-6-0-0-internal-server-error/4355" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2019-08-20T14:48:32Z" itemprop="datePublished">
                    August 20, 2019,  2:48pm
                  </time>
<meta content="2019-08-20T14:48:32Z" itemprop="dateModified"/>
<span itemprop="position">5</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Try to run migrations as well: <code>docker-compose run --rm server manage db upgrade</code> (please change it accordingly to your setup)</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="overlay" id="modalOverlay" style="display: none;">
<div class="modal-content">
<p>Login or sign up disabled while the site is in read only mode</p>
<hr/>
<button class="btn btn-login">OK</button>
</div>
</div>
<script src="../../js/script.js"></script>
</body>
</html>