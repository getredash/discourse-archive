<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet"/>
<link href="../../css/checklist_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/desktop_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/desktop_theme_2_be4cb2b86ec06123c5e974acd20fd933d14b129d.css" rel="stylesheet"/>
<link href="../../css/discourse-adplugin_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-akismet_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-cakeday_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-chat-integration_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-details_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-footnote_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-lazy-videos_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-local-dates_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/color_definitions_base__2_8fd59ae1f286f43b3ff17996df07ea951685249d.css" rel="stylesheet"/>
<link href="../../css/style.css" rel="stylesheet"/>
<title>Updating to v8 failed, can't seem to import db to brand new docker image either</title></head>
<body>
<div class="navbar">
<div class="logo"><a href="../../page_0.html"><img alt="" src="../../images/logo_redash.png" srcset=""/></a></div>
<div class="navbar-buttons">
<button class="btn btn-signup">Sign Up</button>
<button class="btn btn-login"><i class="fas fa-user"></i> Login</button>
<button class="btn btn-search"><i class="fas fa-search"></i></button>
<div class="navbar-toggle">
<div class="dots"></div>
<div class="dots"></div>
<div class="dots"></div>
</div>
</div>
</div>
<div class="sidebar">
<div class="sidebar-content">
<div class="logo"><a href="../../page_0.html"><img alt="" src="../../images/logo_redash.png" srcset=""/></a></div>
<ul class="sidebar-grid">
<!-- <li><a href="#"><i class="fas fa-list-ul"></i> Topics</a></li> -->
<li><a href="../../page_0.html"><i class="fas fa-layer-group"></i> Topics</a></li>
<li><a href="../../users.html"><i class="fas fa-users"></i> Users</a></li>
<li><a href="../../about.html"><i class="fas fa-info-circle"></i> About</a></li>
<li><a href="../../faq.html"><i class="fas fa-question-circle"></i> FAQ</a></li>
<li><a href="../../groups.html"><i class="fas fa-users"></i> Groups</a></li>
<li><a href="../../badges.html"><i class="fas fa-certificate"></i> Badges</a></li>
</ul>
<h3 style="font-size: 13px;"><a href="#categories"><span>▼</span>Categories</a></h3>
<hr/>
<ul class="sidebar-grid categories">
<li>
<a class="badge-wrapper bullet" href="../../c/support/6.html">
<span class="badge-category-bg" style="background-color: #BF1E2E"></span>
<span class="badge-category clear-badge">
<span class="category-name">Support</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/feature-requests/5.html">
<span class="badge-category-bg" style="background-color: #3AB54A"></span>
<span class="badge-category clear-badge">
<span class="category-name">Feature Requests</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/uncategorized/1.html">
<span class="badge-category-bg" style="background-color: #AB9364"></span>
<span class="badge-category clear-badge">
<span class="category-name">Uncategorized</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/development/7.html">
<span class="badge-category-bg" style="background-color: #8C6238"></span>
<span class="badge-category clear-badge">
<span class="category-name">Development</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/tips-tricks-query-examples/11.html">
<span class="badge-category-bg" style="background-color: #652D90"></span>
<span class="badge-category clear-badge" style="white-space: normal;">
<span class="category-name">Tips, Tricks &amp; Query Examples</span>
</span>
</a>
</li>
<li><a href="../../categories.html"><i class="fas fa-list-ul"></i> All categories</a></li>
</ul>
<h3 style="font-size: 13px;"><a href="#tags"><span>▼</span>Tags</a></h3>
<hr/>
<ul class="sidebar-grid tags">
<li><a href="../../tag/query_results.html"><i class="fas fa-tag"></i> query_results</a></li>
<li><a href="../../tag/feature-request.html"><i class="fas fa-tag"></i> feature-request</a></li>
<li><a href="../../tag/parameters.html"><i class="fas fa-tag"></i> parameters</a></li>
<li><a href="../../tag/visualizations.html"><i class="fas fa-tag"></i> visualizations</a></li>
<li><a href="../../tag/alerts.html"><i class="fas fa-tag"></i> alerts</a></li>
<li><a href="../../tags.html"><i class="fas fa-list-ul"></i> All tags</a></li>
</ul>
</div>
<div class="sidebar-footer">
            © 2023 <a href="https://discuss.redash.io/" target="_blank">discuss.redash.io</a>
</div>
</div>
<div class="overlay"></div>
<div class="content">
<div class="global-notice">
<div class="row">
<div class="alert alert-info alert-read-only" id="global-notice-alert-read-only">
<span class="text">This site is in read only mode. Please continue to browse, but replying, likes,
                        and other actions are disabled for now.</span>
</div>
</div>
</div>
<div class="imported_page" id="imported_page">
<div class="wrap" id="main-outlet" role="main">
<div id="topic-title">
<h1>
<a href="/t/updating-to-v8-failed-cant-seem-to-import-db-to-brand-new-docker-image-either/4973">Updating to v8 failed, can't seem to import db to brand new docker image either</a>
</h1>
<div class="topic-category" itemscope="" itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
<a class="badge-wrapper bullet" href="../../c/support/6.html" itemprop="item">
<span class="badge-category-bg" style="background-color: #BF1E2E"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Support</span>
</span>
</a>
<meta content="1" itemprop="position"/>
</span>
<span itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
<a class="badge-wrapper bullet" href="../../c/support/support-self-hosted/9.html" itemprop="item">
<span class="badge-category-bg" style="background-color: #AB9364"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Self Hosted Redash Support</span>
</span>
</a>
<meta content="2" itemprop="position"/>
</span>
</div>
</div>
<div itemscope="" itemtype="http://schema.org/DiscussionForumPosting">
<meta content="Updating to v8 failed, can't seem to import db to brand new docker image either" itemprop="headline"/>
<meta content="Self Hosted Redash Support" itemprop="articleSection"/>
<meta content="" itemprop="keywords"/>
<div itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
<meta content="Redash Discourse" itemprop="name"/>
<div itemprop="logo" itemscope="" itemtype="http://schema.org/ImageObject">
<meta content="https://global.discourse-cdn.com/standard17/uploads/redash1/original/1X/c07bc573841e1e4a0013ea3b6fe088a1534228a3.png" itemprop="url"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_1">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/lardconcepts.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/lardconcepts_avatar.png" tabindex="-1" width="48"/><span itemprop="name">lardconcepts</span></a>
</span>
<link href="https://discuss.redash.io/t/updating-to-v8-failed-cant-seem-to-import-db-to-brand-new-docker-image-either/4973" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2019-11-15T10:19:37Z" itemprop="datePublished">
                    November 15, 2019, 10:19am
                  </time>
<meta content="2019-11-15T10:19:37Z" itemprop="dateModified"/>
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p>Tried to update to v8 using /latest tag in docker-compose.yml but it failed as per this post which got no replies.</p><aside class="quote quote-modified" data-post="21" data-topic="4847">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" loading="lazy" src="https://avatars.discourse-cdn.com/v4/letter/l/3ab097/40.png" width="20"/>
<a href="http://discuss.redash.io/t/update-to-version-8-0-0-0/4847/21">Update to version 8.0.0.0</a> <a class="badge-wrapper bullet" href="/c/support/support-self-hosted/9"><span class="badge-category-parent-bg" style="background-color: #BF1E2E;"></span><span class="badge-category-bg" style="background-color: #AB9364;"></span><span class="badge-category clear-badge" data-drop-close="true" style="" title="Support on installing, configuring and troubleshooting issues with self hosted Redash.">Self Hosted Redash Support</span></a>
</div>
<blockquote>
    Well, it LOOKS like it’s upgraded - but it doesn’t. Worked OK during last upgrade. Using official Redash Docker image on AWS. 
Did a reboot and everything, but my dashboard still says 7.0.0+b18042 
Very often fails to restart after update and needs a reboot. 
ubuntu@ip-xx-xx-xx:/opt/redash$ sudo docker-compose stop server scheduler scheduled_worker adhoc_worker
Stopping redash_scheduled_worker_1 ... done
Stopping redash_scheduler_1        ... done
Stopping redash_adhoc_worker_1     ... done
Stop…
  </blockquote>
</aside>
<p>Then I tried replacing docker-compose.yml with the latest from github, and it updated, but even after reboot, I got the error " <em>could not translate host name</em>  “ <em>postgres” to address</em>"</p>
<p>Launched a brand new install from the official Redash AWS v8 image, did the following with the database from following forums:</p>
<p>On old server<br/>
<code>sudo rsync -aP /opt/redash/postgres-data postgres-datav7</code></p>
<p>move to new server</p>
<p>On new server</p>
<pre><code>docker-compose stop server scheduler scheduled_worker adhoc_worker
sudo mv /opt/redash/postgres-data /opt/redash/postgres-data-bak
sudo mv postgres-datav7 /opt/redash/postgres-data
docker-compose run --rm server manage db upgrade
docker-compose up -d
</code></pre>
<p>Appeared to go OK, but browsing to site gives 500 internal server error, so…<br/>
docker-compose stop server scheduler scheduled_worker adhoc_worker<br/>
sudo rm -rf /opt/redash/postgres-data<br/>
sudo mv /opt/redash/postgres-data-bak /opt/redash/postgres-data<br/>
docker-compose run --rm server manage db upgrade</p>
<p>= loads of errors from python</p>
<p>Reboot. Still stuck. Going to blow away this new instance and try again, again.<br/>
All I really want is my connection to dynamodb and dashboard queries so I don’t have to rebuild them</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_2" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/jesse.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/jesse_avatar.png" tabindex="-1" width="48"/><span itemprop="name">jesse</span></a>
</span>
<link href="https://discuss.redash.io/t/updating-to-v8-failed-cant-seem-to-import-db-to-brand-new-docker-image-either/4973" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2019-11-19T03:20:16Z" itemprop="datePublished">
                    November 19, 2019,  3:20am
                  </time>
<meta content="2019-11-19T03:20:16Z" itemprop="dateModified"/>
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Have you had any luck after blowing away and starting from scratch?</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_3" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/lardconcepts.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/lardconcepts_avatar.png" tabindex="-1" width="48"/><span itemprop="name">lardconcepts</span></a>
</span>
<link href="https://discuss.redash.io/t/updating-to-v8-failed-cant-seem-to-import-db-to-brand-new-docker-image-either/4973" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2019-11-19T19:21:10Z" itemprop="datePublished">
                    November 19, 2019,  7:21pm
                  </time>
<meta content="2019-11-19T19:21:10Z" itemprop="dateModified"/>
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Yes, I can make a brand new image from the official image on AWS, but after that… how do I import my old database? I’d actually be happy if I could even just read my queries from the old database somehow…</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_4" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/jesse.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/jesse_avatar.png" tabindex="-1" width="48"/><span itemprop="name">jesse</span></a>
</span>
<link href="https://discuss.redash.io/t/updating-to-v8-failed-cant-seem-to-import-db-to-brand-new-docker-image-either/4973" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2019-11-19T20:00:34Z" itemprop="datePublished">
                    November 19, 2019,  8:00pm
                  </time>
<meta content="2019-11-19T20:00:34Z" itemprop="dateModified"/>
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Here are a few posts from the forum that cover moving the database from one installation to another.</p>
<aside class="quote quote-modified" data-post="1" data-topic="3665">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" loading="lazy" src="assets/1063_2.png" width="20"/>
<a href="http://discuss.redash.io/t/db-backup-of-self-hosted-redash/3665">DB backup of Self hosted redash</a> <a class="badge-wrapper bullet" href="/c/support/support-self-hosted/9"><span class="badge-category-parent-bg" style="background-color: #BF1E2E;"></span><span class="badge-category-bg" style="background-color: #AB9364;"></span><span class="badge-category clear-badge" data-drop-close="true" style="" title="Support on installing, configuring and troubleshooting issues with self hosted Redash.">Self Hosted Redash Support</span></a>
</div>
<blockquote>
    Issue Summary
Installed the redash version 5.0.2.b5486 on Ubuntu back in Nov-2018. Created few dashboards. Things are working fine. I am trying to copy the setup (dashboards/data sources etc) to a new box. Not able to figure out how to take the backup though. 
Tried to backup: 
# Uncompressed backup
$ sudo -u redash pg_dump &gt; backup_filename.sql
# redash user not found

I tried to see if postgres is running 
$ psql 
# not able to connect to db
# no postgres file in /var/run

Then I realized reda…
  </blockquote>
</aside>
<aside class="quote quote-modified" data-post="5" data-topic="4321">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" loading="lazy" src="assets/553_2.png" width="20"/>
<a href="http://discuss.redash.io/t/help-migrating-from-ubuntu-redash-v4-to-docker-redash-v7/4321/5">Help Migrating From Ubuntu Redash v4 to Docker Redash v7</a> <a class="badge-wrapper bullet" href="/c/support/support-self-hosted/9"><span class="badge-category-parent-bg" style="background-color: #BF1E2E;"></span><span class="badge-category-bg" style="background-color: #AB9364;"></span><span class="badge-category clear-badge" data-drop-close="true" style="" title="Support on installing, configuring and troubleshooting issues with self hosted Redash.">Self Hosted Redash Support</span></a>
</div>
<blockquote>
    I worked my way through the upgrades to the latest 7.0.0.b18042 today using the docker actions as shown in the upgrade guide. A few notes that may be of interest to others: 

I grabbed the latest setup/docker-compose.yml
Environment variables move out of my old docker-compose.yml and into the env file
Ensure correct postgres version and data mapping in docker-compose.yml
Firewall rules are added when recreating workers, ensure iptables/firewalld is up
One upgrade at a time 
End result, success. …
  </blockquote>
</aside>
<aside class="quote" data-post="1" data-topic="4180">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" loading="lazy" src="https://avatars.discourse-cdn.com/v4/letter/i/ccd318/40.png" width="20"/>
<a href="http://discuss.redash.io/t/upgrade-redash-stanalone-v4-to-v7-docker/4180">Upgrade Redash Stanalone V4 to V7 Docker</a>
</div>
<blockquote>
    Hi, 
I tried to find a fully guide on this but I couldn’t find. 
I would appreciate if you could guide me on that or send a “How to” link. 
Thanks, 
Ilan
  </blockquote>
</aside>
<aside class="quote" data-post="6" data-topic="3041">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" loading="lazy" src="assets/811_2.png" width="20"/>
<a href="http://discuss.redash.io/t/exact-steps-needed-for-upgrade/3041/6">Exact steps needed for upgrade?</a> <a class="badge-wrapper bullet" href="/c/support/support-self-hosted/9"><span class="badge-category-parent-bg" style="background-color: #BF1E2E;"></span><span class="badge-category-bg" style="background-color: #AB9364;"></span><span class="badge-category clear-badge" data-drop-close="true" style="" title="Support on installing, configuring and troubleshooting issues with self hosted Redash.">Self Hosted Redash Support</span></a>
</div>
<blockquote>
    Good point.  I’m still at the “setting things up in a dev environment” stage. 

Got that working, but it’s a bit wonky.  Not really much in the way of documentation (yet?) for an optimal Redash dev setup.  eg is the expected approach to run the containers, bind the (local development git clone) to the redash /app directory or something, etc? 
Anyway, I seem to have it working “enough” at the moment for what I need, so all good. <img alt="slight_smile" class="emoji" height="20" src="assets/slight_smile.png" title="slight_smile" width="20"/>
</blockquote>
</aside>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="overlay" id="modalOverlay" style="display: none;">
<div class="modal-content">
<p>Login or sign up disabled while the site is in read only mode</p>
<hr/>
<button class="btn btn-login">OK</button>
</div>
</div>
<script src="../../js/script.js"></script>
</body>
</html>