<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet"/>
<link href="../../css/checklist_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/desktop_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/desktop_theme_2_be4cb2b86ec06123c5e974acd20fd933d14b129d.css" rel="stylesheet"/>
<link href="../../css/discourse-adplugin_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-akismet_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-cakeday_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-chat-integration_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-details_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-footnote_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-lazy-videos_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-local-dates_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/color_definitions_base__2_8fd59ae1f286f43b3ff17996df07ea951685249d.css" rel="stylesheet"/>
<link href="../../css/style.css" rel="stylesheet"/>
<title>302 moved permanently (from disk cache) redirect on login</title></head>
<body>
<div class="navbar">
<div class="logo"><a href="../../page_0.html"><img alt="" src="../../images/logo_redash.png" srcset=""/></a></div>
<div class="navbar-buttons">
<button class="btn btn-signup">Sign Up</button>
<button class="btn btn-login"><i class="fas fa-user"></i> Login</button>
<button class="btn btn-search"><i class="fas fa-search"></i></button>
<div class="navbar-toggle">
<div class="dots"></div>
<div class="dots"></div>
<div class="dots"></div>
</div>
</div>
</div>
<div class="sidebar">
<div class="sidebar-content">
<div class="logo"><a href="../../page_0.html"><img alt="" src="../../images/logo_redash.png" srcset=""/></a></div>
<ul class="sidebar-grid">
<!-- <li><a href="#"><i class="fas fa-list-ul"></i> Topics</a></li> -->
<li><a href="../../page_0.html"><i class="fas fa-layer-group"></i> Topics</a></li>
<li><a href="../../users.html"><i class="fas fa-users"></i> Users</a></li>
<li><a href="../../about.html"><i class="fas fa-info-circle"></i> About</a></li>
<li><a href="../../faq.html"><i class="fas fa-question-circle"></i> FAQ</a></li>
<li><a href="../../groups.html"><i class="fas fa-users"></i> Groups</a></li>
<li><a href="../../badges.html"><i class="fas fa-certificate"></i> Badges</a></li>
</ul>
<h3 style="font-size: 13px;"><a href="#categories"><span>▼</span>Categories</a></h3>
<hr/>
<ul class="sidebar-grid categories">
<li>
<a class="badge-wrapper bullet" href="../../c/support/6.html">
<span class="badge-category-bg" style="background-color: #BF1E2E"></span>
<span class="badge-category clear-badge">
<span class="category-name">Support</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/feature-requests/5.html">
<span class="badge-category-bg" style="background-color: #3AB54A"></span>
<span class="badge-category clear-badge">
<span class="category-name">Feature Requests</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/uncategorized/1.html">
<span class="badge-category-bg" style="background-color: #AB9364"></span>
<span class="badge-category clear-badge">
<span class="category-name">Uncategorized</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/development/7.html">
<span class="badge-category-bg" style="background-color: #8C6238"></span>
<span class="badge-category clear-badge">
<span class="category-name">Development</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/tips-tricks-query-examples/11.html">
<span class="badge-category-bg" style="background-color: #652D90"></span>
<span class="badge-category clear-badge" style="white-space: normal;">
<span class="category-name">Tips, Tricks &amp; Query Examples</span>
</span>
</a>
</li>
<li><a href="../../categories.html"><i class="fas fa-list-ul"></i> All categories</a></li>
</ul>
<h3 style="font-size: 13px;"><a href="#tags"><span>▼</span>Tags</a></h3>
<hr/>
<ul class="sidebar-grid tags">
<li><a href="../../tag/query_results.html"><i class="fas fa-tag"></i> query_results</a></li>
<li><a href="../../tag/feature-request.html"><i class="fas fa-tag"></i> feature-request</a></li>
<li><a href="../../tag/parameters.html"><i class="fas fa-tag"></i> parameters</a></li>
<li><a href="../../tag/visualizations.html"><i class="fas fa-tag"></i> visualizations</a></li>
<li><a href="../../tag/alerts.html"><i class="fas fa-tag"></i> alerts</a></li>
<li><a href="../../tags.html"><i class="fas fa-list-ul"></i> All tags</a></li>
</ul>
</div>
<div class="sidebar-footer">
            © 2023 <a href="https://discuss.redash.io/" target="_blank">discuss.redash.io</a>
</div>
</div>
<div class="overlay"></div>
<div class="content">
<div class="global-notice">
<div class="row">
<div class="alert alert-info alert-read-only" id="global-notice-alert-read-only">
<span class="text">This site is in read only mode. Please continue to browse, but replying, likes,
                        and other actions are disabled for now.</span>
</div>
</div>
</div>
<div class="imported_page" id="imported_page">
<div class="wrap" id="main-outlet" role="main">
<div id="topic-title">
<h1>
<a href="/t/302-moved-permanently-from-disk-cache-redirect-on-login/10427">302 moved permanently (from disk cache) redirect on login</a>
</h1>
<div class="topic-category" itemscope="" itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
<a class="badge-wrapper bullet" href="../../c/support/6.html" itemprop="item">
<span class="badge-category-bg" style="background-color: #BF1E2E"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Support</span>
</span>
</a>
<meta content="1" itemprop="position"/>
</span>
</div>
</div>
<div itemscope="" itemtype="http://schema.org/DiscussionForumPosting">
<meta content="302 moved permanently (from disk cache) redirect on login" itemprop="headline"/>
<meta content="Support" itemprop="articleSection"/>
<meta content="" itemprop="keywords"/>
<div itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
<meta content="Redash Discourse" itemprop="name"/>
<div itemprop="logo" itemscope="" itemtype="http://schema.org/ImageObject">
<meta content="https://global.discourse-cdn.com/standard17/uploads/redash1/original/1X/c07bc573841e1e4a0013ea3b6fe088a1534228a3.png" itemprop="url"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_1">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/jmmiz.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/jmmiz_avatar.png" tabindex="-1" width="48"/><span itemprop="name">jmmiz</span></a>
</span>
<link href="assets/10427" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2022-05-04T20:56:39Z" itemprop="datePublished">
                    May 4, 2022,  8:56pm
                  </time>
<meta content="2022-05-04T20:56:39Z" itemprop="dateModified"/>
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p>I have HTTPS and Google OAuth set up but everytime I login I am taken back to the login page; however, if I change the url to say <code>https://&lt;mydomain&gt;/dashboards</code> I can get into redash just fine. Looking at the network attachment in chrome I can see I get a <code>302 moved permanently (from disk cache)</code> which redirects back to the login page. I saw there was a similar issue to this but I am using the AMI from us-east-1 so not able to configure the flask module</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_2" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/jmmiz.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/jmmiz_avatar.png" tabindex="-1" width="48"/><span itemprop="name">jmmiz</span></a>
</span>
<link href="assets/10427" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2022-05-05T16:52:30Z" itemprop="datePublished">
                    May 5, 2022,  4:52pm
                  </time>
<meta content="2022-05-05T16:52:30Z" itemprop="dateModified"/>
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I dug into my logs and these are what I find. When I authenticate with google I get a redirect 302 but it just takes me back to the login page and not the application</p>
<pre><code class="lang-auto">server_1            | [2022-05-05 13:40:38,362][PID:14][INFO][metrics] method=POST path=/ endpoint=unknown status=405 content_type=text/html content_length=178 duration=0.42 query_count=0 query_duration=0.00
server_1            | [2022-05-05 13:40:38,574][PID:9][INFO][metrics] method=GET path=/.env endpoint=redash_index status=302 content_type=text/html; charset=utf-8 content_length=297 duration=0.56 query_count=0 query_duration=0.00
server_1            | [2022-05-05 14:04:24,095][PID:10][INFO][metrics] method=GET path=/static/server.5cdfe7b4f652b665b03f.css endpoint=static status=304 content_type=text/css; charset=utf-8 content_length=187882 duration=0.57 query_count=2 query_duration=5.70
server_1            | [2022-05-05 14:04:24,095][PID:9][INFO][metrics] method=GET path=/static/js/jquery.min.js endpoint=static status=304 content_type=application/javascript content_length=86927 duration=1.72 query_count=2 query_duration=4.55
server_1            | [2022-05-05 14:04:25,654][PID:14][INFO][metrics] method=GET path=/oauth/google endpoint=google_oauth_authorize status=302 content_type=text/html; charset=utf-8 content_length=999 duration=0.66 query_count=2 query_duration=2.56
server_1            | [2022-05-05 14:24:25,534][PID:14][INFO][metrics] method=GET path=/.env endpoint=redash_index status=302 content_type=text/html; charset=utf-8 content_length=297 duration=0.56 query_count=0 query_duration=0.00
server_1            | [2022-05-05 14:24:25,552][PID:12][INFO][metrics] method=POST path=/ endpoint=unknown status=405 content_type=text/html content_length=178 duration=0.41 query_count=0 query_duration=0.00
server_1            | [2022-05-05 14:32:10,448][PID:12][INFO][metrics] method=GET path=/.env endpoint=redash_index status=302 content_type=text/html; charset=utf-8 content_length=297 duration=0.62 query_count=0 query_duration=0.00
server_1            | [2022-05-05 14:32:10,481][PID:9][INFO][metrics] method=GET path=/login endpoint=redash_login status=200 content_type=text/html; charset=utf-8 content_length=2027 duration=4.93 query_count=1 query_duration=1.17
server_1            | [2022-05-05 14:32:10,498][PID:10][INFO][metrics] method=GET path=/vendor/phpunit/phpunit/phpunit.xml endpoint=redash_index status=302 content_type=text/html; charset=utf-8 content_length=369 duration=0.58 query_count=0 query_duration=0.00
server_1            | [2022-05-05 14:32:10,559][PID:14][INFO][metrics] method=GET path=/login endpoint=redash_login status=200 content_type=text/html; charset=utf-8 content_length=2063 duration=4.31 query_count=1 query_duration=1.20
server_1            | [2022-05-05 14:42:05,671][PID:10][INFO][metrics] method=GET path=/.env endpoint=redash_index status=302 content_type=text/html; charset=utf-8 content_length=297 duration=0.58 query_count=0 query_duration=0.00
server_1            | [2022-05-05 14:42:07,424][PID:14][INFO][metrics] method=POST path=/ endpoint=unknown status=405 content_type=text/html content_length=178 duration=0.42 query_count=0 query_duration=0.00
server_1            | [2022-05-05 15:21:00,737][PID:9][INFO][metrics] method=POST path=/ endpoint=unknown status=405 content_type=text/html content_length=178 duration=0.39 query_count=0 query_duration=0.00
server_1            | [2022-05-05 15:21:00,933][PID:14][INFO][metrics] method=GET path=/.env endpoint=redash_index status=302 content_type=text/html; charset=utf-8 content_length=297 duration=0.58 query_count=0 query_duration=0.00
</code></pre>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_3" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/jmmiz.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/jmmiz_avatar.png" tabindex="-1" width="48"/><span itemprop="name">jmmiz</span></a>
</span>
<link href="assets/10427" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2022-05-05T19:34:04Z" itemprop="datePublished">
                    May 5, 2022,  7:34pm
                  </time>
<meta content="2022-05-05T19:34:04Z" itemprop="dateModified"/>
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Oddly enough the redirect started working; however, I have a weird security issue now where I had a user try to login and every time they login it is logging in under me now. They are on a separate device in incognito mode and when “Sign in with google” is clicked and they use their google account it signs in as me. Not entirely sure what is going on but any help would be greatly appreciated</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_4" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/jmmiz.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/jmmiz_avatar.png" tabindex="-1" width="48"/><span itemprop="name">jmmiz</span></a>
</span>
<link href="assets/10427" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2022-05-06T16:29:01Z" itemprop="datePublished">
                    May 6, 2022,  4:29pm
                  </time>
<meta content="2022-05-06T16:29:01Z" itemprop="dateModified"/>
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Solution to everything above in this thread:</p>
<p>Essentially using AWS CloudFront and Certificate Manager was causing a lot of 302 redirects since we were doing HTTP to HTTPS. When I would successfully login the redirect 302 would just take me back to the login page (due to cloudfront). The Google OAuth issue when a user would login from a different device and click “Sign in With Google” it would essentially store the cookies on the server so basically anyone could just sign in as me.</p>
<p>To fix this, I set up our own NGINX server and built the config with docker. We used Letsencrypt with the docker build so we can renew every so often and also use a cron job to automate this. Everything works perfect and users can login as their own account with Google OAuth.</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="overlay" id="modalOverlay" style="display: none;">
<div class="modal-content">
<p>Login or sign up disabled while the site is in read only mode</p>
<hr/>
<button class="btn btn-login">OK</button>
</div>
</div>
<script src="../../js/script.js"></script>
</body>
</html>