<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>ELK as Datasource Error - Support - Redash Discourse</title>
    <meta name="description" content="Hello ! 
I’m Trying add one ELK as a datasource 
The connection works good ! 
But When I try see the Schema show a error 
  
On the logs I’ve the error below 
[2022-01-12 21:15:46,654][PID:5162][WARNING][ForkPoolWorker-5&amp;hellip;">
    <meta name="generator" content="Discourse 3.2.0.beta2-dev - https://github.com/discourse/discourse version 83621ccbe797223b48b624b00ef04f24672e1f03">
<link rel="icon" type="image/png" href="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/1X/01e20869afc0877e3e5aee0f94419b9e9bffa961_2_32x32.ico">
<link rel="apple-touch-icon" type="image/png" href="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/1X/e1838a8a0c506503a22e0c60e2334374b2895c87_2_180x180.png">
<meta name="theme-color" media="all" content="#ffffff">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="https://discuss.redash.io/t/elk-as-datasource-error/9830" />

<link rel="search" type="application/opensearchdescription+xml" href="https://discuss.redash.io/opensearch.xml" title="Redash Discourse Search">

    <link href="https://sjc6.discourse-cdn.com/standard17/stylesheets/color_definitions_base__2_8fd59ae1f286f43b3ff17996df07ea951685249d.css?__ws=discuss.redash.io" media="all" rel="stylesheet" class="light-scheme"/>

  <link href="https://sjc6.discourse-cdn.com/standard17/stylesheets/desktop_d86c892d7cd5311243d31a8f11787f4b0342874d.css?__ws=discuss.redash.io" media="all" rel="stylesheet" data-target="desktop"  />



  <link href="https://sjc6.discourse-cdn.com/standard17/stylesheets/checklist_d86c892d7cd5311243d31a8f11787f4b0342874d.css?__ws=discuss.redash.io" media="all" rel="stylesheet" data-target="checklist"  />
  <link href="https://sjc6.discourse-cdn.com/standard17/stylesheets/discourse-adplugin_d86c892d7cd5311243d31a8f11787f4b0342874d.css?__ws=discuss.redash.io" media="all" rel="stylesheet" data-target="discourse-adplugin"  />
  <link href="https://sjc6.discourse-cdn.com/standard17/stylesheets/discourse-akismet_d86c892d7cd5311243d31a8f11787f4b0342874d.css?__ws=discuss.redash.io" media="all" rel="stylesheet" data-target="discourse-akismet"  />
  <link href="https://sjc6.discourse-cdn.com/standard17/stylesheets/discourse-cakeday_d86c892d7cd5311243d31a8f11787f4b0342874d.css?__ws=discuss.redash.io" media="all" rel="stylesheet" data-target="discourse-cakeday"  />
  <link href="https://sjc6.discourse-cdn.com/standard17/stylesheets/discourse-chat-integration_d86c892d7cd5311243d31a8f11787f4b0342874d.css?__ws=discuss.redash.io" media="all" rel="stylesheet" data-target="discourse-chat-integration"  />
  <link href="https://sjc6.discourse-cdn.com/standard17/stylesheets/discourse-details_d86c892d7cd5311243d31a8f11787f4b0342874d.css?__ws=discuss.redash.io" media="all" rel="stylesheet" data-target="discourse-details"  />
  <link href="https://sjc6.discourse-cdn.com/standard17/stylesheets/discourse-footnote_d86c892d7cd5311243d31a8f11787f4b0342874d.css?__ws=discuss.redash.io" media="all" rel="stylesheet" data-target="discourse-footnote"  />
  <link href="https://sjc6.discourse-cdn.com/standard17/stylesheets/discourse-lazy-videos_d86c892d7cd5311243d31a8f11787f4b0342874d.css?__ws=discuss.redash.io" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
  <link href="https://sjc6.discourse-cdn.com/standard17/stylesheets/discourse-local-dates_d86c892d7cd5311243d31a8f11787f4b0342874d.css?__ws=discuss.redash.io" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
  <link href="https://sjc6.discourse-cdn.com/standard17/stylesheets/discourse-narrative-bot_d86c892d7cd5311243d31a8f11787f4b0342874d.css?__ws=discuss.redash.io" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
  <link href="https://sjc6.discourse-cdn.com/standard17/stylesheets/discourse-presence_d86c892d7cd5311243d31a8f11787f4b0342874d.css?__ws=discuss.redash.io" media="all" rel="stylesheet" data-target="discourse-presence"  />
  <link href="https://sjc6.discourse-cdn.com/standard17/stylesheets/discourse-solved_d86c892d7cd5311243d31a8f11787f4b0342874d.css?__ws=discuss.redash.io" media="all" rel="stylesheet" data-target="discourse-solved"  />
  <link href="https://sjc6.discourse-cdn.com/standard17/stylesheets/discourse-spoiler-alert_d86c892d7cd5311243d31a8f11787f4b0342874d.css?__ws=discuss.redash.io" media="all" rel="stylesheet" data-target="discourse-spoiler-alert"  />
  <link href="https://sjc6.discourse-cdn.com/standard17/stylesheets/hosted-site_d86c892d7cd5311243d31a8f11787f4b0342874d.css?__ws=discuss.redash.io" media="all" rel="stylesheet" data-target="hosted-site"  />
  <link href="https://sjc6.discourse-cdn.com/standard17/stylesheets/poll_d86c892d7cd5311243d31a8f11787f4b0342874d.css?__ws=discuss.redash.io" media="all" rel="stylesheet" data-target="poll"  />
  <link href="https://sjc6.discourse-cdn.com/standard17/stylesheets/poll_desktop_d86c892d7cd5311243d31a8f11787f4b0342874d.css?__ws=discuss.redash.io" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="https://sjc6.discourse-cdn.com/standard17/stylesheets/desktop_theme_2_be4cb2b86ec06123c5e974acd20fd933d14b129d.css?__ws=discuss.redash.io" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2" data-theme-name="default"/>

    
    <meta id="data-ga-universal-analytics" data-tracking-code="UA-47088186-6" data-json="{&quot;cookieDomain&quot;:&quot;auto&quot;}" data-auto-link-domains="">

  <link rel="preload" href="https://global.discourse-cdn.com/standard17/assets/google-universal-analytics-v3-08add7ec997ab472fcd9f821d32ff7caf4b8b9a5de2ec18ca723a040be07a098.gz.js" as="script">
<script defer src="https://global.discourse-cdn.com/standard17/assets/google-universal-analytics-v3-08add7ec997ab472fcd9f821d32ff7caf4b8b9a5de2ec18ca723a040be07a098.gz.js"></script>


        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;ELK as Datasource Error&#39;" href="https://discuss.redash.io/t/elk-as-datasource-error/9830.rss" />
    <meta property="og:site_name" content="Redash Discourse" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/f/f82896fcdcf5be3503025c398898b1398cf273a4_2_1024x489.png" />
<meta property="og:image" content="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/f/f82896fcdcf5be3503025c398898b1398cf273a4_2_1024x489.png" />
<meta property="og:url" content="https://discuss.redash.io/t/elk-as-datasource-error/9830" />
<meta name="twitter:url" content="https://discuss.redash.io/t/elk-as-datasource-error/9830" />
<meta property="og:title" content="ELK as Datasource Error" />
<meta name="twitter:title" content="ELK as Datasource Error" />
<meta property="og:description" content="Hello !  I’m Trying add one ELK as a datasource  The connection works good !  But When I try see the Schema show a error     On the logs I’ve the error below  [2022-01-12 21:15:46,654][PID:5162][WARNING][ForkPoolWorker-56758] task_name=redash.tasks.refresh_schema task_id=3d1cb444-12aa-40d2-9c29-29ca957fe2cb Failed refreshing schema for the data source: Swapback  1/12/2022 6:15:46 PM Traceback (most recent call last):  1/12/2022 6:15:46 PM File &quot;/app/redash/tasks/queries.py&quot;, line 261, in refresh..." />
<meta name="twitter:description" content="Hello !  I’m Trying add one ELK as a datasource  The connection works good !  But When I try see the Schema show a error     On the logs I’ve the error below  [2022-01-12 21:15:46,654][PID:5162][WARNING][ForkPoolWorker-56758] task_name=redash.tasks.refresh_schema task_id=3d1cb444-12aa-40d2-9c29-29ca957fe2cb Failed refreshing schema for the data source: Swapback  1/12/2022 6:15:46 PM Traceback (most recent call last):  1/12/2022 6:15:46 PM File &quot;/app/redash/tasks/queries.py&quot;, line 261, in refresh..." />
<meta property="og:article:section" content="Support" />
<meta property="og:article:section:color" content="BF1E2E" />
<meta property="article:published_time" content="2022-01-12T21:33:42+00:00" />
<meta property="og:ignore_canonical" content="true" />


    <script type="application/ld+json">{"@context":"http://schema.org","@type":"QAPage","name":"ELK as Datasource Error","mainEntity":{"@type":"Question","name":"ELK as Datasource Error","text":"Hello !\n\nI’m Trying add one ELK as a datasource\n\nThe connection works good !\n\nBut When I try see the Schema show a error\n\n<a class=\"lightbox\" href=\"https://global.discourse-cdn.com/standard17/uploads/redash1/original/2X/f/f82896fcdcf5be3503025c398898b1398cf273a4.png\" data-download-href=\"/uploads/short-url/zpjniZoB9aqRU1Qs5hqq08Ky47i.png?dl=1\" title=\"image\" rel=\"noopener nofollow ugc\">[image]<\/a>\n\nOn the logs I’ve the error below\n\n[2022-01-12 21:15:46,654][PID:5162][WARNING][ForkPoolWorker-56758] task_name=redash.tasks.refresh_schema task_id=3d1cb444-12aa-40d2-9c&hellip;","upvoteCount":0,"answerCount":0,"dateCreated":"2022-01-12T21:33:42.084Z","author":{"@type":"Person","name":"Thiago Borges"}}}</script>
  </head>
  <body class="crawler ">
    
    <header>
  <a href="/">
    Redash Discourse
  </a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="/t/elk-as-datasource-error/9830">ELK as Datasource Error</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="https://discuss.redash.io/c/support/6" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #BF1E2E'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Support</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  

    <div itemscope itemtype='http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='ELK as Datasource Error'>
        <meta itemprop='articleSection' content='Support'>
      <meta itemprop='keywords' content=''>
      <div itemprop='publisher' itemscope itemtype="http://schema.org/Organization">
        <meta itemprop='name' content='Redash Discourse'>
          <div itemprop='logo' itemscope itemtype="http://schema.org/ImageObject">
            <meta itemprop='url' content='https://global.discourse-cdn.com/standard17/uploads/redash1/original/1X/c07bc573841e1e4a0013ea3b6fe088a1534228a3.png'>
          </div>
      </div>

          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://discuss.redash.io/u/thiborges'><span itemprop='name'>thiborges</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://discuss.redash.io/t/elk-as-datasource-error/9830">

                <link itemprop="image" href="https://global.discourse-cdn.com/standard17/uploads/redash1/original/2X/f/f82896fcdcf5be3503025c398898b1398cf273a4.png">

              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2022-01-12T21:33:42Z' class='post-time'>
                    January 12, 2022,  9:33pm
                  </time>
                  <meta itemprop='dateModified' content='2022-01-18T21:12:51Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='articleBody'>
              <p>Hello !</p>
<p>I’m Trying add one ELK as a datasource</p>
<p>The connection works good !</p>
<p>But When I try see the Schema show a error</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="https://global.discourse-cdn.com/standard17/uploads/redash1/original/2X/f/f82896fcdcf5be3503025c398898b1398cf273a4.png" data-download-href="/uploads/short-url/zpjniZoB9aqRU1Qs5hqq08Ky47i.png?dl=1" title="image" rel="noopener nofollow ugc"><img src="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/f/f82896fcdcf5be3503025c398898b1398cf273a4_2_690x330.png" alt="image" data-base62-sha1="zpjniZoB9aqRU1Qs5hqq08Ky47i" width="690" height="330" srcset="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/f/f82896fcdcf5be3503025c398898b1398cf273a4_2_690x330.png, https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/f/f82896fcdcf5be3503025c398898b1398cf273a4_2_1035x495.png 1.5x, https://global.discourse-cdn.com/standard17/uploads/redash1/original/2X/f/f82896fcdcf5be3503025c398898b1398cf273a4.png 2x" data-small-upload="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/f/f82896fcdcf5be3503025c398898b1398cf273a4_2_10x10.png"><div class="meta">
<svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">image</span><span class="informations">1365×653 19.8 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>On the logs I’ve the error below</p>
<pre><code class="lang-auto">[2022-01-12 21:15:46,654][PID:5162][WARNING][ForkPoolWorker-56758] task_name=redash.tasks.refresh_schema task_id=3d1cb444-12aa-40d2-9c29-29ca957fe2cb Failed refreshing schema for the data source: Swapback

1/12/2022 6:15:46 PM Traceback (most recent call last):

1/12/2022 6:15:46 PM File "/app/redash/tasks/queries.py", line 261, in refresh_schema

1/12/2022 6:15:46 PM ds.get_schema(refresh=True)

1/12/2022 6:15:46 PM File "/app/redash/models/__init__.py", line 155, in get_schema

1/12/2022 6:15:46 PM schema = sorted(query_runner.get_schema(get_stats=refresh), key=lambda t: t['name'])

1/12/2022 6:15:46 PM File "/app/redash/query_runner/__init__.py", line 142, in get_schema

1/12/2022 6:15:46 PM self._get_tables(schema_dict)


1/12/2022 6:15:46 PM File "/app/redash/query_runner/mssql.py", line 95, in _get_tables

1/12/2022 6:15:46 PM raise Exception("Failed getting schema.")

1/12/2022 6:15:46 PM Exception: Failed getting schema.

[2022-01-12 21:15:46,725][PID:5172][WARNING][ForkPoolWorker-56768] task_name=redash.tasks.refresh_schema task_id=f1a41e5e-d13f-46f3-8aae-5df50f599ab2 Failed refreshing schema for the data source: vpc

1/12/2022 6:15:46 PM Traceback (most recent call last):

1/12/2022 6:15:46 PM File "/app/redash/tasks/queries.py", line 261, in refresh_schema

1/12/2022 6:15:46 PM ds.get_schema(refresh=True)

1/12/2022 6:15:46 PM File "/app/redash/models/__init__.py", line 155, in get_schema

1/12/2022 6:15:46 PM schema = sorted(query_runner.get_schema(get_stats=refresh), key=lambda t: t['name'])

1/12/2022 6:15:46 PM File "/app/redash/query_runner/elasticsearch.py", line 173, in get_schema

1/12/2022 6:15:46 PM columns.extend(parse_doc(items))

1/12/2022 6:15:46 PM File "/app/redash/query_runner/elasticsearch.py", line 154, in parse_doc

1/12/2022 6:15:46 PM for field, description in doc['properties'].items():

1/12/2022 6:15:46 PM KeyError: 'properties'

Traceback (most recent call last):

1/12/2022 6:15:46 PM File "/app/redash/tasks/queries.py", line 261, in refresh_schema

1/12/2022 6:15:46 PM ds.get_schema(refresh=True)

1/12/2022 6:15:46 PM File "/app/redash/models/__init__.py", line 155, in get_schema

1/12/2022 6:15:46 PM schema = sorted(query_runner.get_schema(get_stats=refresh), key=lambda t: t['name'])

1/12/2022 6:15:46 PM File "/app/redash/query_runner/mongodb.py", line 217, in get_schema

1/12/2022 6:15:46 PM columns = self._get_collection_fields(db, collection_name)

1/12/2022 6:15:46 PM File "/app/redash/query_runner/mongodb.py", line 204, in _get_collection_fields

1/12/2022 6:15:46 PM for d in db[collection_name].find().sort([("$natural", -1)]).limit(1):

1/12/2022 6:15:46 PM File "/usr/local/lib/python2.7/site-packages/pymongo/cursor.py", line 1169, in next

1/12/2022 6:15:46 PM if len(self.__data) or self._refresh():

1/12/2022 6:15:46 PM File "/usr/local/lib/python2.7/site-packages/pymongo/cursor.py", line 1085, in _refresh

1/12/2022 6:15:46 PM self.__send_message(q)

1/12/2022 6:15:46 PM File "/usr/local/lib/python2.7/site-packages/pymongo/cursor.py", line 975, in __send_message

1/12/2022 6:15:46 PM helpers._check_command_response(first)

1/12/2022 6:15:46 PM File "/usr/local/lib/python2.7/site-packages/pymongo/helpers.py", line 145, in _check_command_response

1/12/2022 6:15:46 PM raise OperationFailure(msg % errmsg, code, response)

1/12/2022 6:15:46 PM OperationFailure: {$natural: -1} is not supported
</code></pre>
<p>Any ideas how to fix it ?</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://discuss.redash.io/u/jesse'><span itemprop='name'>jesse</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://discuss.redash.io/t/elk-as-datasource-error/9830">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2022-01-18T21:14:49Z' class='post-time'>
                    January 18, 2022,  9:14pm
                  </time>
                  <meta itemprop='dateModified' content='2022-01-18T21:14:49Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Hmmm I’m not familiar with the ELK query runner but this may be a version mismatch: i.e. Redash is expecting to query some version of ELK that’s different from yours. If this reproduces on V10 of Redash we can open an issue for it. It appears you’re running V8 which is no longer supported.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="1" />
              </div>

          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://discuss.redash.io/u/thiborges'><span itemprop='name'>thiborges</span></a>
                
              </span>

              <link itemprop="mainEntityOfPage" href="https://discuss.redash.io/t/elk-as-datasource-error/9830">


              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2022-02-03T22:03:40Z' class='post-time'>
                    February 3, 2022, 10:03pm
                  </time>
                  <meta itemprop='dateModified' content='2022-02-03T22:03:40Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Thanks Jesse…</p>
<p>I will try upgrade my version and test…</p>
<p>I let you know</p>
<p>Regards</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction"/>
                <meta itemprop="userInteractionCount" content="0" />
              </div>

          </div>
    </div>






    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='/' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='/categories' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='/guidelines' itemprop="url">FAQ/Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='http://redash.io/terms.html' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='http://redash.io/privacy.html' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    
  </body>
  
</html>
