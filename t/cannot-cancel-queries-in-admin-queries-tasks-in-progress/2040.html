<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet"/>
<link href="../../css/checklist_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/desktop_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/desktop_theme_2_be4cb2b86ec06123c5e974acd20fd933d14b129d.css" rel="stylesheet"/>
<link href="../../css/discourse-adplugin_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-akismet_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-cakeday_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-chat-integration_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-details_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-footnote_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-lazy-videos_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-local-dates_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/color_definitions_base__2_8fd59ae1f286f43b3ff17996df07ea951685249d.css" rel="stylesheet"/>
<link href="../../css/style.css" rel="stylesheet"/>
<title>Cannot cancel queries in admin/queries/tasks#in_progress</title></head>
<body>
<div class="navbar">
<div class="logo"><a href="../../page_0.html"><img alt="" src="../../images/logo_redash.png" srcset=""/></a></div>
<div class="navbar-buttons">
<button class="btn btn-signup">Sign Up</button>
<button class="btn btn-login"><i class="fas fa-user"></i> Login</button>
<button class="btn btn-search"><i class="fas fa-search"></i></button>
<div class="navbar-toggle">
<div class="dots"></div>
<div class="dots"></div>
<div class="dots"></div>
</div>
</div>
</div>
<div class="sidebar">
<div class="sidebar-content">
<div class="logo"><a href="../../page_0.html"><img alt="" src="../../images/logo_redash.png" srcset=""/></a></div>
<ul class="sidebar-grid">
<!-- <li><a href="#"><i class="fas fa-list-ul"></i> Topics</a></li> -->
<li><a href="../../page_0.html"><i class="fas fa-layer-group"></i> Topics</a></li>
<li><a href="../../users.html"><i class="fas fa-users"></i> Users</a></li>
<li><a href="../../about.html"><i class="fas fa-info-circle"></i> About</a></li>
<li><a href="../../faq.html"><i class="fas fa-question-circle"></i> FAQ</a></li>
<li><a href="../../groups.html"><i class="fas fa-users"></i> Groups</a></li>
<li><a href="../../badges.html"><i class="fas fa-certificate"></i> Badges</a></li>
</ul>
<h3 style="font-size: 13px;"><a href="#categories"><span>▼</span>Categories</a></h3>
<hr/>
<ul class="sidebar-grid categories">
<li>
<a class="badge-wrapper bullet" href="../../c/support/6.html">
<span class="badge-category-bg" style="background-color: #BF1E2E"></span>
<span class="badge-category clear-badge">
<span class="category-name">Support</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/feature-requests/5.html">
<span class="badge-category-bg" style="background-color: #3AB54A"></span>
<span class="badge-category clear-badge">
<span class="category-name">Feature Requests</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/uncategorized/1.html">
<span class="badge-category-bg" style="background-color: #AB9364"></span>
<span class="badge-category clear-badge">
<span class="category-name">Uncategorized</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/development/7.html">
<span class="badge-category-bg" style="background-color: #8C6238"></span>
<span class="badge-category clear-badge">
<span class="category-name">Development</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/tips-tricks-query-examples/11.html">
<span class="badge-category-bg" style="background-color: #652D90"></span>
<span class="badge-category clear-badge" style="white-space: normal;">
<span class="category-name">Tips, Tricks &amp; Query Examples</span>
</span>
</a>
</li>
<li><a href="../../categories.html"><i class="fas fa-list-ul"></i> All categories</a></li>
</ul>
<h3 style="font-size: 13px;"><a href="#tags"><span>▼</span>Tags</a></h3>
<hr/>
<ul class="sidebar-grid tags">
<li><a href="../../tag/query_results.html"><i class="fas fa-tag"></i> query_results</a></li>
<li><a href="../../tag/feature-request.html"><i class="fas fa-tag"></i> feature-request</a></li>
<li><a href="../../tag/parameters.html"><i class="fas fa-tag"></i> parameters</a></li>
<li><a href="../../tag/visualizations.html"><i class="fas fa-tag"></i> visualizations</a></li>
<li><a href="../../tag/alerts.html"><i class="fas fa-tag"></i> alerts</a></li>
<li><a href="../../tags.html"><i class="fas fa-list-ul"></i> All tags</a></li>
</ul>
</div>
<div class="sidebar-footer">
            © 2023 <a href="https://discuss.redash.io/" target="_blank">discuss.redash.io</a>
</div>
</div>
<div class="overlay"></div>
<div class="content">
<div class="global-notice">
<div class="row">
<div class="alert alert-info alert-read-only" id="global-notice-alert-read-only">
<span class="text">This site is in read only mode. Please continue to browse, but replying, likes,
                        and other actions are disabled for now.</span>
</div>
</div>
</div>
<div class="imported_page" id="imported_page">
<div class="wrap" id="main-outlet" role="main">
<div id="topic-title">
<h1>
<a href="/t/cannot-cancel-queries-in-admin-queries-tasks-in-progress/2040">Cannot cancel queries in admin/queries/tasks#in_progress</a>
</h1>
<div class="topic-category" itemscope="" itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
<a class="badge-wrapper bullet" href="../../c/support/6.html" itemprop="item">
<span class="badge-category-bg" style="background-color: #BF1E2E"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Support</span>
</span>
</a>
<meta content="1" itemprop="position"/>
</span>
</div>
</div>
<div itemscope="" itemtype="http://schema.org/DiscussionForumPosting">
<meta content="Cannot cancel queries in admin/queries/tasks#in_progress" itemprop="headline"/>
<meta content="Support" itemprop="articleSection"/>
<meta content="" itemprop="keywords"/>
<div itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
<meta content="Redash Discourse" itemprop="name"/>
<div itemprop="logo" itemscope="" itemtype="http://schema.org/ImageObject">
<meta content="https://global.discourse-cdn.com/standard17/uploads/redash1/original/1X/c07bc573841e1e4a0013ea3b6fe088a1534228a3.png" itemprop="url"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_1">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/shigemk2.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/shigemk2_avatar.png" tabindex="-1" width="48"/><span itemprop="name">shigemk2</span></a>
</span>
<link href="https://discuss.redash.io/t/cannot-cancel-queries-in-admin-queries-tasks-in-progress/2040" itemprop="mainEntityOfPage"/>
<link href="https://global.discourse-cdn.com/standard17/uploads/redash1/original/1X/2bc99a04c2af5d1d2ec37ae0c902f2cad34b5a83.png" itemprop="image"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2018-06-20T04:04:13Z" itemprop="datePublished">
                    June 20, 2018,  4:04am
                  </time>
<meta content="2018-06-20T04:04:13Z" itemprop="dateModified"/>
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p>I have a question. “in progress” queries sometimes remain after clicking Cancel button in admin page.<br/>
It is because “query_task_trackers:in_progress” in redis remain even if Celery tasks we canceled . I don’t know how to reproduce these data, but should I flushall redis data?</p>
<p><div class="lightbox-wrapper"><a class="lightbox" data-download-href="/uploads/short-url/6fmsz5nhUFyl06GMcA4VHcYLcX1.png?dl=1" href="https://global.discourse-cdn.com/standard17/uploads/redash1/original/1X/2bc99a04c2af5d1d2ec37ae0c902f2cad34b5a83.png" rel="noopener nofollow ugc" title="13"><img alt="13" data-base62-sha1="6fmsz5nhUFyl06GMcA4VHcYLcX1" data-small-upload="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/1X/2bc99a04c2af5d1d2ec37ae0c902f2cad34b5a83_2_10x10.png" height="205" src="assets/2bc99a04c2af5d1d2ec37ae0c902f2cad34b5a83_2_690x205.png" srcset="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/1X/2bc99a04c2af5d1d2ec37ae0c902f2cad34b5a83_2_690x205.png, https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/1X/2bc99a04c2af5d1d2ec37ae0c902f2cad34b5a83_2_1035x307.png 1.5x, https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/1X/2bc99a04c2af5d1d2ec37ae0c902f2cad34b5a83_2_1380x410.png 2x" width="690"/><div class="meta">
<svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use href="#far-image"></use></svg><span class="filename">13</span><span class="informations">2312×690 52.8 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_2" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/clayh.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/clayh_avatar.png" tabindex="-1" width="48"/><span itemprop="name">clayh</span></a>
</span>
<link href="https://discuss.redash.io/t/cannot-cancel-queries-in-admin-queries-tasks-in-progress/2040" itemprop="mainEntityOfPage"/>
<link href="https://global.discourse-cdn.com/standard17/uploads/redash1/original/1X/d089ea865baf7e4b4ded2cd18080fa1364ff49dc.png" itemprop="image"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2018-06-21T16:26:25Z" itemprop="datePublished">
                    June 21, 2018,  4:26pm
                  </time>
<meta content="2018-06-21T16:33:09Z" itemprop="dateModified"/>
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I’m having this exact problem, with two queries stuck in <code>executing query</code>. I cannot cancel them and I cannot run them again because the system evidently things they are running. How can I flush or cancel or otherwise remove them from the queue?</p>
<p><div class="lightbox-wrapper"><a class="lightbox" data-download-href="/uploads/short-url/tKONsB16pXrv004hRbkGvREhm1K.png?dl=1" href="https://global.discourse-cdn.com/standard17/uploads/redash1/original/1X/d089ea865baf7e4b4ded2cd18080fa1364ff49dc.png" rel="noopener nofollow ugc" title="26 PM"><img alt="26 PM" data-base62-sha1="tKONsB16pXrv004hRbkGvREhm1K" data-small-upload="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/1X/d089ea865baf7e4b4ded2cd18080fa1364ff49dc_2_10x10.png" height="110" src="assets/d089ea865baf7e4b4ded2cd18080fa1364ff49dc_2_690x110.png" srcset="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/1X/d089ea865baf7e4b4ded2cd18080fa1364ff49dc_2_690x110.png, https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/1X/d089ea865baf7e4b4ded2cd18080fa1364ff49dc_2_1035x165.png 1.5x, https://global.discourse-cdn.com/standard17/uploads/redash1/original/1X/d089ea865baf7e4b4ded2cd18080fa1364ff49dc.png 2x" width="690"/><div class="meta">
<svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use href="#far-image"></use></svg><span class="filename">26 PM</span><span class="informations">1178×189 17.7 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>It’s worth noting that this seems to be a similar problem:</p>
<aside class="quote quote-modified" data-post="1" data-topic="1843">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" loading="lazy" src="assets/246_2.png" width="20"/>
<a href="http://discuss.redash.io/t/queries-stuck-saving-results/1843">Queries stuck saving_results</a> <a class="badge-wrapper bullet" href="/c/support/support-self-hosted/9"><span class="badge-category-parent-bg" style="background-color: #BF1E2E;"></span><span class="badge-category-bg" style="background-color: #AB9364;"></span><span class="badge-category clear-badge" data-drop-close="true" style="" title="Support on installing, configuring and troubleshooting issues with self hosted Redash.">Self Hosted Redash Support</span></a>
</div>
<blockquote>
    We’ve been noticing recently that there are several queries that are stuck “saving results”. It seems it’s isolated to adhoc queries (unsaved) but I don’t have more evidence. 
Has anyone seen this before? I don’t see much documentation on the states of the query either. 
Redash v3.0.0+b3134 running on EC2, Each celery worker is limited to either 100MB or 1GB depending on queue but this happens on both. 
 <a class="lightbox" data-download-href="/uploads/short-url/pihZ0CezfWNtFQpIHF9goiv4Qqy.png?dl=1" href="https://global.discourse-cdn.com/standard17/uploads/redash1/original/1X/b147a1e6943a825a31f825fa97948aa9a1a01fce.png" rel="noopener nofollow ugc" title="image.png">[image]</a> 
Edit: More details 
It appears that UI shows all the results but these still show u…
  </blockquote>
</aside>
<p>and this:</p>
<aside class="quote" data-post="1" data-topic="1310">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" loading="lazy" src="https://avatars.discourse-cdn.com/v4/letter/m/5e9695/40.png" width="20"/>
<a href="http://discuss.redash.io/t/waiting-queue-always-having-some-queries/1310">Waiting queue always having some queries</a> <a class="badge-wrapper bullet" href="/c/support/6"><span class="badge-category-bg" style="background-color: #BF1E2E;"></span><span class="badge-category clear-badge" data-drop-close="true" style="" title="Support on installing, configuring and using Redash.">Support</span></a>
</div>
<blockquote>
    Hello, 
I can see 7 queries are always there in my waiting queue in redash. those are old queries but not getting out of queue. I tries to flush the queue as well but no success
  </blockquote>
</aside>
<hr/>
<p>Update:</p>
<p>After multiple tries of <code>redis-cli flushall</code> and rebooting the server, the queries finally cleared.</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_3" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/gdelcastillo.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/gdelcastillo_avatar.png" tabindex="-1" width="48"/><span itemprop="name">gdelcastillo</span></a>
</span>
<link href="https://discuss.redash.io/t/cannot-cancel-queries-in-admin-queries-tasks-in-progress/2040" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2019-03-07T14:07:19Z" itemprop="datePublished">
                    March 7, 2019,  2:07pm
                  </time>
<meta content="2019-03-07T14:07:19Z" itemprop="dateModified"/>
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I am repeatedly having the same issue. I wish the cancel button actually worked since the workaround (to flush redis and reboot server through the terminal) requires that either every data analyst has to ask for this to the systems engineer or every analyst is also a systems engineer.<br/>
Is there another way?</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_4" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/arikfr.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/arikfr_avatar.png" tabindex="-1" width="48"/><span itemprop="name">arikfr</span></a>
</span>
<link href="https://discuss.redash.io/t/cannot-cancel-queries-in-admin-queries-tasks-in-progress/2040" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2019-03-07T14:51:49Z" itemprop="datePublished">
                    March 7, 2019,  2:51pm
                  </time>
<meta content="2019-03-07T14:51:49Z" itemprop="dateModified"/>
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>The current <code>Queries Queue</code> tab has issues where “phantom” tasks might get stuck there and you won’t be able to ever remove or cancel them.</p>
<p>For this reason the following change was introduced:</p>
<aside class="onebox githubpullrequest">
<header class="source">
<a href="https://github.com/getredash/redash/pull/3057" rel="nofollow noopener" target="_blank">github.com/getredash/redash</a>
</header>
<article class="onebox-body">
<a href="https://github.com/arikfr" rel="nofollow noopener" target="_blank">
<img alt="arikfr" class="thumbnail onebox-avatar" height="90" src="assets/71468" width="90"/>
</a>
<h4>
<a href="https://github.com/getredash/redash/pull/3057" rel="nofollow noopener" target="_blank">New Celery/Queries Execution Status API</a>
</h4>
<div class="date">
  by <a href="https://github.com/arikfr" rel="nofollow noopener" target="_blank">arikfr</a>
  on <a href="https://github.com/getredash/redash/pull/3057" rel="nofollow noopener" target="_blank">02:54PM - 08 Nov 18 UTC</a>
</div>
<div class="github-commit-stats">
<strong>28 commits</strong>
  changed <strong>13 files</strong>
  with <strong>404 additions</strong>
  and <strong>341 deletions</strong>.
</div>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
<p>It should be more reliable as it reads Celery’s state directly.</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="overlay" id="modalOverlay" style="display: none;">
<div class="modal-content">
<p>Login or sign up disabled while the site is in read only mode</p>
<hr/>
<button class="btn btn-login">OK</button>
</div>
</div>
<script src="../../js/script.js"></script>
</body>
</html>