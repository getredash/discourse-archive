<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet"/>
<link href="../../css/checklist_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/desktop_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/desktop_theme_2_be4cb2b86ec06123c5e974acd20fd933d14b129d.css" rel="stylesheet"/>
<link href="../../css/discourse-adplugin_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-akismet_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-cakeday_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-chat-integration_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-details_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-footnote_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-lazy-videos_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-local-dates_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/color_definitions_base__2_8fd59ae1f286f43b3ff17996df07ea951685249d.css" rel="stylesheet"/>
<link href="../../css/style.css" rel="stylesheet"/>
<title>Install and Run Redash on Apple M1 Pro Chip</title></head>
<body>
<div class="navbar">
<div class="logo"><a href="../../page_0.html"><img alt="" src="../../images/logo_redash.png" srcset=""/></a></div>
<div class="navbar-buttons">
<button class="btn btn-signup">Sign Up</button>
<button class="btn btn-login"><i class="fas fa-user"></i> Login</button>
<button class="btn btn-search"><i class="fas fa-search"></i></button>
<div class="navbar-toggle">
<div class="dots"></div>
<div class="dots"></div>
<div class="dots"></div>
</div>
</div>
</div>
<div class="sidebar">
<div class="sidebar-content">
<div class="logo"><a href="../../page_0.html"><img alt="" src="../../images/logo_redash.png" srcset=""/></a></div>
<ul class="sidebar-grid">
<!-- <li><a href="#"><i class="fas fa-list-ul"></i> Topics</a></li> -->
<li><a href="../../page_0.html"><i class="fas fa-layer-group"></i> Topics</a></li>
<li><a href="../../users.html"><i class="fas fa-users"></i> Users</a></li>
<li><a href="../../about.html"><i class="fas fa-info-circle"></i> About</a></li>
<li><a href="../../faq.html"><i class="fas fa-question-circle"></i> FAQ</a></li>
<li><a href="../../groups.html"><i class="fas fa-users"></i> Groups</a></li>
<li><a href="../../badges.html"><i class="fas fa-certificate"></i> Badges</a></li>
</ul>
<h3 style="font-size: 13px;"><a href="#categories"><span>▼</span>Categories</a></h3>
<hr/>
<ul class="sidebar-grid categories">
<li>
<a class="badge-wrapper bullet" href="../../c/support/6.html">
<span class="badge-category-bg" style="background-color: #BF1E2E"></span>
<span class="badge-category clear-badge">
<span class="category-name">Support</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/feature-requests/5.html">
<span class="badge-category-bg" style="background-color: #3AB54A"></span>
<span class="badge-category clear-badge">
<span class="category-name">Feature Requests</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/uncategorized/1.html">
<span class="badge-category-bg" style="background-color: #AB9364"></span>
<span class="badge-category clear-badge">
<span class="category-name">Uncategorized</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/development/7.html">
<span class="badge-category-bg" style="background-color: #8C6238"></span>
<span class="badge-category clear-badge">
<span class="category-name">Development</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/tips-tricks-query-examples/11.html">
<span class="badge-category-bg" style="background-color: #652D90"></span>
<span class="badge-category clear-badge" style="white-space: normal;">
<span class="category-name">Tips, Tricks &amp; Query Examples</span>
</span>
</a>
</li>
<li><a href="../../categories.html"><i class="fas fa-list-ul"></i> All categories</a></li>
</ul>
<h3 style="font-size: 13px;"><a href="#tags"><span>▼</span>Tags</a></h3>
<hr/>
<ul class="sidebar-grid tags">
<li><a href="../../tag/query_results.html"><i class="fas fa-tag"></i> query_results</a></li>
<li><a href="../../tag/feature-request.html"><i class="fas fa-tag"></i> feature-request</a></li>
<li><a href="../../tag/parameters.html"><i class="fas fa-tag"></i> parameters</a></li>
<li><a href="../../tag/visualizations.html"><i class="fas fa-tag"></i> visualizations</a></li>
<li><a href="../../tag/alerts.html"><i class="fas fa-tag"></i> alerts</a></li>
<li><a href="../../tags.html"><i class="fas fa-list-ul"></i> All tags</a></li>
</ul>
</div>
<div class="sidebar-footer">
            © 2023 <a href="https://discuss.redash.io/" target="_blank">discuss.redash.io</a>
</div>
</div>
<div class="overlay"></div>
<div class="content">
<div class="global-notice">
<div class="row">
<div class="alert alert-info alert-read-only" id="global-notice-alert-read-only">
<span class="text">This site is in read only mode. Please continue to browse, but replying, likes,
                        and other actions are disabled for now.</span>
</div>
</div>
</div>
<div class="imported_page" id="imported_page">
<div class="wrap" id="main-outlet" role="main">
<div id="topic-title">
<h1>
<a href="/t/install-and-run-redash-on-apple-m1-pro-chip/10621">Install and Run Redash on Apple M1 Pro Chip</a>
</h1>
<div class="topic-category" itemscope="" itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
<a class="badge-wrapper bullet" href="../../c/support/6.html" itemprop="item">
<span class="badge-category-bg" style="background-color: #BF1E2E"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Support</span>
</span>
</a>
<meta content="1" itemprop="position"/>
</span>
<span itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
<a class="badge-wrapper bullet" href="../../c/support/support-self-hosted/9.html" itemprop="item">
<span class="badge-category-bg" style="background-color: #AB9364"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Self Hosted Redash Support</span>
</span>
</a>
<meta content="2" itemprop="position"/>
</span>
</div>
</div>
<div itemscope="" itemtype="http://schema.org/DiscussionForumPosting">
<meta content="Install and Run Redash on Apple M1 Pro Chip" itemprop="headline"/>
<meta content="Self Hosted Redash Support" itemprop="articleSection"/>
<meta content="" itemprop="keywords"/>
<div itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
<meta content="Redash Discourse" itemprop="name"/>
<div itemprop="logo" itemscope="" itemtype="http://schema.org/ImageObject">
<meta content="https://global.discourse-cdn.com/standard17/uploads/redash1/original/1X/c07bc573841e1e4a0013ea3b6fe088a1534228a3.png" itemprop="url"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_1">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/SteveJ.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/SteveJ_avatar.png" tabindex="-1" width="48"/><span itemprop="name">SteveJ</span></a>
</span>
<link href="assets/10621" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2022-06-14T06:46:55Z" itemprop="datePublished">
                    June 14, 2022,  6:46am
                  </time>
<meta content="2022-06-14T06:46:55Z" itemprop="dateModified"/>
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<h3>
<a class="anchor" href="#issue-summary-1" name="issue-summary-1"></a>Issue Summary</h3>
<p>Hi Redash community,</p>
<p>I was trying to install and run Redash using docker on my macbook with M1 Pro chip. I have ran into a number of errors when I followed the <a href="https://redash.io/help/open-source/dev-guide/docker" rel="noopener nofollow ugc">Docker Based Developer Installation Guide</a>.</p>
<p>The first few errors happened during docker-compose when installing python packages. I managed to bypass those errors by adding pre steps in dockerfile and commenting a few packages in requirements_all_ds.txt file. They are:</p>
<ul>
<li>add one step before install python packages in dockerfile:<br/>
<code>RUN pip install Cython;</code><br/>
this is because pymssql will need Cython as a dependency, and it somehow has to be installed first.</li>
<li>comment <code>pymapd</code> and <code>ibm-db</code> as pyarrow and another dependency won’t work with M1 Chip</li>
</ul>
<p>After fixing those errors, the containers were up and running, and <code>localhost:5000/ping</code> returns <code>pong</code>.</p>
<p>However I was later stuck at installing dependency for the front-end. I followed the instruction <code> yarn --frozen-lockfile</code>. It returned errors of<br/>
<code>error An unexpected error occurred: "https://registry.yarnpkg.com/domhandler/-/domhandler-2.4.2.tgz: read ECONNRESET".</code><br/>
and finally stopped at the stage of fetching packages. I managed to find another post in this forum talking about <a href="http://discuss.redash.io/t/error-unable-to-run-docker-compose-on-apple-m1-silicon/7990">M1 chip issue</a> and replaced the command with <code>npm install &amp;&amp; npm run build</code>. Unfortunately, it returned the same error - <code>error code EINTEGRITY</code>.</p>
<p>As I don’t have much experience with frontend development and really desperate to find a solution to those errors, I just wonder if someone here has met the same problems and can shed a bit of light on this?</p>
<p>By the way, I tried another mac with Intel chip and under the same network, it works well with all those steps in the installation guide. So it can’t be the network issue.</p>
<p>The below are full logs for <code>yarn --frozen--lockfile</code> command</p>
<pre><code class="lang-auto">[14/06/22 4:07:44] (base)  ✘ jize@G536RR24R3  ~/Documents/GitHub/redash   master ±  yarn --frozen-lockfile
yarn install v1.22.19
$ cd viz-lib &amp;&amp; yarn link --link-folder ../.yarn
yarn link v1.22.19
warning There's already a package called "@redash/viz" registered. This command has had no effect. If this command was run in another folder with the same name, the other folder is still linked. Please run yarn unlink in the other folder if you want to register this folder.
✨  Done in 0.03s.
[1/5] 🔍  Validating package.json...
[2/5] 🔍  Resolving packages...
[3/5] 🚚  Fetching packages...
info There appears to be trouble with your network connection. Retrying...
info No lockfile found.
warning package-lock.json found. Your project contains lock files generated by tools other than Yarn. It is advised not to mix package managers in order to avoid resolution inconsistencies caused by unsynchronized lock files. To clear this warning, remove package-lock.json.
[1/4] 🔍  Resolving packages...
info There appears to be trouble with your network connection. Retrying...
info There appears to be trouble with your network connection. Retrying...
warning babel-cli &gt; chokidar@1.7.0: Chokidar 2 will break on node v14+. Upgrade to chokidar 3 with 15x less dependencies.
warning babel-cli &gt; babel-register &gt; core-js@2.6.12: core-js@&lt;3.4 is no longer maintained and not recommended for usage due to the number of issues. Because of the V8 engine whims, feature detection in old core-js versions could cause a slowdown up to 100x even if nothing is polyfilled. Please, upgrade your dependencies to the actual version of core-js.
warning babel-cli &gt; babel-polyfill &gt; core-js@2.6.12: core-js@&lt;3.4 is no longer maintained and not recommended for usage due to the number of issues. Because of the V8 engine whims, feature detection in old core-js versions could cause a slowdown up to 100x even if nothing is polyfilled. Please, upgrade your dependencies to the actual version of core-js.
warning babel-cli &gt; babel-runtime &gt; core-js@2.6.12: core-js@&lt;3.4 is no longer maintained and not recommended for usage due to the number of issues. Because of the V8 engine whims, feature detection in old core-js versions could cause a slowdown up to 100x even if nothing is polyfilled. Please, upgrade your dependencies to the actual version of core-js.
warning babel-cli &gt; chokidar &gt; fsevents@1.2.13: fsevents 1 will break on node v14+ and could be using insecure binaries. Upgrade to fsevents 2.
info There appears to be trouble with your network connection. Retrying...
warning babel-cli &gt; chokidar &gt; readdirp &gt; micromatch &gt; snapdragon &gt; source-map-resolve@0.5.3: See https://github.com/lydell/source-map-resolve#deprecated
info There appears to be trouble with your network connection. Retrying...
warning babel-cli &gt; chokidar &gt; readdirp &gt; micromatch &gt; snapdragon &gt; source-map-resolve &gt; resolve-url@0.2.1: https://github.com/lydell/resolve-url#deprecated
warning babel-cli &gt; chokidar &gt; readdirp &gt; micromatch &gt; snapdragon &gt; source-map-resolve &gt; urix@0.1.0: Please see https://github.com/lydell/urix#deprecated
warning babel-cli &gt; chokidar &gt; readdirp &gt; micromatch &gt; snapdragon &gt; source-map-resolve &gt; source-map-url@0.4.1: See https://github.com/lydell/source-map-url#deprecated
warning babel-eslint@7.2.3: babel-eslint is now @babel/eslint-parser. This package will no longer receive updates.
info There appears to be trouble with your network connection. Retrying...
info There appears to be trouble with your network connection. Retrying...
info There appears to be trouble with your network connection. Retrying...
error An unexpected error occurred: "https://registry.yarnpkg.com/domhandler/-/domhandler-2.4.2.tgz: read ECONNRESET".
info If you think this is a bug, please open a bug report with the information provided in "/Users/jize/Documents/GitHub/redash/yarn-error.log".
info Visit https://yarnpkg.com/en/docs/cli/install for documentation about this command.
info There appears to be trouble with your network connection. Retrying...
info There appears to be trouble with your network connection. Retrying...
warning babel-preset-es2015@6.24.1: 🙌  Thanks for using Babel: we recommend using babel-preset-env now: please read https://babeljs.io/env to update!
info There appears to be trouble with your network connection. Retrying...
warning eslint &gt; file-entry-cache &gt; flat-cache &gt; circular-json@0.3.3: CircularJSON is in maintenance only, flatted is its successor.
info There appears to be trouble with your network connection. Retrying...
warning jest &gt; jest-cli &gt; sane@1.4.1: some dependency vulnerabilities fixed, support for node &lt; 10 dropped, and newer ECMAScript syntax/features added
warning jest &gt; jest-cli &gt; jest-haste-map &gt; sane@1.4.1: some dependency vulnerabilities fixed, support for node &lt; 10 dropped, and newer ECMAScript syntax/features added
warning jest &gt; jest-cli &gt; jest-config &gt; istanbul@0.4.5: This module is no longer maintained, try this instead:
  npm i nyc
Visit https://istanbul.js.org/integrations for other alternatives.
warning jest &gt; jest-cli &gt; jest-environment-jsdom &gt; jsdom &gt; request@2.88.2: request has been deprecated, see https://github.com/request/request/issues/3142
info There appears to be trouble with your network connection. Retrying...
warning jest &gt; jest-cli &gt; jest-environment-jsdom &gt; jsdom &gt; request &gt; har-validator@5.1.5: this library is no longer supported
warning jest &gt; jest-cli &gt; jest-environment-jsdom &gt; jsdom &gt; request &gt; uuid@3.4.0: Please upgrade  to version 7 or higher.  Older versions may use Math.random() in certain circumstances, which is known to be problematic.  See https://v8.dev/blog/math-random for details.
info There appears to be trouble with your network connection. Retrying...
warning webpack &gt; watchpack &gt; chokidar@1.7.0: Chokidar 2 will break on node v14+. Upgrade to chokidar 3 with 15x less dependencies.
warning webpack &gt; node-libs-browser &gt; url &gt; querystring@0.2.0: The querystring API is considered Legacy. new code should use the URLSearchParams API instead.
[2/4] 🚚  Fetching packages...
info There appears to be trouble with your network connection. Retrying...
info There appears to be trouble with your network connection. Retrying...
info There appears to be trouble with your network connection. Retrying...
</code></pre>
<h3>
<a class="anchor" href="#technical-details-2" name="technical-details-2"></a>Technical details:</h3>
<ul>
<li>Redash Version: v10.1.0</li>
<li>Browser/OS: macOS Monterey 12.4, MacBook Pro with Apple M1 Pro</li>
<li>How did you install Redash: Following Docker Based developer installation guide.</li>
</ul>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_2" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/codeofyu.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/codeofyu_avatar.png" tabindex="-1" width="48"/><span itemprop="name">codeofyu</span></a>
</span>
<link href="assets/10621" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2022-06-14T14:22:00Z" itemprop="datePublished">
                    June 14, 2022,  2:22pm
                  </time>
<meta content="2022-06-14T14:22:00Z" itemprop="dateModified"/>
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Hey, I also encountered this song problem can not be solved!!!</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_4" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/jesse.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/jesse_avatar.png" tabindex="-1" width="48"/><span itemprop="name">jesse</span></a>
</span>
<link href="assets/10621" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2022-06-14T17:14:14Z" itemprop="datePublished">
                    June 14, 2022,  5:14pm
                  </time>
<meta content="2022-06-14T17:14:14Z" itemprop="dateModified"/>
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Related context: <a class="inline-onebox" href="http://discuss.redash.io/t/error-unable-to-run-docker-compose-on-apple-m1-silicon/7990/16">Error: Unable to run docker-compose on Apple M1 Silicon - #16 by ajgreen</a></p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_5" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/SteveJ.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/SteveJ_avatar.png" tabindex="-1" width="48"/><span itemprop="name">SteveJ</span></a>
</span>
<link href="assets/10621" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2022-06-14T23:48:47Z" itemprop="datePublished">
                    June 14, 2022, 11:48pm
                  </time>
<meta content="2022-06-14T23:48:47Z" itemprop="dateModified"/>
<span itemprop="position">5</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Hi <a class="mention" href="/u/jesse">@jesse</a> ,</p>
<p>thanks for your reply. I checked that page before I made new post. It was one error I met before. I solved it by pointing node version to 14 in homebrew and after that, node and yarn commands can be triggered.<br/>
My error is when installing dependencies for the frontend, some packages look like not compatible with M1 chip. I’m not a front end developer, so it’s just my gut feeling. The error message was <code>error An unexpected error occurred: "https://registry.yarnpkg.com/domhandler/-/domhandler-2.4.2.tgz: read ECONNRESET".</code>. Would you mind shedding some lights on?</p>
<p>Thanks,<br/>
Steve</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_6" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/jesse.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/jesse_avatar.png" tabindex="-1" width="48"/><span itemprop="name">jesse</span></a>
</span>
<link href="assets/10621" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2022-06-21T16:40:13Z" itemprop="datePublished">
                    June 21, 2022,  4:40pm
                  </time>
<meta content="2022-06-21T16:40:13Z" itemprop="dateModified"/>
<span itemprop="position">6</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Hmmm, I’ll give this a try on an M1 system when I have a moment.</p>
<aside class="quote no-group" data-post="5" data-topic="10621" data-username="SteveJ">
<div class="title">
<div class="quote-controls"></div>
<img alt="" class="avatar" height="20" loading="lazy" src="https://avatars.discourse-cdn.com/v4/letter/s/ce7236/40.png" width="20"/> SteveJ:</div>
<blockquote>
<p>some packages look like not compatible with M1 chip</p>
</blockquote>
</aside>
<p>This shouldn’t be a problem given that M1 supports Rosetta 2.0, no?</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_7" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/SteveJ.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/SteveJ_avatar.png" tabindex="-1" width="48"/><span itemprop="name">SteveJ</span></a>
</span>
<link href="assets/10621" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2022-06-28T12:25:12Z" itemprop="datePublished">
                    June 28, 2022, 12:25pm
                  </time>
<meta content="2022-06-28T12:25:12Z" itemprop="dateModified"/>
<span itemprop="position">7</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Hi <a class="mention" href="/u/jesse">@jesse</a> ,</p>
<p>Thanks for your reply. yes, it supports Rosetta. I haven’t touched that bit for now. Will explore it and post if I have any updates.</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_8" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/jesse.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/jesse_avatar.png" tabindex="-1" width="48"/><span itemprop="name">jesse</span></a>
</span>
<link href="assets/10621" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2022-07-02T16:24:00Z" itemprop="datePublished">
                    July 2, 2022,  4:24pm
                  </time>
<meta content="2022-07-03T03:07:07Z" itemprop="dateModified"/>
<span itemprop="position">8</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I have a working version of Redash v11-dev on my M1 machine now.</p>
<p><strong>Hardware</strong>: M1 Max Macbook Pro (2021)<br/>
<strong>OS</strong>: MacOS Monterey 12.4<br/>
<strong>CPU</strong>: M1 Max</p>
<h3>
<a class="anchor" href="#backend-docker-1" name="backend-docker-1"></a>Backend (Docker)</h3>
<p>I too had to follow <a class="mention" href="/u/stevej">@SteveJ</a> 's guidance to:</p>
<ol>
<li>Add RUN pip install Cython to my Dockerfile</li>
<li>Comment out <code>requirements_all_ds.txt</code> dependencies that won’t build on M1</li>
</ol>
<p>I actually just built my containers with <code>skip_ds_deps</code> enabled, since I didn’t need them for testing. Just run <code>docker-compose build --build-arg skip_ds_deps=1</code> before you run <code>docker-compose up -d</code>.</p>
<p>Also, MacOS Monterey uses port 5000 for system services (Airplay discovery, I think). So I modified the EXPOSE command in my Dockerfile to use port 5001 instead.</p>
<h3>
<a class="anchor" href="#frontend-yarn-2" name="frontend-yarn-2"></a>Frontend (yarn)</h3>
<p>I had a few hiccups:</p>
<ol>
<li>I needed to install node 14.18.2 with <code>nvm</code> because my version of node was set to 17.x.x… Before I did this, there were all manner of strange errors around incompatibility.</li>
<li>I modified my <code>webpack.config.js</code> to set <code>redashBackend</code> to port 5001</li>
</ol>
<h3>
<a class="anchor" href="#complete-patch-3" name="complete-patch-3"></a>Complete patch:</h3>
<p>You can use this patch to make my changes on your local version.</p>
<pre><code class="lang-auto">From ce29bb8fa9291c690965359feb99272e4477a301 Mon Sep 17 00:00:00 2001
From: Jesse Whitehouse &lt;jesse@whitehouse.dev&gt;
Date: Sat, 2 Jul 2022 11:16:08 -0500
Subject: [PATCH] Make compatible with M1 Macs

---
 Dockerfile         | 1 +
 docker-compose.yml | 2 +-
 webpack.config.js  | 2 +-
 3 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/Dockerfile b/Dockerfile
index 68f3cf974..272d6cb9e 100644
--- a/Dockerfile
+++ b/Dockerfile
@@ -88,6 +88,7 @@ ENV PIP_NO_CACHE_DIR=1
 
 # rollback pip version to avoid legacy resolver problem
 RUN pip install pip==20.2.4;
+RUN python3.7 -m pip install cython
 
 # We first copy only the requirements file, to avoid rebuilding on every file change.
 COPY requirements_all_ds.txt ./
diff --git a/docker-compose.yml b/docker-compose.yml
index fdfcdd1a5..1a63eb14b 100644
--- a/docker-compose.yml
+++ b/docker-compose.yml
@@ -27,7 +27,7 @@ services:
       - postgres
       - redis
     ports:
-      - "5000:5000"
+      - "5001:5000"
       - "5678:5678"
     environment:
       &lt;&lt;: *redash-environment
diff --git a/webpack.config.js b/webpack.config.js
index 76465291d..5aa2a49af 100644
--- a/webpack.config.js
+++ b/webpack.config.js
@@ -34,7 +34,7 @@ const isDevelopment = !isProduction;
 const isHotReloadingEnabled =
   isDevelopment &amp;&amp; process.env.HOT_RELOAD === "true";
 
-const redashBackend = process.env.REDASH_BACKEND || "http://localhost:5000";
+const redashBackend = process.env.REDASH_BACKEND || "http://localhost:5001";
 const baseHref = CONFIG.baseHref || "/";
 const staticPath = CONFIG.staticPath || "/static/";
 const htmlTitle = CONFIG.title || "Redash";
-- 
2.32.1 (Apple Git-133)

</code></pre>
<p>[edit] On my personal fork I have a <code>dev</code> branch that applies these changes. The README includes basic setup steps: <a class="inline-onebox" href="https://github.com/susodapop/redash">GitHub - susodapop/redash: Make Your Company Data Driven. Connect to any data source, easily visualize, dashboard and share your data.</a></p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_9" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/jesse.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/jesse_avatar.png" tabindex="-1" width="48"/><span itemprop="name">jesse</span></a>
</span>
<link href="assets/10621" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2022-07-05T20:58:10Z" itemprop="datePublished">
                    July 5, 2022,  8:58pm
                  </time>
<meta content="2022-07-05T20:58:10Z" itemprop="dateModified"/>
<span itemprop="position">9</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Following up, I think <code>pyarrow</code> will work on M1 if we make <a href="https://stackoverflow.com/questions/70616475/how-to-install-pyarrow-on-m1-mac-monterey">a few changes</a>. The problem is there aren’t wheels for pyarrow that support the M1 architecture, so pip tries to build one.</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_10" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/jesse.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/jesse_avatar.png" tabindex="-1" width="48"/><span itemprop="name">jesse</span></a>
</span>
<link href="assets/10621" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2022-07-09T02:09:26Z" itemprop="datePublished">
                    July 9, 2022,  2:09am
                  </time>
<meta content="2022-07-09T02:09:26Z" itemprop="dateModified"/>
<span itemprop="position">10</span>
</span>
</div>
<div class="post" itemprop="text">
<p>I’ve opened a PR with a potential fix for this: install <code>requirements_all_ds.txt</code> line-by-line so that the build will succeed even when some of the data source requirements cannot be installed.</p>
<aside class="onebox githubpullrequest" data-onebox-src="https://github.com/getredash/redash/pull/5788">
<header class="source">
<a href="https://github.com/getredash/redash/pull/5788" rel="noopener" target="_blank">github.com/getredash/redash</a>
</header>
<article class="onebox-body">
<div class="github-row">
<div class="github-icon-container" title="Pull Request">
<svg aria-hidden="true" class="github-icon" height="60" viewbox="0 0 12 16" width="60"><path d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
</div>
<div class="github-info-container">
<h4>
<a href="https://github.com/getredash/redash/pull/5788" rel="noopener" target="_blank">Install python dependencies one-by-one. Don't exit on failures.</a>
</h4>
<div class="branches">
<code>getredash:master</code> ← <code>getredash:fix-m1-build</code>
</div>
<div class="github-info">
<div class="date">
        opened <span class="discourse-local-date" data-date="2022-07-09" data-format="ll" data-time="02:08:35" data-timezone="UTC">02:08AM - 09 Jul 22 UTC</span>
</div>
<div class="user">
<a href="https://github.com/susodapop" rel="noopener" target="_blank">
<img alt="susodapop" class="onebox-avatar-inline" height="20" src="assets/17067911" width="20"/>
          susodapop
        </a>
</div>
<div class="lines" title="1 commits changed 1 files with 2 additions and 1 deletions">
<a href="https://github.com/getredash/redash/pull/5788/files" rel="noopener" target="_blank">
<span class="added">+2</span>
<span class="removed">-1</span>
</a>
</div>
</div>
</div>
</div>
<div class="github-row">
<p class="github-body-container">## What type of PR is this? 


- [x] Refactor


## Description


`docke<span class="show-more-container"><a class="show-more" href="https://github.com/getredash/redash/pull/5788" rel="noopener" target="_blank">…</a></span><span class="excerpt hidden">r-compose build` fails while installing `requirements_all_ds.txt` on Apple Silicon because some data source dependencies are pinned to versions incompatible with the ARM architecture. This blocks users from running / developing Redash on our fancy new Macs unless we selectively remove the incompatible lines of `requirements_all_ds.txt` (`pymapd` for example).

Long-term we should ensure that all dependencies are compatible across platforms. This PR implements an effective, hands-free solution until then.

#### Benefits

This change allows the build to continue even if a data source dependency cannot be installed. It works by using `xargs` to feed `requirements_all_ds.txt` to `pip install` line-by-line. The final command `|| true` suppresses the exit code from `xargs` (which will be code `123` if any of the calls to `pip install` returns a non-zero code) so that Docker will continue building.

Since query_runners wrap their imports in `try...` blocks, any query runner that depends on a package that wasn't installed will fail gracefully without crashing the app.

#### Risks

Calling `pip install` line-by-line slows down `docker-compose build`.

Because we catch all non-zero exit codes, a user will need to run `docker-compose build --progress=plain` to see whether or not all dependencies were installed.


## How is this tested?

- [ ] Unit tests (pytest, jest)
- [ ] E2E Tests (Cypress)
- [x] Manually
- [ ] N/A



## Related Tickets &amp; Documents


## Mobile &amp; Desktop Screenshots/Recordings (if there are UI changes)

N/A</span></p>
</div>
</article>
<div class="onebox-metadata">
</div>
<div style="clear: both"></div>
</aside>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_12" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/jesse.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/jesse_avatar.png" tabindex="-1" width="48"/><span itemprop="name">jesse</span></a>
</span>
<link href="assets/10621" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2022-07-13T01:58:46Z" itemprop="datePublished">
                    July 13, 2022,  1:58am
                  </time>
<meta content="2022-07-13T01:58:46Z" itemprop="dateModified"/>
<span itemprop="position">12</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Redash is a community driven project. The discussion and pull request in this thread exist to move us towards full Apple Silicon compatibility. But it happens at the rate of volunteers <img alt=":slight_smile:" class="emoji" height="20" loading="lazy" src="assets/slight_smile.png" title=":slight_smile:" width="20"/></p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_13" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/jesse.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/jesse_avatar.png" tabindex="-1" width="48"/><span itemprop="name">jesse</span></a>
</span>
<link href="assets/10621" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2022-07-13T02:02:33Z" itemprop="datePublished">
                    July 13, 2022,  2:02am
                  </time>
<meta content="2022-07-13T02:02:33Z" itemprop="dateModified"/>
<span itemprop="position">13</span>
</span>
</div>
<div class="post" itemprop="text">
<p>As a follow-up, it’s unlikely that we’ll build images for Apple M1 specifically since it’s unlikely for Redash to be <em>deployed</em> on these platforms. The purpose of this discussion is for development / demonstration instances of Redash. In a production environment we want to support <code>arm64</code> platforms, but probably not M1 specifically – unless Apple return to the enterprise server market <img alt=":sweat_smile:" class="emoji" height="20" loading="lazy" src="assets/sweat_smile.png" title=":sweat_smile:" width="20"/></p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="overlay" id="modalOverlay" style="display: none;">
<div class="modal-content">
<p>Login or sign up disabled while the site is in read only mode</p>
<hr/>
<button class="btn btn-login">OK</button>
</div>
</div>
<script src="../../js/script.js"></script>
</body>
</html>