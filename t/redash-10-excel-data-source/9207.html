<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet"/>
<link href="../../css/checklist_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/desktop_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/desktop_theme_2_be4cb2b86ec06123c5e974acd20fd933d14b129d.css" rel="stylesheet"/>
<link href="../../css/discourse-adplugin_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-akismet_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-cakeday_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-chat-integration_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-details_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-footnote_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-lazy-videos_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-local-dates_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/color_definitions_base__2_8fd59ae1f286f43b3ff17996df07ea951685249d.css" rel="stylesheet"/>
<link href="../../css/style.css" rel="stylesheet"/>
<title>Redash 10 Excel data source</title></head>
<body>
<div class="navbar">
<div class="logo"><a href="../../page_0.html"><img alt="" src="../../images/logo_redash.png" srcset=""/></a></div>
<div class="navbar-buttons">
<button class="btn btn-signup">Sign Up</button>
<button class="btn btn-login"><i class="fas fa-user"></i> Login</button>
<button class="btn btn-search"><i class="fas fa-search"></i></button>
<div class="navbar-toggle">
<div class="dots"></div>
<div class="dots"></div>
<div class="dots"></div>
</div>
</div>
</div>
<div class="sidebar">
<div class="sidebar-content">
<div class="logo"><a href="../../page_0.html"><img alt="" src="../../images/logo_redash.png" srcset=""/></a></div>
<ul class="sidebar-grid">
<!-- <li><a href="#"><i class="fas fa-list-ul"></i> Topics</a></li> -->
<li><a href="../../page_0.html"><i class="fas fa-layer-group"></i> Topics</a></li>
<li><a href="../../users.html"><i class="fas fa-users"></i> Users</a></li>
<li><a href="../../about.html"><i class="fas fa-info-circle"></i> About</a></li>
<li><a href="../../faq.html"><i class="fas fa-question-circle"></i> FAQ</a></li>
<li><a href="../../groups.html"><i class="fas fa-users"></i> Groups</a></li>
<li><a href="../../badges.html"><i class="fas fa-certificate"></i> Badges</a></li>
</ul>
<h3 style="font-size: 13px;"><a href="#categories"><span>▼</span>Categories</a></h3>
<hr/>
<ul class="sidebar-grid categories">
<li>
<a class="badge-wrapper bullet" href="../../c/support/6.html">
<span class="badge-category-bg" style="background-color: #BF1E2E"></span>
<span class="badge-category clear-badge">
<span class="category-name">Support</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/feature-requests/5.html">
<span class="badge-category-bg" style="background-color: #3AB54A"></span>
<span class="badge-category clear-badge">
<span class="category-name">Feature Requests</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/uncategorized/1.html">
<span class="badge-category-bg" style="background-color: #AB9364"></span>
<span class="badge-category clear-badge">
<span class="category-name">Uncategorized</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/development/7.html">
<span class="badge-category-bg" style="background-color: #8C6238"></span>
<span class="badge-category clear-badge">
<span class="category-name">Development</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/tips-tricks-query-examples/11.html">
<span class="badge-category-bg" style="background-color: #652D90"></span>
<span class="badge-category clear-badge" style="white-space: normal;">
<span class="category-name">Tips, Tricks &amp; Query Examples</span>
</span>
</a>
</li>
<li><a href="../../categories.html"><i class="fas fa-list-ul"></i> All categories</a></li>
</ul>
<h3 style="font-size: 13px;"><a href="#tags"><span>▼</span>Tags</a></h3>
<hr/>
<ul class="sidebar-grid tags">
<li><a href="../../tag/query_results.html"><i class="fas fa-tag"></i> query_results</a></li>
<li><a href="../../tag/feature-request.html"><i class="fas fa-tag"></i> feature-request</a></li>
<li><a href="../../tag/parameters.html"><i class="fas fa-tag"></i> parameters</a></li>
<li><a href="../../tag/visualizations.html"><i class="fas fa-tag"></i> visualizations</a></li>
<li><a href="../../tag/alerts.html"><i class="fas fa-tag"></i> alerts</a></li>
<li><a href="../../tags.html"><i class="fas fa-list-ul"></i> All tags</a></li>
</ul>
</div>
<div class="sidebar-footer">
            © 2023 <a href="https://discuss.redash.io/" target="_blank">discuss.redash.io</a>
</div>
</div>
<div class="overlay"></div>
<div class="content">
<div class="global-notice">
<div class="row">
<div class="alert alert-info alert-read-only" id="global-notice-alert-read-only">
<span class="text">This site is in read only mode. Please continue to browse, but replying, likes,
                        and other actions are disabled for now.</span>
</div>
</div>
</div>
<div class="imported_page" id="imported_page">
<div class="wrap" id="main-outlet" role="main">
<div id="topic-title">
<h1>
<a href="/t/redash-10-excel-data-source/9207">Redash 10 Excel data source</a>
</h1>
</div>
<div itemscope="" itemtype="http://schema.org/DiscussionForumPosting">
<meta content="Redash 10 Excel data source" itemprop="headline"/>
<meta content="Uncategorized" itemprop="articleSection"/>
<meta content="" itemprop="keywords"/>
<div itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
<meta content="Redash Discourse" itemprop="name"/>
<div itemprop="logo" itemscope="" itemtype="http://schema.org/ImageObject">
<meta content="https://global.discourse-cdn.com/standard17/uploads/redash1/original/1X/c07bc573841e1e4a0013ea3b6fe088a1534228a3.png" itemprop="url"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_1">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/SunlinkHealthTech.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/SunlinkHealthTech_avatar.png" tabindex="-1" width="48"/><span itemprop="name">SunlinkHealthTech</span></a>
</span>
<link href="assets/9207" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2021-10-06T15:16:19Z" itemprop="datePublished">
                    October 6, 2021,  3:16pm
                  </time>
<meta content="2021-10-06T15:16:19Z" itemprop="dateModified"/>
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p>Is there any info out there on how the new Excel data source works?</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
<div class="crawler-linkback-list" itemscope="" itemtype="http://schema.org/ItemList">
<div itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
<a href="https://discuss.redash.io/t/how-works-excel-and-csv-datasources/10356" itemprop="url">How works Excel and CSV datasources?</a>
<meta content="1" itemprop="position"/>
</div>
</div>
</div>
<div class="topic-body crawler-post" id="post_2" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/jesse.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/jesse_avatar.png" tabindex="-1" width="48"/><span itemprop="name">jesse</span></a>
</span>
<link href="assets/9207" itemprop="mainEntityOfPage"/>
<link href="assets/a62bde6d468bcb3b6641f956d6cb1aaee3bfefca.jpeg" itemprop="image"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2021-10-06T19:36:23Z" itemprop="datePublished">
                    October 6, 2021,  7:36pm
                  </time>
<meta content="2021-10-06T19:36:23Z" itemprop="dateModified"/>
<span itemprop="position">2</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Great question <img alt=":smiley:" class="emoji" height="20" loading="lazy" src="assets/smiley.png" title=":smiley:" width="20"/></p>
<p>This merged as part of V10 but isn’t included in the docs yet. I haven’t used it before but I just loaded it up and have a working version. I’ll open a PR to the documentation website soon. I figured this out just by looking at the query runner source code <img alt=":wink:" class="emoji" height="20" loading="lazy" src="assets/wink.png" title=":wink:" width="20"/></p>
<p>But for now here you go:</p>
<hr/>
<h2>
<a class="anchor" href="#excel-data-source-1" name="excel-data-source-1"></a>Excel Data Source</h2>
<p>The Excel data source introduced in V10 accepts queries in <code>yaml</code> format. Your <code>yaml</code> may contain two different tags:</p>
<ul>
<li>
<strong>url</strong> - the URL that will be fetched</li>
<li>
<strong>ua</strong> - the user agent string that will be passed in with the request</li>
</ul>
<p>An example query that uses a <a href="https://www.dol.gov/agencies/eta/national-agricultural-workers-survey/data/files-excel-csv">publicly available data set</a>:</p>
<pre data-code-wrap="yaml"><code class="lang-nohighlight">url: https://www.dol.gov/sites/dolgov/files/ETA/naws/pdfs/NAWS_A2E191.xlsx
</code></pre>
<p>It produces this table:</p>
<p><div class="lightbox-wrapper"><a class="lightbox" data-download-href="/uploads/short-url/nI1fpW3tcJyZHc4rbuO90SdyU9Y.jpeg?dl=1" href="https://global.discourse-cdn.com/standard17/uploads/redash1/original/2X/a/a62bde6d468bcb3b6641f956d6cb1aaee3bfefca.jpeg" title="CleanShot 2021-10-06 at 14.36.06"><img alt="CleanShot 2021-10-06 at 14.36.06" data-base62-sha1="nI1fpW3tcJyZHc4rbuO90SdyU9Y" data-small-upload="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/a/a62bde6d468bcb3b6641f956d6cb1aaee3bfefca_2_10x10.png" height="476" src="assets/a62bde6d468bcb3b6641f956d6cb1aaee3bfefca_2_690x476.jpeg" srcset="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/a/a62bde6d468bcb3b6641f956d6cb1aaee3bfefca_2_690x476.jpeg, https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/a/a62bde6d468bcb3b6641f956d6cb1aaee3bfefca_2_1035x714.jpeg 1.5x, https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/a/a62bde6d468bcb3b6641f956d6cb1aaee3bfefca_2_1380x952.jpeg 2x" width="690"/><div class="meta">
<svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use href="#far-image"></use></svg><span class="filename">CleanShot 2021-10-06 at 14.36.06</span><span class="informations">1590×1098 137 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
</div>
<div class="crawler-linkback-list" itemscope="" itemtype="http://schema.org/ItemList">
<div itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
<a href="http://discuss.redash.io/t/excel-data-source-load-multiple-same-structure-files-from-the-location/9300" itemprop="url">Excel data source: load multiple (same structure) files from the location</a>
<meta content="3" itemprop="position"/>
</div>
</div>
</div>
<div class="topic-body crawler-post" id="post_3" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/vucu.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/vucu_avatar.png" tabindex="-1" width="48"/><span itemprop="name">vucu</span></a>
</span>
<link href="assets/9207" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2021-10-19T15:39:56Z" itemprop="datePublished">
                    October 19, 2021,  3:39pm
                  </time>
<meta content="2021-10-19T15:39:56Z" itemprop="dateModified"/>
<span itemprop="position">3</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Not sure if I should create a new topic, or if i am allowed to continue here, but i was wondering if the excel data source allows picking up multiple files from the location ( something like location*.xlsx, or location test%.xlsx)</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_4" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/jesse.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/jesse_avatar.png" tabindex="-1" width="48"/><span itemprop="name">jesse</span></a>
</span>
<link href="assets/9207" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2021-10-19T15:45:22Z" itemprop="datePublished">
                    October 19, 2021,  3:45pm
                  </time>
<meta content="2021-10-19T15:45:22Z" itemprop="dateModified"/>
<span itemprop="position">4</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Not as far as I know. But this could be a good addition. How would you expect this to behave? Since most queries return at most one set of tabular data, would you expect multiple table visualisations to appear? Would the tables be concatenated?</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_5" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/vucu.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/vucu_avatar.png" tabindex="-1" width="48"/><span itemprop="name">vucu</span></a>
</span>
<link href="assets/9207" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2021-10-19T15:53:21Z" itemprop="datePublished">
                    October 19, 2021,  3:53pm
                  </time>
<meta content="2021-10-19T15:53:21Z" itemprop="dateModified"/>
<span itemprop="position">5</span>
</span>
</div>
<div class="post" itemprop="text">
<p>i was thinking of a scenario where the files are similar in structure (eg: different day logs , etc), so the expected behavior in this case would be indeed concatenation.</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_6" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/jesse.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/jesse_avatar.png" tabindex="-1" width="48"/><span itemprop="name">jesse</span></a>
</span>
<link href="assets/9207" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2021-10-19T16:00:17Z" itemprop="datePublished">
                    October 19, 2021,  4:00pm
                  </time>
<meta content="2021-10-19T16:00:17Z" itemprop="dateModified"/>
<span itemprop="position">6</span>
</span>
</div>
<div class="post" itemprop="text">
<p>That makes sense. Can you create a feature request thread for this here on the forum? Just specify the expected behavior. This way the community can get visibility on outstanding pull requests.</p>
<p>Alternatively, if you want to implement this yourself I’m happy to answer questions, review, merge etc.</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_7" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/ilyaminati.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/ilyaminati_avatar.png" tabindex="-1" width="48"/><span itemprop="name">ilyaminati</span></a>
</span>
<link href="assets/9207" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2021-10-19T19:43:39Z" itemprop="datePublished">
                    October 19, 2021,  7:43pm
                  </time>
<meta content="2021-10-19T19:43:39Z" itemprop="dateModified"/>
<span itemprop="position">7</span>
</span>
</div>
<div class="post" itemprop="text">
<p>How does the Excel data source handle spreadsheets that contain multiple sheets / tabs?</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_8" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/jesse.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/jesse_avatar.png" tabindex="-1" width="48"/><span itemprop="name">jesse</span></a>
</span>
<link href="assets/9207" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2021-10-19T19:49:52Z" itemprop="datePublished">
                    October 19, 2021,  7:49pm
                  </time>
<meta content="2021-10-19T19:49:52Z" itemprop="dateModified"/>
<span itemprop="position">8</span>
</span>
</div>
<div class="post" itemprop="text">
<p>If you look at the query runner code it appears to use the default behavior of <code>read_excel</code> in Pandas. Which is to pull the first sheet. It would be a trivial adjustment to make this configurable in the query, though.</p>
<p>See the query runner code <a href="https://github.com/getredash/redash/blob/master/redash/query_runner/excel.py">here</a>.</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
<span class="post-likes">1 Like</span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_10" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/willy-dauphin.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/willy-dauphin_avatar.png" tabindex="-1" width="48"/><span itemprop="name">willy-dauphin</span></a>
</span>
<link href="assets/9207" itemprop="mainEntityOfPage"/>
<link href="assets/7074f18696249975e881ed57edaf83ec415314f8.jpeg" itemprop="image"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2022-05-12T06:51:58Z" itemprop="datePublished">
                    May 12, 2022,  6:51am
                  </time>
<meta content="2022-05-12T06:51:58Z" itemprop="dateModified"/>
<span itemprop="position">10</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Hi !<br/>
I rode the <a href="https://github.com/getredash/redash/blob/master/redash/query_runner/excel.py" rel="noopener nofollow ugc">query runner</a> again and <a href="https://pandas.pydata.org/docs/reference/api/pandas.read_excel.html" rel="noopener nofollow ugc">documentation</a> too. Actually, it’s already possible to query a sheet number with XLS file <img alt=":slight_smile:" class="emoji" height="20" loading="lazy" src="assets/slight_smile.png" title=":slight_smile:" width="20"/></p>
<p>The solution is here (<em>excel.py</em>, line 57) :</p>
<pre><code class="lang-auto">workbook = pd.read_excel(response.content, **args)
</code></pre>
<p>As you can see, the list called <em>args</em> is depacted as function parameters. So, we just have to use the correct parameter name to use it, according to the <a href="https://pandas.pydata.org/docs/reference/api/pandas.read_excel.html" rel="noopener nofollow ugc">read_excel</a> function !</p>
<p>For example, this is my nextcloud spreadsheet. First share the link (yellow rectangle) :<br/>
<div class="lightbox-wrapper"><a class="lightbox" data-download-href="/uploads/short-url/g2Q1ForjmmK425mXL6WTFA0cpUA.jpeg?dl=1" href="https://global.discourse-cdn.com/standard17/uploads/redash1/original/2X/7/7074f18696249975e881ed57edaf83ec415314f8.jpeg" rel="noopener nofollow ugc" title="C1"><img alt="C1" data-base62-sha1="g2Q1ForjmmK425mXL6WTFA0cpUA" data-small-upload="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/7/7074f18696249975e881ed57edaf83ec415314f8_2_10x10.png" height="318" src="assets/7074f18696249975e881ed57edaf83ec415314f8_2_690x318.jpeg" srcset="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/7/7074f18696249975e881ed57edaf83ec415314f8_2_690x318.jpeg, https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/7/7074f18696249975e881ed57edaf83ec415314f8_2_1035x477.jpeg 1.5x, https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/7/7074f18696249975e881ed57edaf83ec415314f8_2_1380x636.jpeg 2x" width="690"/><div class="meta">
<svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use href="#far-image"></use></svg><span class="filename">C1</span><span class="informations">1920×887 96.5 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>Then, copy the download link (yellow rectangle) :<br/>
<div class="lightbox-wrapper"><a class="lightbox" data-download-href="/uploads/short-url/voA10DPVExzG25OCncDA8kVwJpc.jpeg?dl=1" href="https://global.discourse-cdn.com/standard17/uploads/redash1/original/2X/d/dc0ab8f4244624fa91f14a3bf0d2c8ab5113bcde.jpeg" rel="noopener nofollow ugc" title="C2"><img alt="C2" data-base62-sha1="voA10DPVExzG25OCncDA8kVwJpc" data-small-upload="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/d/dc0ab8f4244624fa91f14a3bf0d2c8ab5113bcde_2_10x10.png" height="319" src="assets/dc0ab8f4244624fa91f14a3bf0d2c8ab5113bcde_2_690x319.jpeg" srcset="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/d/dc0ab8f4244624fa91f14a3bf0d2c8ab5113bcde_2_690x319.jpeg, https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/d/dc0ab8f4244624fa91f14a3bf0d2c8ab5113bcde_2_1035x478.jpeg 1.5x, https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/d/dc0ab8f4244624fa91f14a3bf0d2c8ab5113bcde_2_1380x638.jpeg 2x" width="690"/><div class="meta">
<svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use href="#far-image"></use></svg><span class="filename">C2</span><span class="informations">1917×887 137 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>Create a new query with excel datasource and fill parameters “url” with the link copied and “sheet_name” with the sheet number. First sheet = 0 (by default) / second sheet = 1 / etc.<br/>
<div class="lightbox-wrapper"><a class="lightbox" data-download-href="/uploads/short-url/gKO2L1T2J1wQGPYZmirDli09DO8.jpeg?dl=1" href="https://global.discourse-cdn.com/standard17/uploads/redash1/original/2X/7/756d4d8ce7f218befa2d5c7b90cbaeb9bb154ef8.jpeg" rel="noopener nofollow ugc" title="C3"><img alt="C3" data-base62-sha1="gKO2L1T2J1wQGPYZmirDli09DO8" data-small-upload="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/7/756d4d8ce7f218befa2d5c7b90cbaeb9bb154ef8_2_10x10.png" height="318" src="assets/756d4d8ce7f218befa2d5c7b90cbaeb9bb154ef8_2_690x318.jpeg" srcset="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/7/756d4d8ce7f218befa2d5c7b90cbaeb9bb154ef8_2_690x318.jpeg, https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/7/756d4d8ce7f218befa2d5c7b90cbaeb9bb154ef8_2_1035x477.jpeg 1.5x, https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/7/756d4d8ce7f218befa2d5c7b90cbaeb9bb154ef8_2_1380x636.jpeg 2x" width="690"/><div class="meta">
<svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use href="#far-image"></use></svg><span class="filename">C3</span><span class="informations">1920×887 98.2 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>You can easily change the sheetnumber like this :<br/>
<div class="lightbox-wrapper"><a class="lightbox" data-download-href="/uploads/short-url/maUdeLF1ArwXqwci9vNC57ITS1L.jpeg?dl=1" href="https://global.discourse-cdn.com/standard17/uploads/redash1/original/2X/9/9b6b729b5ff0a51d094e30ed36ea36d9cfcd01ad.jpeg" rel="noopener nofollow ugc" title="C4"><img alt="C4" data-base62-sha1="maUdeLF1ArwXqwci9vNC57ITS1L" data-small-upload="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/9/9b6b729b5ff0a51d094e30ed36ea36d9cfcd01ad_2_10x10.png" height="318" src="assets/9b6b729b5ff0a51d094e30ed36ea36d9cfcd01ad_2_690x318.jpeg" srcset="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/9/9b6b729b5ff0a51d094e30ed36ea36d9cfcd01ad_2_690x318.jpeg, https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/9/9b6b729b5ff0a51d094e30ed36ea36d9cfcd01ad_2_1035x477.jpeg 1.5x, https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/9/9b6b729b5ff0a51d094e30ed36ea36d9cfcd01ad_2_1380x636.jpeg 2x" width="690"/><div class="meta">
<svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use href="#far-image"></use></svg><span class="filename">C4</span><span class="informations">1920×887 96.4 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>And of course others parameters like <em>nrows</em> :<br/>
<div class="lightbox-wrapper"><a class="lightbox" data-download-href="/uploads/short-url/h9nVHUZXuF4S4I4xJOQZC1Y4uMO.jpeg?dl=1" href="https://global.discourse-cdn.com/standard17/uploads/redash1/original/2X/7/7834925a46c3ad74dd1037030142e5576c77c8ca.jpeg" rel="noopener nofollow ugc" title="C5"><img alt="C5" data-base62-sha1="h9nVHUZXuF4S4I4xJOQZC1Y4uMO" data-small-upload="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/7/7834925a46c3ad74dd1037030142e5576c77c8ca_2_10x10.png" height="318" src="assets/7834925a46c3ad74dd1037030142e5576c77c8ca_2_690x318.jpeg" srcset="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/7/7834925a46c3ad74dd1037030142e5576c77c8ca_2_690x318.jpeg, https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/7/7834925a46c3ad74dd1037030142e5576c77c8ca_2_1035x477.jpeg 1.5x, https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/7/7834925a46c3ad74dd1037030142e5576c77c8ca_2_1380x636.jpeg 2x" width="690"/><div class="meta">
<svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use href="#far-image"></use></svg><span class="filename">C5</span><span class="informations">1920×887 96.9 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>see you <img alt=":slight_smile:" class="emoji" height="20" loading="lazy" src="assets/slight_smile.png" title=":slight_smile:" width="20"/></p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_11" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/Rash1d.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/Rash1d_avatar.png" tabindex="-1" width="48"/><span itemprop="name">Rash1d</span></a>
</span>
<link href="assets/9207" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2022-07-19T17:02:37Z" itemprop="datePublished">
                    July 19, 2022,  5:02pm
                  </time>
<meta content="2022-07-19T17:02:37Z" itemprop="dateModified"/>
<span itemprop="position">11</span>
</span>
</div>
<div class="post" itemprop="text">
<p>could someone help with authenticating to excel datasource, e.g. if we have an excel hosted on sharepoint, it will require authentication.</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_12" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/jesse.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/jesse_avatar.png" tabindex="-1" width="48"/><span itemprop="name">jesse</span></a>
</span>
<link href="assets/9207" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2022-07-19T17:22:02Z" itemprop="datePublished">
                    July 19, 2022,  5:22pm
                  </time>
<meta content="2022-07-19T17:22:02Z" itemprop="dateModified"/>
<span itemprop="position">12</span>
</span>
</div>
<div class="post" itemprop="text">
<p>What kind of authentication is needed? HTTP Basic auth? Oauth?</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_13" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/Rash1d.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/Rash1d_avatar.png" tabindex="-1" width="48"/><span itemprop="name">Rash1d</span></a>
</span>
<link href="assets/9207" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2022-07-19T18:49:19Z" itemprop="datePublished">
                    July 19, 2022,  6:49pm
                  </time>
<meta content="2022-07-19T18:49:19Z" itemprop="dateModified"/>
<span itemprop="position">13</span>
</span>
</div>
<div class="post" itemprop="text">
<p>yes basic auth should work</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_14" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/jesse.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/jesse_avatar.png" tabindex="-1" width="48"/><span itemprop="name">jesse</span></a>
</span>
<link href="assets/9207" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2022-07-19T18:57:38Z" itemprop="datePublished">
                    July 19, 2022,  6:57pm
                  </time>
<meta content="2022-07-19T18:57:38Z" itemprop="dateModified"/>
<span itemprop="position">14</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Alright the existing excel query runner doesn’t support basic auth. This means there are a couple options:</p>
<ol>
<li>Write a custom sharepoint query runner so you enter the username and password in secret fields on the data source configuration screen (I can help you with this).</li>
<li>Update the excel query runner to accept HTTP basic auth key-value-pairs</li>
<li>Use the existing Python query runner so you can access <code>requests</code> directly and also transform the data however you need.</li>
</ol>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="1" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_15" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/angelochu7.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/angelochu7_avatar.png" tabindex="-1" width="48"/><span itemprop="name">angelochu7</span></a>
</span>
<link href="assets/9207" itemprop="mainEntityOfPage"/>
<link href="assets/9e1d6aa57e62e36335230221f1f10b05abfd4ce5.png" itemprop="image"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2022-10-12T04:48:21Z" itemprop="datePublished">
                    October 12, 2022,  4:48am
                  </time>
<meta content="2022-10-12T04:48:21Z" itemprop="dateModified"/>
<span itemprop="position">15</span>
</span>
</div>
<div class="post" itemprop="text">
<p>May I know whether it will work with Microsoft OneDrive hyperlink? It seems it’s not working.</p>
<p><div class="lightbox-wrapper"><a class="lightbox" data-download-href="/uploads/short-url/myKsPLsZprGjHF1Ltn3sdhdyteJ.png?dl=1" href="https://global.discourse-cdn.com/standard17/uploads/redash1/original/2X/9/9e1d6aa57e62e36335230221f1f10b05abfd4ce5.png" rel="noopener nofollow ugc" title="Screenshot 2022-10-12 at 12.40.04 PM"><img alt="Screenshot 2022-10-12 at 12.40.04 PM" data-base62-sha1="myKsPLsZprGjHF1Ltn3sdhdyteJ" data-dominant-color="F9CFB4" height="50" src="assets/9e1d6aa57e62e36335230221f1f10b05abfd4ce5.png" width="690"/><div class="meta">
<svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use href="#far-image"></use></svg><span class="filename">Screenshot 2022-10-12 at 12.40.04 PM</span><span class="informations">1163×85 4.02 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>Another question is, I got the following error when trying to load the sample excel file (url: <a href="https://www.dol.gov/sites/dolgov/files/ETA/naws/pdfs/NAWS_A2E191.xlsx" rel="noopener nofollow ugc">https://www.dol.gov/sites/dolgov/files/ETA/naws/pdfs/NAWS_A2E191.xlsx</a>):</p>
<p><div class="lightbox-wrapper"><a class="lightbox" data-download-href="/uploads/short-url/t1uO2GHAKHbTRsRKdAWooibTWi3.png?dl=1" href="https://global.discourse-cdn.com/standard17/uploads/redash1/original/2X/c/cb6a5cce2a6def36d7d176fee039a11c5f663cff.png" rel="noopener nofollow ugc" title="Screenshot 2022-10-12 at 12.47.01 PM"><img alt="Screenshot 2022-10-12 at 12.47.01 PM" data-base62-sha1="t1uO2GHAKHbTRsRKdAWooibTWi3" data-dominant-color="F6E9E7" height="31" src="assets/cb6a5cce2a6def36d7d176fee039a11c5f663cff.png" width="690"/><div class="meta">
<svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use href="#far-image"></use></svg><span class="filename">Screenshot 2022-10-12 at 12.47.01 PM</span><span class="informations">1163×53 3.79 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use href="#discourse-expand"></use></svg>
</div></a></div></p>
<p>Thanks a million for your comment.</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_16" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/willy-dauphin.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/willy-dauphin_avatar.png" tabindex="-1" width="48"/><span itemprop="name">willy-dauphin</span></a>
</span>
<link href="assets/9207" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2023-01-15T06:44:33Z" itemprop="datePublished">
                    January 15, 2023,  6:44am
                  </time>
<meta content="2023-01-15T06:44:33Z" itemprop="dateModified"/>
<span itemprop="position">16</span>
</span>
</div>
<div class="post" itemprop="text">
<p>Hey <a class="mention" href="/u/jesse">@jesse</a> !<br/>
Is it possible to read an excel data source and provide a private token ? I’m working with <a href="https://support.kobotoolbox.org/synchronous_exports.html" rel="noopener nofollow ugc">KoboToolbox</a> and I would like to access to private data. Any idea ? <img alt=":slight_smile:" class="emoji" height="20" loading="lazy" src="assets/slight_smile.png" title=":slight_smile:" width="20"/></p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="overlay" id="modalOverlay" style="display: none;">
<div class="modal-content">
<p>Login or sign up disabled while the site is in read only mode</p>
<hr/>
<button class="btn btn-login">OK</button>
</div>
</div>
<script src="../../js/script.js"></script>
</body>
</html>