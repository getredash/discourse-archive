<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Error running query: Can&#39;t query private addresses</title>
    <link>https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568</link>
    <description>Hi,

I am trying to call a PRTG API with built in authentication in the URL using the JSON Data Source. I have added the new Data Source with the correct URL and authentication, through the settings. When trying to run a query on the URL, i get this error: Error running query:  **Can&#39;t query private addresses.**

I tried to follow the JSON &amp; URL guide, but i keep getting that error. It also happens when i add the url: https://xxx.xx:someport/jsonApi

Can i setup this in another way or change how i call the URL? When i enter the URL in my browser i get all the data from PRTG as a JSON response.

Thanks in advance :slight_smile:</description>
    
    <lastBuildDate>Fri, 16 Dec 2022 16:53:20 +0000</lastBuildDate>
    <category>Usage Support</category>
    <atom:link href="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Error running query: Can&#39;t query private addresses</title>
        <dc:creator><![CDATA[Ole.Hofmann]]></dc:creator>
        <description><![CDATA[
            <p>Hello,<br>
when I address an external API with the JSON connection, I get the error message:<br>
“Error running query: Proxies cannot be used with Advocate”.</p>
<p>Is this problem also related to the “REDASH_ENFORCE_PRIVATE_IP_BLOCK” setting?</p>
<p>many thanks</p>
          <p><a href="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/17">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/17</link>
        <pubDate>Fri, 16 Dec 2022 16:53:20 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-4568-17</guid>
        <source url="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568.rss">Error running query: Can&#39;t query private addresses</source>
      </item>
      <item>
        <title>Error running query: Can&#39;t query private addresses</title>
        <dc:creator><![CDATA[pythonous]]></dc:creator>
        <description><![CDATA[
            <p>Good syntax. Need to check rights of this file, must be same userid as inside container (1000 ?).<br>
And after, still not working on my side because file is mounted to late and is not the one used at startup (restart nginx container only has no effect). But when going inside container + cat the file, it’s the good version.</p>
          <p><a href="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/16">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/16</link>
        <pubDate>Thu, 17 Nov 2022 14:48:53 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-4568-16</guid>
        <source url="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568.rss">Error running query: Can&#39;t query private addresses</source>
      </item>
      <item>
        <title>Error running query: Can&#39;t query private addresses</title>
        <dc:creator><![CDATA[jupe]]></dc:creator>
        <description><![CDATA[
            <p>Here seems to be an undocumented configuration for this already in the latest <a href="https://github.com/getredash/redash/releases/tag/v10.0.0" rel="noopener nofollow ugc">release@v10.0.0</a>:<br>
REDASH_ENFORCE_PRIVATE_IP_BLOCK<br>
See code: <a href="https://github.com/getredash/redash/blob/143d22db04a9058966b8c7d678b06f228b937326/redash/settings/" class="inline-onebox" rel="noopener nofollow ugc">redash/redash/settings at 143d22db04a9058966b8c7d678b06f228b937326 · getredash/redash · GitHub</a><strong>init</strong>.py#L80</p>
          <p><a href="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/15">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/15</link>
        <pubDate>Wed, 03 Nov 2021 09:23:05 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-4568-15</guid>
        <source url="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568.rss">Error running query: Can&#39;t query private addresses</source>
      </item>
      <item>
        <title>Error running query: Can&#39;t query private addresses</title>
        <dc:creator><![CDATA[SolutionYogi]]></dc:creator>
        <description><![CDATA[
            <p>Hi,</p>
<p>Could you please give an example of the docker-compose file? I tried following and it doesn’t work.</p>
<p>I am not an expert on docker and not able to find the right syntax for me to use.</p>
<p>services:<br>
server:<br>
&lt;&lt;: *redash-service<br>
command: server<br>
ports:<br>
- “5000:5000”<br>
environment:<br>
REDASH_WEB_WORKERS: 4<br>
volumes:<br>
- ./json_ds.py:/app/redash/query_runner/json_ds.py</p>
          <p><a href="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/14">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/14</link>
        <pubDate>Thu, 02 Apr 2020 19:29:59 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-4568-14</guid>
        <source url="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568.rss">Error running query: Can&#39;t query private addresses</source>
      </item>
      <item>
        <title>Error running query: Can&#39;t query private addresses</title>
        <dc:creator><![CDATA[Christian-Schou]]></dc:creator>
        <description><![CDATA[
            <p>Thank you very much <a class="mention" href="https://discuss.redash.io/u/arikfr">@arikfr</a>, i will try what you suggest and let you guys know what i ended up with. <img src="https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
          <p><a href="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/13">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/13</link>
        <pubDate>Thu, 26 Sep 2019 08:39:32 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-4568-13</guid>
        <source url="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568.rss">Error running query: Can&#39;t query private addresses</source>
      </item>
      <item>
        <title>Error running query: Can&#39;t query private addresses</title>
        <dc:creator><![CDATA[arikfr]]></dc:creator>
        <description><![CDATA[
            <p>Sort of: he needs to build a new Docker image or mount the updated file into his Docker image.</p>
<p>Something along the lines of:</p>
<ol>
<li>Take <a href="https://github.com/getredash/redash/blob/master/redash/query_runner/json_ds.py" rel="nofollow noopener"><code>redash/query_runner/json_ds.py</code></a> and modify it to support private addresses (i.e. remove <a href="https://github.com/getredash/redash/blob/2c77c219c68996e1d43abc60282da4bb5a594271/redash/query_runner/json_ds.py#L180-L181" rel="nofollow noopener">lines 180-181</a>).</li>
<li>Place the file in <code>/opt/redash</code> (or wherever).</li>
<li>Update <code>docker-compose.yml</code> to mount a volume of this file and place it in <code>/app/redash/query_runner/json_ds.py</code>.</li>
</ol>
          <p><a href="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/12">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/12</link>
        <pubDate>Wed, 25 Sep 2019 08:41:03 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-4568-12</guid>
        <source url="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568.rss">Error running query: Can&#39;t query private addresses</source>
      </item>
      <item>
        <title>Error running query: Can&#39;t query private addresses</title>
        <dc:creator><![CDATA[jesse]]></dc:creator>
        <description><![CDATA[
            <p><a class="mention" href="https://discuss.redash.io/u/arikfr">@arikfr</a> I think he could just comment out those Python lines.</p>
          <p><a href="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/11">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/11</link>
        <pubDate>Tue, 24 Sep 2019 12:21:09 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-4568-11</guid>
        <source url="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568.rss">Error running query: Can&#39;t query private addresses</source>
      </item>
      <item>
        <title>Error running query: Can&#39;t query private addresses</title>
        <dc:creator><![CDATA[Christian-Schou]]></dc:creator>
        <description><![CDATA[
            <p>Ahh okay, then i get it. So, my question is now - how can I add this environment variable in order to control that behavior? I am the only user, so no chance of any users executing stuff they should not execute <img src="https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
          <p><a href="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/10">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/10</link>
        <pubDate>Tue, 24 Sep 2019 12:19:56 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-4568-10</guid>
        <source url="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568.rss">Error running query: Can&#39;t query private addresses</source>
      </item>
      <item>
        <title>Error running query: Can&#39;t query private addresses</title>
        <dc:creator><![CDATA[arikfr]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-post="8" data-topic="4568">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="20" height="20" src="https://sjc6.discourse-cdn.com/standard17/user_avatar/discuss.redash.io/christian-schou/40/1408_2.png" class="avatar"> Christian-Schou:</div>
<blockquote>
<p>Should i go for the method <a class="mention" href="https://discuss.redash.io/u/jesse">@jesse</a> told me with the private networking or look into changing the environment variable?</p>
</blockquote>
</aside>
<p>What <a class="mention" href="https://discuss.redash.io/u/jesse">@jesse</a> mentioned won’t help, as this is not a setup/Docker issue, but rather an intentional filter in our code.</p>
<p>And just to clarify: there is no environment variable to control this behavior, I was just suggesting adding one.</p>
          <p><a href="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/9">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/9</link>
        <pubDate>Tue, 24 Sep 2019 12:16:30 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-4568-9</guid>
        <source url="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568.rss">Error running query: Can&#39;t query private addresses</source>
      </item>
      <item>
        <title>Error running query: Can&#39;t query private addresses</title>
        <dc:creator><![CDATA[Christian-Schou]]></dc:creator>
        <description><![CDATA[
            <p>Well, a little confused <img src="https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
<p>Should i go for the method <a class="mention" href="https://discuss.redash.io/u/jesse">@jesse</a> told me with the private networking or look into changing the environment variable?</p>
          <p><a href="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/8">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/8</link>
        <pubDate>Tue, 24 Sep 2019 11:40:43 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-4568-8</guid>
        <source url="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568.rss">Error running query: Can&#39;t query private addresses</source>
      </item>
      <item>
        <title>Error running query: Can&#39;t query private addresses</title>
        <dc:creator><![CDATA[arikfr]]></dc:creator>
        <description><![CDATA[
            <p>Actually the filtering/check happens in the Query Runner implementation:</p>
<aside class="onebox githubblob">
  <header class="source">
      <a href="https://github.com/getredash/redash/blob/401d16462253932c5373187b35a4d99a74eee0aa/redash/query_runner/json_ds.py#L180-L181" target="_blank" rel="nofollow noopener">github.com</a>
  </header>
  <article class="onebox-body">
    <h4><a href="https://github.com/getredash/redash/blob/401d16462253932c5373187b35a4d99a74eee0aa/redash/query_runner/json_ds.py#L180-L181" target="_blank" rel="nofollow noopener">getredash/redash/blob/401d16462253932c5373187b35a4d99a74eee0aa/redash/query_runner/json_ds.py#L180-L181</a></h4>
<pre class="onebox"><code class="lang-py"><ol class="start lines" start="180" style="counter-reset: li-counter 179 ;">
<li>if is_private_address(query['url']):</li>
<li>    raise Exception("Can't query private addresses.")</li>
</ol></code></pre>


  </article>
  <div class="onebox-metadata">
    
    
  </div>
  <div style="clear: both"></div>
</aside>

<p>This is to avoid people using the JSON data source to access information they are not supposed to, like AWS metadata API.</p>
<p>Happy to accept a PR that makes this behavior configurable with an environment variable. Just note that if you disable this check, you need to trust whoever you allow running queries in your system.</p>
          <p><a href="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/7">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/7</link>
        <pubDate>Tue, 24 Sep 2019 11:33:42 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-4568-7</guid>
        <source url="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568.rss">Error running query: Can&#39;t query private addresses</source>
      </item>
      <item>
        <title>Error running query: Can&#39;t query private addresses</title>
        <dc:creator><![CDATA[Christian-Schou]]></dc:creator>
        <description><![CDATA[
            <p>Well that might sound like a solution for the issue. Do you happen to know, how to implement this routing rule? Or know a place, where i can figure out how to do it? <img src="https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
          <p><a href="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/6">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/6</link>
        <pubDate>Tue, 24 Sep 2019 11:13:08 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-4568-6</guid>
        <source url="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568.rss">Error running query: Can&#39;t query private addresses</source>
      </item>
      <item>
        <title>Error running query: Can&#39;t query private addresses</title>
        <dc:creator><![CDATA[jesse]]></dc:creator>
        <description><![CDATA[
            <p>Gotcha. That explains the private address issue. Redash is running in a private network via Docker Compose. Which is why the JSON data source filters out private IP addresses.</p>
<p>You need to add a routing rule to your Docker configuration that passes traffic to and from PRTG.</p>
          <p><a href="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/5">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/5</link>
        <pubDate>Tue, 24 Sep 2019 11:11:08 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-4568-5</guid>
        <source url="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568.rss">Error running query: Can&#39;t query private addresses</source>
      </item>
      <item>
        <title>Error running query: Can&#39;t query private addresses</title>
        <dc:creator><![CDATA[Christian-Schou]]></dc:creator>
        <description><![CDATA[
            <p>I used the docker image as described in the documentation <img src="https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
          <p><a href="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/4">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/4</link>
        <pubDate>Tue, 24 Sep 2019 11:06:51 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-4568-4</guid>
        <source url="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568.rss">Error running query: Can&#39;t query private addresses</source>
      </item>
      <item>
        <title>Error running query: Can&#39;t query private addresses</title>
        <dc:creator><![CDATA[jesse]]></dc:creator>
        <description><![CDATA[
            <p>How did you install Redash?</p>
          <p><a href="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/3">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/3</link>
        <pubDate>Tue, 24 Sep 2019 10:55:31 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-4568-3</guid>
        <source url="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568.rss">Error running query: Can&#39;t query private addresses</source>
      </item>
      <item>
        <title>Error running query: Can&#39;t query private addresses</title>
        <dc:creator><![CDATA[Christian-Schou]]></dc:creator>
        <description><![CDATA[
            <p>I tried changing the URL to this: https%3A%2F%2Fxxx.xx:someport/jsonApi - then i get this error: Error running query:  <strong>gethostbyname() argument 1 must be string, not None</strong> I guess that only worked for the old URL Data Source?</p>
          <p><a href="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/2">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/2</link>
        <pubDate>Tue, 24 Sep 2019 09:05:50 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-4568-2</guid>
        <source url="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568.rss">Error running query: Can&#39;t query private addresses</source>
      </item>
      <item>
        <title>Error running query: Can&#39;t query private addresses</title>
        <dc:creator><![CDATA[Christian-Schou]]></dc:creator>
        <description><![CDATA[
            <p>Hi,</p>
<p>I am trying to call a PRTG API with built in authentication in the URL using the JSON Data Source. I have added the new Data Source with the correct URL and authentication, through the settings. When trying to run a query on the URL, i get this error: Error running query:  <strong>Can’t query private addresses.</strong></p>
<p>I tried to follow the JSON &amp; URL guide, but i keep getting that error. It also happens when i add the url: <a href="https://xxx.xx" rel="nofollow noopener">https://xxx.xx</a>:someport/jsonApi</p>
<p>Can i setup this in another way or change how i call the URL? When i enter the URL in my browser i get all the data from PRTG as a JSON response.</p>
<p>Thanks in advance <img src="https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=9" title=":slight_smile:" class="emoji" alt=":slight_smile:"></p>
          <p><a href="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/1">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568/1</link>
        <pubDate>Tue, 24 Sep 2019 06:56:34 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-4568-1</guid>
        <source url="https://discuss.redash.io/t/error-running-query-cant-query-private-addresses/4568.rss">Error running query: Can&#39;t query private addresses</source>
      </item>
  </channel>
</rss>
