<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet"/>
<link href="../../css/checklist_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/desktop_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/desktop_theme_2_be4cb2b86ec06123c5e974acd20fd933d14b129d.css" rel="stylesheet"/>
<link href="../../css/discourse-adplugin_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-akismet_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-cakeday_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-chat-integration_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-details_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-footnote_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-lazy-videos_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-local-dates_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/color_definitions_base__2_8fd59ae1f286f43b3ff17996df07ea951685249d.css" rel="stylesheet"/>
<link href="../../css/style.css" rel="stylesheet"/>
<title>Docker deployed redash-v8 (using the host's pg database)</title></head>
<body>
<div class="navbar">
<div class="logo"><a href="../../page_0.html"><img alt="" src="../../images/logo_redash.png" srcset=""/></a></div>
<div class="navbar-buttons">
<button class="btn btn-signup">Sign Up</button>
<button class="btn btn-login"><i class="fas fa-user"></i> Login</button>
<button class="btn btn-search"><i class="fas fa-search"></i></button>
<div class="navbar-toggle">
<div class="dots"></div>
<div class="dots"></div>
<div class="dots"></div>
</div>
</div>
</div>
<div class="sidebar">
<div class="sidebar-content">
<div class="logo"><a href="../../page_0.html"><img alt="" src="../../images/logo_redash.png" srcset=""/></a></div>
<ul class="sidebar-grid">
<!-- <li><a href="#"><i class="fas fa-list-ul"></i> Topics</a></li> -->
<li><a href="../../page_0.html"><i class="fas fa-layer-group"></i> Topics</a></li>
<li><a href="../../users.html"><i class="fas fa-users"></i> Users</a></li>
<li><a href="../../about.html"><i class="fas fa-info-circle"></i> About</a></li>
<li><a href="../../faq.html"><i class="fas fa-question-circle"></i> FAQ</a></li>
<li><a href="../../groups.html"><i class="fas fa-users"></i> Groups</a></li>
<li><a href="../../badges.html"><i class="fas fa-certificate"></i> Badges</a></li>
</ul>
<h3 style="font-size: 13px;"><a href="#categories"><span>▼</span>Categories</a></h3>
<hr/>
<ul class="sidebar-grid categories">
<li>
<a class="badge-wrapper bullet" href="../../c/support/6.html">
<span class="badge-category-bg" style="background-color: #BF1E2E"></span>
<span class="badge-category clear-badge">
<span class="category-name">Support</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/feature-requests/5.html">
<span class="badge-category-bg" style="background-color: #3AB54A"></span>
<span class="badge-category clear-badge">
<span class="category-name">Feature Requests</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/uncategorized/1.html">
<span class="badge-category-bg" style="background-color: #AB9364"></span>
<span class="badge-category clear-badge">
<span class="category-name">Uncategorized</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/development/7.html">
<span class="badge-category-bg" style="background-color: #8C6238"></span>
<span class="badge-category clear-badge">
<span class="category-name">Development</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/tips-tricks-query-examples/11.html">
<span class="badge-category-bg" style="background-color: #652D90"></span>
<span class="badge-category clear-badge" style="white-space: normal;">
<span class="category-name">Tips, Tricks &amp; Query Examples</span>
</span>
</a>
</li>
<li><a href="../../categories.html"><i class="fas fa-list-ul"></i> All categories</a></li>
</ul>
<h3 style="font-size: 13px;"><a href="#tags"><span>▼</span>Tags</a></h3>
<hr/>
<ul class="sidebar-grid tags">
<li><a href="../../tag/query_results.html"><i class="fas fa-tag"></i> query_results</a></li>
<li><a href="../../tag/feature-request.html"><i class="fas fa-tag"></i> feature-request</a></li>
<li><a href="../../tag/parameters.html"><i class="fas fa-tag"></i> parameters</a></li>
<li><a href="../../tag/visualizations.html"><i class="fas fa-tag"></i> visualizations</a></li>
<li><a href="../../tag/alerts.html"><i class="fas fa-tag"></i> alerts</a></li>
<li><a href="../../tags.html"><i class="fas fa-list-ul"></i> All tags</a></li>
</ul>
</div>
<div class="sidebar-footer">
            © 2023 <a href="https://discuss.redash.io/" target="_blank">discuss.redash.io</a>
</div>
</div>
<div class="overlay"></div>
<div class="content">
<div class="global-notice">
<div class="row">
<div class="alert alert-info alert-read-only" id="global-notice-alert-read-only">
<span class="text">This site is in read only mode. Please continue to browse, but replying, likes,
                        and other actions are disabled for now.</span>
</div>
</div>
</div>
<div class="imported_page" id="imported_page">
<div class="wrap" id="main-outlet" role="main">
<div id="topic-title">
<h1>
<a href="/t/docker-deployed-redash-v8-using-the-hosts-pg-database/6033">Docker deployed redash-v8 (using the host's pg database)</a>
</h1>
<div class="topic-category" itemscope="" itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
<a class="badge-wrapper bullet" href="../../c/tips-tricks-query-examples/11.html" itemprop="item">
<span class="badge-category-bg" style="background-color: #652D90"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Tips, Tricks &amp; Query Examples</span>
</span>
</a>
<meta content="1" itemprop="position"/>
</span>
</div>
</div>
<div itemscope="" itemtype="http://schema.org/DiscussionForumPosting">
<meta content="Docker deployed redash-v8 (using the host's pg database)" itemprop="headline"/>
<meta content="Tips, Tricks &amp; Query Examples" itemprop="articleSection"/>
<meta content="" itemprop="keywords"/>
<div itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
<meta content="Redash Discourse" itemprop="name"/>
<div itemprop="logo" itemscope="" itemtype="http://schema.org/ImageObject">
<meta content="https://global.discourse-cdn.com/standard17/uploads/redash1/original/1X/c07bc573841e1e4a0013ea3b6fe088a1534228a3.png" itemprop="url"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_1">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/zhongshaoming1.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/zhongshaoming1_avatar.png" tabindex="-1" width="48"/><span itemprop="name">zhongshaoming1</span></a>
</span>
<link href="https://discuss.redash.io/t/docker-deployed-redash-v8-using-the-hosts-pg-database/6033" itemprop="mainEntityOfPage"/>
<link href="https://global.discourse-cdn.com/standard17/uploads/redash1/original/2X/b/b769062d95ceeccb479c834b00e6ff80f033511d.png" itemprop="image"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2020-04-18T18:00:10Z" itemprop="datePublished">
                    April 18, 2020,  6:00pm
                  </time>
<meta content="2020-04-20T12:25:18Z" itemprop="dateModified"/>
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p><strong>Background</strong></p>
<blockquote>
<p>Redash is a very good BI tool, official docker version of one key installation , eliminating the manual installation of redash packages, Celery, Redis, Postgres db component of trouble. However, because I am not familiar with docker, how to continuously store the data saved to postgres database by redash in docker at the end of docker’s life cycle has baffled me. If this problem is not solved, once there is a problem after the product is launched, I will be fired by my company.</p>
</blockquote>
<p><img alt=":rofl:" class="emoji only-emoji" height="20" loading="lazy" src="assets/rofl.png" title=":rofl:" width="20"/></p>
<blockquote>
<p>So I came up with another way, namely redash, celery, Redis service deployment using official docker script, and then use the postgres database installed on host machine. I did it by trial and error. I’m sharing the whole process now, hoping to help friends like me. Skilled gods, please ignore.</p>
</blockquote>
<blockquote>
<p>My English is very poor. I am very sorry if I will caused any trouble to you ！<br/>
<img alt=":smiley:" class="emoji only-emoji" height="20" loading="lazy" src="assets/smiley.png" title=":smiley:" width="20"/></p>
</blockquote>
<p><strong>Environment</strong>：Centos7 / Mac OS 10.15.3 → Chrome</p>
<p><strong>Step 1: install docker and docker-compose</strong></p>
<blockquote>
<p><a href="https://docs.docker.com/engine/install/" rel="noopener nofollow ugc">See official documents</a><br/>
The Mac system is simple, direct to download the <a href="https://hub.docker.com/editions/community/docker-ce-desktop-mac/" rel="noopener nofollow ugc">desktop version</a> (seems more than 500M), then a graphical interface to install directly, once installed, it contains the  docker-compose  tools.<br/>
Centos, if you follow the official instructions, is pretty simple.</p>
</blockquote>
<p><strong>Step 2: install npm nodejs</strong></p>
<blockquote>
<p><a href="https://nodejs.org/en/download/" rel="noopener nofollow ugc">See official documents</a><br/>
Installation process may step on some pits, Please help yourself ！</p>
</blockquote>
<p><strong>Step 3: install postgres</strong></p>
<blockquote>
<p><a href="https://www.postgresql.org/download/" rel="noopener nofollow ugc">See official documents</a><br/>
Once installed, create a database such as “redash_v8” for later use</p>
</blockquote>
<p><strong>Step 4: download the redash source code</strong></p>
<pre><code class="lang-auto">git clone https://github.com/getredash/redash.git
#  Note that the downloaded default codes is the master branch of redash;
# which is the latest redash(currently V9 by 2020-04-19),;
# and production is better with the stable version of V8. 
# Switch to version v8 with the following instructions

cd redash
git checkout --track remotes/origin/release/8.0.x
</code></pre>
<p><strong>Step 5: modify the docker-compose.yml file</strong></p>
<blockquote>
<p>The docker-compose.yml file is under the redash directory<br/>
<div class="lightbox-wrapper"><a class="lightbox" data-download-href="/uploads/short-url/qawoc9M5pgeXjPAqguiSOqK2685.png?dl=1" href="https://global.discourse-cdn.com/standard17/uploads/redash1/original/2X/b/b769062d95ceeccb479c834b00e6ff80f033511d.png" rel="noopener nofollow ugc" title="redash"><img alt="redash" data-base62-sha1="qawoc9M5pgeXjPAqguiSOqK2685" data-small-upload="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/b/b769062d95ceeccb479c834b00e6ff80f033511d_2_10x10.png" height="500" src="assets/b769062d95ceeccb479c834b00e6ff80f033511d_2_566x500.png" srcset="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/b/b769062d95ceeccb479c834b00e6ff80f033511d_2_566x500.png, https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/b/b769062d95ceeccb479c834b00e6ff80f033511d_2_849x750.png 1.5x, https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/b/b769062d95ceeccb479c834b00e6ff80f033511d_2_1132x1000.png 2x" width="566"/><div class="meta">
<svg aria-hidden="true" class="fa d-icon d-icon-far-image svg-icon"><use href="#far-image"></use></svg><span class="filename">redash</span><span class="informations">2040×1800 390 KB</span><svg aria-hidden="true" class="fa d-icon d-icon-discourse-expand svg-icon"><use href="#discourse-expand"></use></svg>
</div></a></div><br/>
(1).As shown above, remove the code associated with postgres<br/>
(2).Modify the REDASH_DATABASE_URL: “postgresql://postgres@postgres/postgres” in two places</p>
</blockquote>
<pre><code class="lang-auto">REDASH_DATABASE_URL: "postgresql://UserName:PassWorld@Host:Port/DataBaseName"

# Explain：
# UserName: the UserName of the postgres database that you installed and deployed yourself
# PassWorld: the password for the postgres database you installed and deployed yourself
# Host: the IP address of the server on which you installed the deployed postgres database
# Port: you can install the Port number of the deployed postgres database (if the pg database and redash are not on the same server, remember to open the firewall Port).
# DataBaseName: the name of the database you create, such as "redash_v8"
</code></pre>
<p><strong>Step 6: generate web page resources</strong></p>
<blockquote>
<p>The following instructions are executed in the redash directory：</p>
</blockquote>
<pre><code class="lang-auto">npm install  # Install dependent software，may take many minutes

npm run build  # generate web page resources
</code></pre>
<p><strong>Step 7: create the data table</strong></p>
<pre><code class="lang-auto"># The following instructions are executed in the redash directory：
docker-compose run --rm server create_db  # May take many minutes```
</code></pre>
<p><strong>Step 8: start redash</strong></p>
<pre><code class="lang-auto"># The following instructions are executed in the redash directory：
docker-compose up  # Build image, startup redash, Redis, celery service. May take many minutes

# After the service starts, type http://youhost:5000 in your browser, unsurprisingly, you will see the redash home page

# If you want to start in the background, use the following command:
   docker-compose up -d
# If you need to terminate redash and related services, execute the following instructions:
   docker-compose stop</code></pre>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="overlay" id="modalOverlay" style="display: none;">
<div class="modal-content">
<p>Login or sign up disabled while the site is in read only mode</p>
<hr/>
<button class="btn btn-login">OK</button>
</div>
</div>
<script src="../../js/script.js"></script>
</body>
</html>