<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Google Sheets IMPORTDATA not refreshing with new Query Results</title>
    <link>https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056</link>
    <description>Hey Guys, 

I love the feature that allows redash query results to be displayed in Google Sheets via the IMPORTDATA function, however I can&#39;t seem to get the data to update when the query re-runs. Any ideas or advice on the refreshing of data when using the API to import into Google Sheets?</description>
    
    <lastBuildDate>Thu, 10 Nov 2022 07:07:54 +0000</lastBuildDate>
    <category>Usage Support</category>
    <atom:link href="https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>Google Sheets IMPORTDATA not refreshing with new Query Results</title>
        <dc:creator><![CDATA[tunglt]]></dc:creator>
        <description><![CDATA[
            <p>Hi Rafialvin<br>
How can I turn on the refresh part in this script? Thank you!</p>
          <p><a href="https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056/13">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056/13</link>
        <pubDate>Thu, 10 Nov 2022 07:07:54 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-3056-13</guid>
        <source url="https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056.rss">Google Sheets IMPORTDATA not refreshing with new Query Results</source>
      </item>
      <item>
        <title>Google Sheets IMPORTDATA not refreshing with new Query Results</title>
        <dc:creator><![CDATA[FAMT]]></dc:creator>
        <description><![CDATA[
            <p>Hi,<br>
Did you get the solution? I’ve the same problem<br>
<a class="mention" href="https://discuss.redash.io/u/hiteshahuja292">@hiteshahuja292</a></p>
<p>Best,<br>
FAMT</p>
          <p><a href="https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056/12">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056/12</link>
        <pubDate>Wed, 04 May 2022 23:28:32 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-3056-12</guid>
        <source url="https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056.rss">Google Sheets IMPORTDATA not refreshing with new Query Results</source>
      </item>
      <item>
        <title>Google Sheets IMPORTDATA not refreshing with new Query Results</title>
        <dc:creator><![CDATA[jesse]]></dc:creator>
        <description><![CDATA[
            <p>This user posted the script in the thread above.</p>
          <p><a href="https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056/11">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056/11</link>
        <pubDate>Thu, 12 Aug 2021 14:31:12 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-3056-11</guid>
        <source url="https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056.rss">Google Sheets IMPORTDATA not refreshing with new Query Results</source>
      </item>
      <item>
        <title>Google Sheets IMPORTDATA not refreshing with new Query Results</title>
        <dc:creator><![CDATA[mohamedEltanbedawy]]></dc:creator>
        <description><![CDATA[
            <p>can you please send me the script</p>
          <p><a href="https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056/10">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056/10</link>
        <pubDate>Thu, 12 Aug 2021 14:30:54 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-3056-10</guid>
        <source url="https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056.rss">Google Sheets IMPORTDATA not refreshing with new Query Results</source>
      </item>
      <item>
        <title>Google Sheets IMPORTDATA not refreshing with new Query Results</title>
        <dc:creator><![CDATA[k4s1m]]></dc:creator>
        <description><![CDATA[
            <p>It looks like an authentication error. Are you sure the permissions are set properly?</p>
          <p><a href="https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056/9">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056/9</link>
        <pubDate>Thu, 09 Jul 2020 13:25:06 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-3056-9</guid>
        <source url="https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056.rss">Google Sheets IMPORTDATA not refreshing with new Query Results</source>
      </item>
      <item>
        <title>Google Sheets IMPORTDATA not refreshing with new Query Results</title>
        <dc:creator><![CDATA[hiteshahuja292]]></dc:creator>
        <description><![CDATA[
            <p>Hi, I get the following error while importing the data. Can anyone pls help look into it?</p>
<p></p><div class="lightbox-wrapper"><a class="lightbox" href="https://global.discourse-cdn.com/standard17/uploads/redash1/original/2X/b/b0f49620310845b1feb9b9aadae3077acd8423cc.png" data-download-href="/uploads/short-url/pfq3E33DZWC94SKURNw5ZUpuXes.png?dl=1" title="image" rel="noopener nofollow ugc"><img src="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/b/b0f49620310845b1feb9b9aadae3077acd8423cc_2_690x287.png" alt="image" data-base62-sha1="pfq3E33DZWC94SKURNw5ZUpuXes" width="690" height="287" srcset="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/b/b0f49620310845b1feb9b9aadae3077acd8423cc_2_690x287.png, https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/b/b0f49620310845b1feb9b9aadae3077acd8423cc_2_1035x430.png 1.5x, https://global.discourse-cdn.com/standard17/uploads/redash1/original/2X/b/b0f49620310845b1feb9b9aadae3077acd8423cc.png 2x" data-small-upload="https://global.discourse-cdn.com/standard17/uploads/redash1/optimized/2X/b/b0f49620310845b1feb9b9aadae3077acd8423cc_2_10x10.png"></a></div><p></p>
          <p><a href="https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056/8">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056/8</link>
        <pubDate>Wed, 08 Jul 2020 06:36:38 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-3056-8</guid>
        <source url="https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056.rss">Google Sheets IMPORTDATA not refreshing with new Query Results</source>
      </item>
      <item>
        <title>Google Sheets IMPORTDATA not refreshing with new Query Results</title>
        <dc:creator><![CDATA[devendra-cse]]></dc:creator>
        <description><![CDATA[
            <p>Hi Rafialvin,</p>
<p>Thanks for taking out sometime &amp; sharing the script here.<br>
I tried using it and customised it as per my use case, but somehow it doesn’t work.<br>
Can you please place more comments in the above script to make us understand better. Thanks</p>
          <p><a href="https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056/7">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056/7</link>
        <pubDate>Sat, 09 May 2020 10:21:34 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-3056-7</guid>
        <source url="https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056.rss">Google Sheets IMPORTDATA not refreshing with new Query Results</source>
      </item>
      <item>
        <title>Google Sheets IMPORTDATA not refreshing with new Query Results</title>
        <dc:creator><![CDATA[rafialvin]]></dc:creator>
        <description><![CDATA[
            <p>Hi Kartavya,</p>
<p>Sure! Feel free to use my script. It’s a bit messy, but it works! Hope it helps.<br>
Note: I turned off the refresh part in this query, I use schedule refresh on Redash instead. This script will get the latest query result.</p>
<p>You need to use scheduler on google apps script to schedule run this script as well.</p>
<pre><code>function getRedashData() {

   // data
   var start = new Date();
   var redash_query_id = "QUERY_ID" // redash query id
   var redash_format = "csv" // redash format
   var redash_api_key = "USER_API_KEY_OR_QUERY_API_KEY" // your user api key
   var sheet = "SHEET_NAME" // your sheet name

  // refresh data (turn on for get newest result if your query less than 30 minutes)
//   var status = RedashRefreshData(redash_query_id, redash_api_key);

   // get the target sheet to write the data
   var url_get_data = "https://app.redash.io/dekoruma/api/queries/" + redash_query_id + "/results." + redash_format + "?api_key=" + redash_api_key
   var jsonString = RedashGetData(url_get_data);
   var dataObjectAll = Utilities.parseCsv(jsonString)
   var targetSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(sheet);
   var results = [];
   var dataRows = dataObjectAll.map(function(row) {
     return Object.keys(dataObjectAll[0]).map(function(col) {
       return String(row[col]);
     });
   });
   results = results.concat(dataRows);
   var range = targetSheet.getRange(1, 1, dataObjectAll.length + 0, Object.keys(dataObjectAll[0]).length);
   targetSheet.clearContents();
   range.setValues(results);

   // redash get data
   function RedashGetData(url_get_data) {
       var options = {
             "method" : "get"
             }
       return UrlFetchApp.fetch(url_get_data, options).getContentText()
    }

   // redash refresh data
   function RedashRefreshData(redash_query_id, redash_api_key) {
       var headers = {
         "Authorization": "Key " + redash_api_key
       }
       var post_options = {
             "method" : "post",
             "headers": headers
       }
       var get_options = {
             "method" : "get",
             "headers": headers
       }
       var url_refresh = "https://app.redash.io/dekoruma/api/queries/" + redash_query_id + "/refresh"
       var status = UrlFetchApp.fetch(url_refresh, post_options).getContentText()
       var status_parsed = JSON.parse(status)
       var job = status_parsed.job
       var url_job_status = "https://app.redash.io/dekoruma/api/jobs/" + job['id']
       var job_status = job['status']
       var runningTime = 0;
       while (job_status !== 3 &amp;&amp; runningTime &lt; 300000) {
         var response = UrlFetchApp.fetch(url_job_status, get_options).getContentText()
         var now = new Date();
         var runningTime = now.getTime() - start.getTime();
         var status_parsed = JSON.parse(response)
         var job = status_parsed.job
         var job_status = job['status']
         Utilities.sleep(500)
       }
       return job
    }
}</code></pre>
          <p><a href="https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056/6">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056/6</link>
        <pubDate>Fri, 06 Mar 2020 08:12:16 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-3056-6</guid>
        <source url="https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056.rss">Google Sheets IMPORTDATA not refreshing with new Query Results</source>
      </item>
      <item>
        <title>Google Sheets IMPORTDATA not refreshing with new Query Results</title>
        <dc:creator><![CDATA[kartavya-ramnani]]></dc:creator>
        <description><![CDATA[
            <p>Hey,<br>
Can you share the script ?<br>
I am facing the same issue.</p>
          <p><a href="https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056/5">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056/5</link>
        <pubDate>Thu, 05 Mar 2020 18:27:50 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-3056-5</guid>
        <source url="https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056.rss">Google Sheets IMPORTDATA not refreshing with new Query Results</source>
      </item>
      <item>
        <title>Google Sheets IMPORTDATA not refreshing with new Query Results</title>
        <dc:creator><![CDATA[rafialvin]]></dc:creator>
        <description><![CDATA[
            <p>I am using google apps script to get the data from redash and write it to sheets. It also has scheduler to set your refresh interval. I can share the script if you are interested <img src="https://emoji.discourse-cdn.com/twitter/wink.png?v=9" title=":wink:" class="emoji" alt=":wink:"></p>
          <p><a href="https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056/4">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056/4</link>
        <pubDate>Wed, 27 Nov 2019 13:05:42 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-3056-4</guid>
        <source url="https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056.rss">Google Sheets IMPORTDATA not refreshing with new Query Results</source>
      </item>
      <item>
        <title>Google Sheets IMPORTDATA not refreshing with new Query Results</title>
        <dc:creator><![CDATA[elimash]]></dc:creator>
        <description><![CDATA[
            <p>It happens quite often, I simply do: Ctrl+X  and then Ctrl+V  (cut. and then paste back). It goes through “loading…” and refresh.</p>
          <p><a href="https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056/3">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056/3</link>
        <pubDate>Mon, 28 Oct 2019 08:50:39 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-3056-3</guid>
        <source url="https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056.rss">Google Sheets IMPORTDATA not refreshing with new Query Results</source>
      </item>
      <item>
        <title>Google Sheets IMPORTDATA not refreshing with new Query Results</title>
        <dc:creator><![CDATA[arikfr]]></dc:creator>
        <description><![CDATA[
            <p>There are several reasons data might not update:</p>
<ol>
<li>Google Sheets has its own caching mechanism and it updates the data based on its own schedule. I’m not sure if the interval is documented, you can check their documentation.</li>
<li>You should make sure to use the results API call: <code>/api/queries/&lt;query id&gt;/results.csv</code> vs. an API call that mentions the query result ID.</li>
<li>If this is a query with parameters, it might be another reason why this doesn’t get updates. Queries with parameters are not supported (at the moment) with this feature.</li>
</ol>
          <p><a href="https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056/2">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056/2</link>
        <pubDate>Tue, 22 Jan 2019 11:51:07 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-3056-2</guid>
        <source url="https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056.rss">Google Sheets IMPORTDATA not refreshing with new Query Results</source>
      </item>
      <item>
        <title>Google Sheets IMPORTDATA not refreshing with new Query Results</title>
        <dc:creator><![CDATA[Gabe]]></dc:creator>
        <description><![CDATA[
            <p>Hey Guys,</p>
<p>I love the feature that allows redash query results to be displayed in Google Sheets via the IMPORTDATA function, however I can’t seem to get the data to update when the query re-runs. Any ideas or advice on the refreshing of data when using the API to import into Google Sheets?</p>
          <p><a href="https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056/1">Read full topic</a></p>
        ]]></description>
        <link>https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056/1</link>
        <pubDate>Mon, 21 Jan 2019 17:47:58 +0000</pubDate>
        <guid isPermaLink="false">discuss.redash.io-post-3056-1</guid>
        <source url="https://discuss.redash.io/t/google-sheets-importdata-not-refreshing-with-new-query-results/3056.rss">Google Sheets IMPORTDATA not refreshing with new Query Results</source>
      </item>
  </channel>
</rss>
