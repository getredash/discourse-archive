<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet"/>
<link href="../../css/checklist_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/desktop_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/desktop_theme_2_be4cb2b86ec06123c5e974acd20fd933d14b129d.css" rel="stylesheet"/>
<link href="../../css/discourse-adplugin_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-akismet_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-cakeday_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-chat-integration_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-details_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-footnote_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-lazy-videos_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-local-dates_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/color_definitions_base__2_8fd59ae1f286f43b3ff17996df07ea951685249d.css" rel="stylesheet"/>
<link href="../../css/style.css" rel="stylesheet"/>
<title>Queries don't return when SQL text is longer than 1400 characters</title></head>
<body>
<div class="navbar">
<div class="logo"><a href="../../page_0.html"><img alt="" src="../../images/logo_redash.png" srcset=""/></a></div>
<div class="navbar-buttons">
<button class="btn btn-signup">Sign Up</button>
<button class="btn btn-login"><i class="fas fa-user"></i> Login</button>
<button class="btn btn-search"><i class="fas fa-search"></i></button>
<div class="navbar-toggle">
<div class="dots"></div>
<div class="dots"></div>
<div class="dots"></div>
</div>
</div>
</div>
<div class="sidebar">
<div class="sidebar-content">
<div class="logo"><a href="../../page_0.html"><img alt="" src="../../images/logo_redash.png" srcset=""/></a></div>
<ul class="sidebar-grid">
<!-- <li><a href="#"><i class="fas fa-list-ul"></i> Topics</a></li> -->
<li><a href="../../page_0.html"><i class="fas fa-layer-group"></i> Topics</a></li>
<li><a href="../../users.html"><i class="fas fa-users"></i> Users</a></li>
<li><a href="../../about.html"><i class="fas fa-info-circle"></i> About</a></li>
<li><a href="../../faq.html"><i class="fas fa-question-circle"></i> FAQ</a></li>
<li><a href="../../groups.html"><i class="fas fa-users"></i> Groups</a></li>
<li><a href="../../badges.html"><i class="fas fa-certificate"></i> Badges</a></li>
</ul>
<h3 style="font-size: 13px;"><a href="#categories"><span>▼</span>Categories</a></h3>
<hr/>
<ul class="sidebar-grid categories">
<li>
<a class="badge-wrapper bullet" href="../../c/support/6.html">
<span class="badge-category-bg" style="background-color: #BF1E2E"></span>
<span class="badge-category clear-badge">
<span class="category-name">Support</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/feature-requests/5.html">
<span class="badge-category-bg" style="background-color: #3AB54A"></span>
<span class="badge-category clear-badge">
<span class="category-name">Feature Requests</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/uncategorized/1.html">
<span class="badge-category-bg" style="background-color: #AB9364"></span>
<span class="badge-category clear-badge">
<span class="category-name">Uncategorized</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/development/7.html">
<span class="badge-category-bg" style="background-color: #8C6238"></span>
<span class="badge-category clear-badge">
<span class="category-name">Development</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/tips-tricks-query-examples/11.html">
<span class="badge-category-bg" style="background-color: #652D90"></span>
<span class="badge-category clear-badge" style="white-space: normal;">
<span class="category-name">Tips, Tricks &amp; Query Examples</span>
</span>
</a>
</li>
<li><a href="../../categories.html"><i class="fas fa-list-ul"></i> All categories</a></li>
</ul>
<h3 style="font-size: 13px;"><a href="#tags"><span>▼</span>Tags</a></h3>
<hr/>
<ul class="sidebar-grid tags">
<li><a href="../../tag/query_results.html"><i class="fas fa-tag"></i> query_results</a></li>
<li><a href="../../tag/feature-request.html"><i class="fas fa-tag"></i> feature-request</a></li>
<li><a href="../../tag/parameters.html"><i class="fas fa-tag"></i> parameters</a></li>
<li><a href="../../tag/visualizations.html"><i class="fas fa-tag"></i> visualizations</a></li>
<li><a href="../../tag/alerts.html"><i class="fas fa-tag"></i> alerts</a></li>
<li><a href="../../tags.html"><i class="fas fa-list-ul"></i> All tags</a></li>
</ul>
</div>
<div class="sidebar-footer">
            © 2023 <a href="https://discuss.redash.io/" target="_blank">discuss.redash.io</a>
</div>
</div>
<div class="overlay"></div>
<div class="content">
<div class="global-notice">
<div class="row">
<div class="alert alert-info alert-read-only" id="global-notice-alert-read-only">
<span class="text">This site is in read only mode. Please continue to browse, but replying, likes,
                        and other actions are disabled for now.</span>
</div>
</div>
</div>
<div class="imported_page" id="imported_page">
<div class="wrap" id="main-outlet" role="main">
<div id="topic-title">
<h1>
<a href="/t/queries-dont-return-when-sql-text-is-longer-than-1400-characters/10403">Queries don't return when SQL text is longer than 1400 characters</a>
</h1>
<div class="topic-category" itemscope="" itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
<a class="badge-wrapper bullet" href="../../c/support/6.html" itemprop="item">
<span class="badge-category-bg" style="background-color: #BF1E2E"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Support</span>
</span>
</a>
<meta content="1" itemprop="position"/>
</span>
<span itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
<a class="badge-wrapper bullet" href="../../c/support/support-self-hosted/9.html" itemprop="item">
<span class="badge-category-bg" style="background-color: #AB9364"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Self Hosted Redash Support</span>
</span>
</a>
<meta content="2" itemprop="position"/>
</span>
</div>
</div>
<div itemscope="" itemtype="http://schema.org/DiscussionForumPosting">
<meta content="Queries don't return when SQL text is longer than 1400 characters" itemprop="headline"/>
<meta content="Self Hosted Redash Support" itemprop="articleSection"/>
<meta content="" itemprop="keywords"/>
<div itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
<meta content="Redash Discourse" itemprop="name"/>
<div itemprop="logo" itemscope="" itemtype="http://schema.org/ImageObject">
<meta content="https://global.discourse-cdn.com/standard17/uploads/redash1/original/1X/c07bc573841e1e4a0013ea3b6fe088a1534228a3.png" itemprop="url"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_1">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/mritch.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/mritch_avatar.png" tabindex="-1" width="48"/><span itemprop="name">mritch</span></a>
</span>
<link href="assets/10403" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2022-04-28T17:37:31Z" itemprop="datePublished">
                    April 28, 2022,  5:37pm
                  </time>
<meta content="2022-04-28T17:43:12Z" itemprop="dateModified"/>
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<p>Hello! I am a new Redash user coming into a company which has been using Redash for a short time.<br/>
In brief, we are having an issue where if a query’s source text is longer than 1400 characters, the query will not return data to either the query viewer or an associated dashboard.<br/>
Table size in rows or columns is not an issue.</p>
<p>We are running Redash with Docker. I pulled these versions from our docker-compose.yml file.</p>
<ul>
<li>redash:10.1.0.b50633</li>
<li>postgres:9.6-alpine</li>
<li>redis:5.0-alpine</li>
</ul>
<p>System info:</p>
<ul>
<li>Linux 5.10.0-1057-oem <span class="hashtag">#61-Ubuntu</span> SMP Thu Jan 13 15:06:11 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux</li>
<li>Browser is Firefox 99.0.1</li>
</ul>
<p>Redash installation info:</p>
<ul>
<li>installed using this link: <a href="https://redash.io/help/open-source/setup" rel="noopener nofollow ugc">https://redash.io/help/open-source/setup</a> as version 8.</li>
<li>8 had the same issue, so we updated to version 10 using this link <a class="inline-onebox" href="https://github.com/getredash/redash/releases/v10.0.0" rel="noopener nofollow ugc">Release v10.0.0 · getredash/redash · GitHub</a>
</li>
</ul>
<p>Here are the docker-compose logs from a failed query (greater than 1400 characters in the query text). I removed URLs and emails.<br/>
The log includes <code>free(): corrupted unsorted chunks</code> so we may be overflowing memory with the long queries.</p>
<pre><code class="lang-auto">server_1            | [2022-04-28 17:19:55,187][PID:9][INFO][rq.job.redash.tasks.queries.execution] job.func_name= job.id= Inserting job for fe5567c986bfed2c35c9f708dd9464c7 with metadata={'Username': XXX@YYY.com', 'query_id': 31}
adhoc_worker_1      | [2022-04-28 17:19:55,188][PID:11][INFO][rq.worker] default: 4c052cb2-071d-4fed-a8b4-8b224c5c8e01
server_1            | [2022-04-28 17:19:55,188][PID:9][INFO][rq.job.redash.tasks.queries.execution] job.func_name= job.id= [fe5567c986bfed2c35c9f708dd9464c7] Created new job: 262dcccd-ed39-4f7d-9bf2-cbd43845eecb
adhoc_worker_1      | [2022-04-28 17:19:55,189][PID:10][INFO][rq.worker] queries: 262dcccd-ed39-4f7d-9bf2-cbd43845eecb
server_1            | [2022-04-28 17:19:55,190][PID:9][INFO][metrics] method=POST path=/api/query_results endpoint=query_results status=200 content_type=application/json content_length=139 duration=13.06 query_count=7 query_duration=6.23
nginx_1             | 10.10.1.1 - - [28/Apr/2022:17:19:55 +0000] "POST /api/query_results HTTP/1.1" 200 139 "https://ZZZ.com/queries/31/source?p_date-range=d_last_12_months" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:99.0) Gecko/20100101 Firefox/99.0"
adhoc_worker_1      | [2022-04-28 17:19:55,197][PID:87547][INFO][rq.job.redash.tasks.queries.execution] job.func_name=redash.tasks.queries.execution.execute_query job.id=262dcccd-ed39-4f7d-9bf2-cbd43845eecb job=execute_query state=load_ds ds_id=1
adhoc_worker_1      | [2022-04-28 17:19:55,224][PID:87547][INFO][rq.job.redash.tasks.queries.execution] job.func_name=redash.tasks.queries.execution.execute_query job.id=262dcccd-ed39-4f7d-9bf2-cbd43845eecb job=execute_query state=executing_query query_hash=fe5567c986bfed2c35c9f708dd9464c7 type=mssql ds_id=1 job_id=262dcccd-ed39-4f7d-9bf2-cbd43845eecb queue=queries query_id=31 username=XXX@YYY.com
adhoc_worker_1      | [2022-04-28 17:19:55,229][PID:87546][INFO][rq.worker] default: Job OK (4c052cb2-071d-4fed-a8b4-8b224c5c8e01)
adhoc_worker_1      | [2022-04-28 17:19:55,229][PID:87546][INFO][rq.worker] Result is kept for 500 seconds
server_1            | [2022-04-28 17:19:55,260][PID:10][INFO][metrics] method=GET path=/api/jobs/262dcccd-ed39-4f7d-9bf2-cbd43845eecb endpoint=job status=200 content_type=application/json content_length=163 duration=1.15 query_count=2 query_duration=2.06
nginx_1             | 10.10.1.1 - - [28/Apr/2022:17:19:55 +0000] "GET /api/jobs/262dcccd-ed39-4f7d-9bf2-cbd43845eecb HTTP/1.1" 200 163 "https://ZZZ.com/queries/31/source?p_date-range=d_last_12_months" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:99.0) Gecko/20100101 Firefox/99.0"
adhoc_worker_1      | free(): corrupted unsorted chunks
adhoc_worker_1      | [2022-04-28 17:19:55,612][PID:10][WARNING][rq.worker] Moving job to FailedJobRegistry (work-horse terminated unexpectedly; waitpid returned 134)
server_1            | [2022-04-28 17:19:55,841][PID:14][INFO][metrics] method=GET path=/api/jobs/262dcccd-ed39-4f7d-9bf2-cbd43845eecb endpoint=job status=200 content_type=application/json content_length=139 duration=1.56 query_count=2 query_duration=2.42
nginx_1             | 10.10.1.1 - - [28/Apr/2022:17:19:55 +0000] "GET /api/jobs/262dcccd-ed39-4f7d-9bf2-cbd43845eecb HTTP/1.1" 200 139 "https://ZZZ.com/queries/31/source?p_date-range=d_last_12_months" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:99.0) Gecko/20100101 Firefox/99.0"
server_1            | [2022-04-28 17:19:56,019][PID:9][INFO][metrics] method=POST path=/api/events endpoint=events status=200 content_type=application/json content_length=4 duration=1.66 query_count=2 query_duration=2.59
scheduled_worker_1  | [2022-04-28 17:19:56,019][PID:10][INFO][rq.worker] default: 44d9ff55-804b-4516-81f6-c5548953eba3
nginx_1             | 10.10.1.1 - - [28/Apr/2022:17:19:56 +0000] "POST /api/events HTTP/1.1" 200 4 "https://ZZZ.com/queries/31/source?p_date-range=d_last_12_months" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:99.0) Gecko/20100101 Firefox/99.0"
scheduled_worker_1  | [2022-04-28 17:19:56,059][PID:88280][INFO][rq.worker] default: Job OK (44d9ff55-804b-4516-81f6-c5548953eba3)
scheduled_worker_1  | [2022-04-28 17:19:56,059][PID:88280][INFO][rq.worker] Result is kept for 500 seconds
</code></pre>
<p>Thank you in advance for your help and please let me know if you need more information.</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="overlay" id="modalOverlay" style="display: none;">
<div class="modal-content">
<p>Login or sign up disabled while the site is in read only mode</p>
<hr/>
<button class="btn btn-login">OK</button>
</div>
</div>
<script src="../../js/script.js"></script>
</body>
</html>