<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet"/>
<link href="../../css/checklist_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/desktop_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/desktop_theme_2_be4cb2b86ec06123c5e974acd20fd933d14b129d.css" rel="stylesheet"/>
<link href="../../css/discourse-adplugin_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-akismet_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-cakeday_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-chat-integration_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-details_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-footnote_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-lazy-videos_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/discourse-local-dates_d86c892d7cd5311243d31a8f11787f4b0342874d.css" rel="stylesheet"/>
<link href="../../css/color_definitions_base__2_8fd59ae1f286f43b3ff17996df07ea951685249d.css" rel="stylesheet"/>
<link href="../../css/style.css" rel="stylesheet"/>
<title>Gunicorn timing out web/server workers</title></head>
<body>
<div class="navbar">
<div class="logo"><a href="../../page_0.html"><img alt="" src="../../images/logo_redash.png" srcset=""/></a></div>
<div class="navbar-buttons">
<button class="btn btn-signup">Sign Up</button>
<button class="btn btn-login"><i class="fas fa-user"></i> Login</button>
<button class="btn btn-search"><i class="fas fa-search"></i></button>
<div class="navbar-toggle">
<div class="dots"></div>
<div class="dots"></div>
<div class="dots"></div>
</div>
</div>
</div>
<div class="sidebar">
<div class="sidebar-content">
<div class="logo"><a href="../../page_0.html"><img alt="" src="../../images/logo_redash.png" srcset=""/></a></div>
<ul class="sidebar-grid">
<!-- <li><a href="#"><i class="fas fa-list-ul"></i> Topics</a></li> -->
<li><a href="../../page_0.html"><i class="fas fa-layer-group"></i> Topics</a></li>
<li><a href="../../users.html"><i class="fas fa-users"></i> Users</a></li>
<li><a href="../../about.html"><i class="fas fa-info-circle"></i> About</a></li>
<li><a href="../../faq.html"><i class="fas fa-question-circle"></i> FAQ</a></li>
<li><a href="../../groups.html"><i class="fas fa-users"></i> Groups</a></li>
<li><a href="../../badges.html"><i class="fas fa-certificate"></i> Badges</a></li>
</ul>
<h3 style="font-size: 13px;"><a href="#categories"><span>▼</span>Categories</a></h3>
<hr/>
<ul class="sidebar-grid categories">
<li>
<a class="badge-wrapper bullet" href="../../c/support/6.html">
<span class="badge-category-bg" style="background-color: #BF1E2E"></span>
<span class="badge-category clear-badge">
<span class="category-name">Support</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/feature-requests/5.html">
<span class="badge-category-bg" style="background-color: #3AB54A"></span>
<span class="badge-category clear-badge">
<span class="category-name">Feature Requests</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/uncategorized/1.html">
<span class="badge-category-bg" style="background-color: #AB9364"></span>
<span class="badge-category clear-badge">
<span class="category-name">Uncategorized</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/development/7.html">
<span class="badge-category-bg" style="background-color: #8C6238"></span>
<span class="badge-category clear-badge">
<span class="category-name">Development</span>
</span>
</a>
</li>
<li>
<a class="badge-wrapper bullet" href="../../c/tips-tricks-query-examples/11.html">
<span class="badge-category-bg" style="background-color: #652D90"></span>
<span class="badge-category clear-badge" style="white-space: normal;">
<span class="category-name">Tips, Tricks &amp; Query Examples</span>
</span>
</a>
</li>
<li><a href="../../categories.html"><i class="fas fa-list-ul"></i> All categories</a></li>
</ul>
<h3 style="font-size: 13px;"><a href="#tags"><span>▼</span>Tags</a></h3>
<hr/>
<ul class="sidebar-grid tags">
<li><a href="../../tag/query_results.html"><i class="fas fa-tag"></i> query_results</a></li>
<li><a href="../../tag/feature-request.html"><i class="fas fa-tag"></i> feature-request</a></li>
<li><a href="../../tag/parameters.html"><i class="fas fa-tag"></i> parameters</a></li>
<li><a href="../../tag/visualizations.html"><i class="fas fa-tag"></i> visualizations</a></li>
<li><a href="../../tag/alerts.html"><i class="fas fa-tag"></i> alerts</a></li>
<li><a href="../../tags.html"><i class="fas fa-list-ul"></i> All tags</a></li>
</ul>
</div>
<div class="sidebar-footer">
            © 2023 <a href="https://discuss.redash.io/" target="_blank">discuss.redash.io</a>
</div>
</div>
<div class="overlay"></div>
<div class="content">
<div class="global-notice">
<div class="row">
<div class="alert alert-info alert-read-only" id="global-notice-alert-read-only">
<span class="text">This site is in read only mode. Please continue to browse, but replying, likes,
                        and other actions are disabled for now.</span>
</div>
</div>
</div>
<div class="imported_page" id="imported_page">
<div class="wrap" id="main-outlet" role="main">
<div id="topic-title">
<h1>
<a href="/t/gunicorn-timing-out-web-server-workers/9740">Gunicorn timing out web/server workers</a>
</h1>
<div class="topic-category" itemscope="" itemtype="http://schema.org/BreadcrumbList">
<span itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
<a class="badge-wrapper bullet" href="../../c/support/6.html" itemprop="item">
<span class="badge-category-bg" style="background-color: #BF1E2E"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Support</span>
</span>
</a>
<meta content="1" itemprop="position"/>
</span>
<span itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
<a class="badge-wrapper bullet" href="../../c/support/support-self-hosted/9.html" itemprop="item">
<span class="badge-category-bg" style="background-color: #AB9364"></span>
<span class="badge-category clear-badge">
<span class="category-name" itemprop="name">Self Hosted Redash Support</span>
</span>
</a>
<meta content="2" itemprop="position"/>
</span>
</div>
</div>
<div itemscope="" itemtype="http://schema.org/DiscussionForumPosting">
<meta content="Gunicorn timing out web/server workers" itemprop="headline"/>
<meta content="Self Hosted Redash Support" itemprop="articleSection"/>
<meta content="" itemprop="keywords"/>
<div itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
<meta content="Redash Discourse" itemprop="name"/>
<div itemprop="logo" itemscope="" itemtype="http://schema.org/ImageObject">
<meta content="https://global.discourse-cdn.com/standard17/uploads/redash1/original/1X/c07bc573841e1e4a0013ea3b6fe088a1534228a3.png" itemprop="url"/>
</div>
</div>
<div class="topic-body crawler-post" id="post_1">
<div class="crawler-post-meta">
<span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<a href="../../u/detail/mkazia.html" itemprop="url"><img alt="" class="avatar" height="48" loading="lazy" src="../../u/avatars/mkazia_avatar.png" tabindex="-1" width="48"/><span itemprop="name">mkazia</span></a>
</span>
<link href="assets/9740" itemprop="mainEntityOfPage"/>
<span class="crawler-post-infos">
<time class="post-time" datetime="2021-12-18T23:18:26Z" itemprop="datePublished">
                    December 18, 2021, 11:18pm
                  </time>
<meta content="2021-12-18T23:18:26Z" itemprop="dateModified"/>
<span itemprop="position">1</span>
</span>
</div>
<div class="post" itemprop="articleBody">
<h3>
<a class="anchor" href="#issue-summary-1" name="issue-summary-1"></a>Issue Summary</h3>
<p>With all the query runners and destinations enabled and the default 4 web workers, worker startup cannot complete in 30 seconds. Because of this, gunicorn main process is killing the worker processes.</p>
<h3>
<a class="anchor" href="#technical-details-2" name="technical-details-2"></a>Technical details:</h3>
<ul>
<li>Redash Version: 10.1.0.b50633</li>
<li>Browser/OS: Client: Chrome Version 96 on macOS 11.6.1, Server: AWS EKS on Fargate</li>
<li>How did you install Redash: On AWS EKS Fargate using contrib-helm-chart</li>
</ul>
<p>The main gunicorn process will kill the worker process if it does not complete startup in 30 seconds and report back to the main process. Currently with all the query runners and destinations enabled it takes longer than 30 seconds for the worker to startup. The pod log shows these messages:</p>
<pre><code class="lang-auto">Using external postgresql database
Using external redis database
[2021-12-18 22:35:24 +0000] [8] [INFO] Starting gunicorn 20.0.4
[2021-12-18 22:35:24 +0000] [8] [INFO] Listening at: http://0.0.0.0:5000 (8)
[2021-12-18 22:35:24 +0000] [8] [INFO] Using worker: sync
[2021-12-18 22:35:24 +0000] [11] [INFO] Booting worker with pid: 11
[2021-12-18 22:35:24 +0000] [12] [INFO] Booting worker with pid: 12
[2021-12-18 22:35:24 +0000] [13] [INFO] Booting worker with pid: 13
[2021-12-18 22:35:24 +0000] [14] [INFO] Booting worker with pid: 14
[2021-12-18 22:35:54 +0000] [8] [CRITICAL] WORKER TIMEOUT (pid:11)
[2021-12-18 22:35:54 +0000] [8] [CRITICAL] WORKER TIMEOUT (pid:12)
[2021-12-18 22:35:54 +0000] [11] [INFO] Worker exiting (pid: 11)
[2021-12-18 22:35:54 +0000] [8] [CRITICAL] WORKER TIMEOUT (pid:13)
[2021-12-18 22:35:54 +0000] [8] [CRITICAL] WORKER TIMEOUT (pid:14)
[2021-12-18 22:35:54 +0000] [12] [INFO] Worker exiting (pid: 12)
[2021-12-18 22:35:54 +0000] [14] [INFO] Worker exiting (pid: 14)
[2021-12-18 22:35:55 +0000] [24] [INFO] Booting worker with pid: 24
[2021-12-18 22:35:55 +0000] [25] [INFO] Booting worker with pid: 25
[2021-12-18 22:35:55 +0000] [26] [INFO] Booting worker with pid: 26
[2021-12-18 22:35:55 +0000] [27] [INFO] Booting worker with pid: 27
[2021-12-18 22:36:25 +0000] [8] [CRITICAL] WORKER TIMEOUT (pid:24)
[2021-12-18 22:36:25 +0000] [8] [CRITICAL] WORKER TIMEOUT (pid:25)
[2021-12-18 22:36:25 +0000] [8] [CRITICAL] WORKER TIMEOUT (pid:26)
[2021-12-18 22:36:25 +0000] [8] [CRITICAL] WORKER TIMEOUT (pid:27)
[2021-12-18 22:36:25 +0000] [24] [INFO] Worker exiting (pid: 24)
[2021-12-18 22:36:25 +0000] [25] [INFO] Worker exiting (pid: 25)
[2021-12-18 22:36:25 +0000] [27] [INFO] Worker exiting (pid: 27)
[2021-12-18 22:36:26 +0000] [26] [INFO] Worker exiting (pid: 26)
[2021-12-18 22:36:27 +0000] [38] [INFO] Booting worker with pid: 38
[2021-12-18 22:36:27 +0000] [39] [INFO] Booting worker with pid: 39
[2021-12-18 22:36:27 +0000] [40] [INFO] Booting worker with pid: 40
[2021-12-18 22:36:27 +0000] [41] [INFO] Booting worker with pid: 41
</code></pre>
<p>I’m able to workaround the issue by limiting the query runners or changing the webworkers from 4 to 2. According to <a href="https://programmerah.com/gunicorn-timeout-error-1-critical-worker-timeout-how-to-solve-37592/" rel="noopener nofollow ugc">this</a> the gunicorn command has a <code>--timeout</code> parameter  for which the default value is 30 seconds and it can be changed.</p>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/LikeAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
<span class="post-likes"></span>
</div>
<div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
<meta content="http://schema.org/CommentAction" itemprop="interactionType"/>
<meta content="0" itemprop="userInteractionCount"/>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="overlay" id="modalOverlay" style="display: none;">
<div class="modal-content">
<p>Login or sign up disabled while the site is in read only mode</p>
<hr/>
<button class="btn btn-login">OK</button>
</div>
</div>
<script src="../../js/script.js"></script>
</body>
</html>